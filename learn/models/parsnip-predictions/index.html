<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Examples that show how to fit and predict with different combinations of model, mode, and engine.">

<title>Fitting and predicting with parsnip – tidymodels</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-d7fcc3ff7e490f12cb1c45aad4d93599.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-8ae369b7693b499421f559bffa2d5a81.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">tidymodels</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../packages/index.html"> 
<span class="menu-text">Packages</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../start/index.html"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../learn/index.html"> 
<span class="menu-text">Learn</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../help/index.html"> 
<span class="menu-text">Help</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../contribute/index.html"> 
<span class="menu-text">Contribute</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../find/index.html"> 
<span class="menu-text">Find</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tidymodels/"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#external-dependencies" id="toc-external-dependencies" class="nav-link" data-scroll-target="#external-dependencies">External Dependencies</a></li>
  </ul></li>
  <li><a href="#classification-models" id="toc-classification-models" class="nav-link" data-scroll-target="#classification-models">Classification Models</a>
  <ul class="collapse">
  <li><a href="#example-data" id="toc-example-data" class="nav-link" data-scroll-target="#example-data">Example data</a></li>
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models">Models</a>
  <ul class="collapse">
  <li><a href="#bagged-mars-bag_mars" id="toc-bagged-mars-bag_mars" class="nav-link" data-scroll-target="#bagged-mars-bag_mars">Bagged MARS (<code>bag_mars()</code>)</a></li>
  <li><a href="#bagged-neural-networks-bag_mlp" id="toc-bagged-neural-networks-bag_mlp" class="nav-link" data-scroll-target="#bagged-neural-networks-bag_mlp">Bagged Neural Networks (<code>bag_mlp()</code>)</a></li>
  <li><a href="#bagged-decision-trees-bag_tree" id="toc-bagged-decision-trees-bag_tree" class="nav-link" data-scroll-target="#bagged-decision-trees-bag_tree">Bagged Decision Trees (<code>bag_tree()</code>)</a></li>
  <li><a href="#bayesian-additive-regression-trees-bart" id="toc-bayesian-additive-regression-trees-bart" class="nav-link" data-scroll-target="#bayesian-additive-regression-trees-bart">Bayesian Additive Regression Trees (<code>bart()</code>)</a></li>
  <li><a href="#boosted-decision-trees-boost_tree" id="toc-boosted-decision-trees-boost_tree" class="nav-link" data-scroll-target="#boosted-decision-trees-boost_tree">Boosted Decision Trees (<code>boost_tree()</code>)</a></li>
  <li><a href="#c5-rules-c5_rules" id="toc-c5-rules-c5_rules" class="nav-link" data-scroll-target="#c5-rules-c5_rules">C5 Rules (<code>C5_rules()</code>)</a></li>
  <li><a href="#decision-tree-decision_tree" id="toc-decision-tree-decision_tree" class="nav-link" data-scroll-target="#decision-tree-decision_tree">Decision Tree (<code>decision_tree()</code>)</a></li>
  <li><a href="#flexible-discriminant-analysis-discrim_flexible" id="toc-flexible-discriminant-analysis-discrim_flexible" class="nav-link" data-scroll-target="#flexible-discriminant-analysis-discrim_flexible">Flexible Discriminant Analysis (<code>discrim_flexible()</code>)</a></li>
  <li><a href="#linear-discriminant-analysis-discrim_linear" id="toc-linear-discriminant-analysis-discrim_linear" class="nav-link" data-scroll-target="#linear-discriminant-analysis-discrim_linear">Linear Discriminant Analysis (<code>discrim_linear()</code>)</a></li>
  <li><a href="#quandratic-discriminant-analysis-discrim_quad" id="toc-quandratic-discriminant-analysis-discrim_quad" class="nav-link" data-scroll-target="#quandratic-discriminant-analysis-discrim_quad">Quandratic Discriminant Analysis (<code>discrim_quad()</code>)</a></li>
  <li><a href="#regularized-discriminant-analysis-discrim_regularized" id="toc-regularized-discriminant-analysis-discrim_regularized" class="nav-link" data-scroll-target="#regularized-discriminant-analysis-discrim_regularized">Regularized Discriminant Analysis (<code>discrim_regularized()</code>)</a></li>
  <li><a href="#generalized-additive-models-gen_additive_mod" id="toc-generalized-additive-models-gen_additive_mod" class="nav-link" data-scroll-target="#generalized-additive-models-gen_additive_mod">Generalized Additive Models (<code>gen_additive_mod()</code>)</a></li>
  <li><a href="#logistic-regression-logistic_reg" id="toc-logistic-regression-logistic_reg" class="nav-link" data-scroll-target="#logistic-regression-logistic_reg">Logistic Regression (<code>logistic_reg()</code>)</a></li>
  <li><a href="#multivariate-adaptive-regression-splines-mars" id="toc-multivariate-adaptive-regression-splines-mars" class="nav-link" data-scroll-target="#multivariate-adaptive-regression-splines-mars">Multivariate Adaptive Regression Splines (<code>mars()</code>)</a></li>
  <li><a href="#neural-networks-mlp" id="toc-neural-networks-mlp" class="nav-link" data-scroll-target="#neural-networks-mlp">Neural Networks (<code>mlp()</code>)</a></li>
  <li><a href="#multinom-regression-multinom_reg" id="toc-multinom-regression-multinom_reg" class="nav-link" data-scroll-target="#multinom-regression-multinom_reg">Multinom Regression (<code>multinom_reg()</code>)</a></li>
  <li><a href="#naive-bayes-naive_bayes" id="toc-naive-bayes-naive_bayes" class="nav-link" data-scroll-target="#naive-bayes-naive_bayes">Naive Bayes (<code>naive_Bayes()</code>)</a></li>
  <li><a href="#k-nearest-neighbors-nearest_neighbor" id="toc-k-nearest-neighbors-nearest_neighbor" class="nav-link" data-scroll-target="#k-nearest-neighbors-nearest_neighbor">K-Nearest Neighbors (<code>nearest_neighbor()</code>)</a></li>
  <li><a href="#null-model-null_model" id="toc-null-model-null_model" class="nav-link" data-scroll-target="#null-model-null_model">Null Model (<code>null_model()</code>)</a></li>
  <li><a href="#partial-least-squares-pls" id="toc-partial-least-squares-pls" class="nav-link" data-scroll-target="#partial-least-squares-pls">Partial Least Squares (<code>pls()</code>)</a></li>
  <li><a href="#random-forests-rand_forest" id="toc-random-forests-rand_forest" class="nav-link" data-scroll-target="#random-forests-rand_forest">Random Forests (<code>rand_forest()</code>)</a></li>
  <li><a href="#rule-fit-rule_fit" id="toc-rule-fit-rule_fit" class="nav-link" data-scroll-target="#rule-fit-rule_fit">Rule Fit (<code>rule_fit()</code>)</a></li>
  <li><a href="#support-vector-machine-linear-kernel-svm_linear" id="toc-support-vector-machine-linear-kernel-svm_linear" class="nav-link" data-scroll-target="#support-vector-machine-linear-kernel-svm_linear">Support Vector Machine (Linear Kernel) (<code>svm_linear()</code>)</a></li>
  <li><a href="#support-vector-machine-polynomial-kernel-svm_poly" id="toc-support-vector-machine-polynomial-kernel-svm_poly" class="nav-link" data-scroll-target="#support-vector-machine-polynomial-kernel-svm_poly">Support Vector Machine (Polynomial Kernel) (<code>svm_poly()</code>)</a></li>
  <li><a href="#support-vector-machine-radial-basis-function-kernel-svm_rbf" id="toc-support-vector-machine-radial-basis-function-kernel-svm_rbf" class="nav-link" data-scroll-target="#support-vector-machine-radial-basis-function-kernel-svm_rbf">Support Vector Machine (Radial Basis Function Kernel) (<code>svm_rbf()</code>)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models">Regression Models</a>
  <ul class="collapse">
  <li><a href="#example-data-1" id="toc-example-data-1" class="nav-link" data-scroll-target="#example-data-1">Example data</a></li>
  <li><a href="#models-1" id="toc-models-1" class="nav-link" data-scroll-target="#models-1">Models</a>
  <ul class="collapse">
  <li><a href="#bagged-mars-bag_mars-1" id="toc-bagged-mars-bag_mars-1" class="nav-link" data-scroll-target="#bagged-mars-bag_mars-1">Bagged MARS (<code>bag_mars()</code>)</a></li>
  <li><a href="#bagged-neural-networks-bag_mlp-1" id="toc-bagged-neural-networks-bag_mlp-1" class="nav-link" data-scroll-target="#bagged-neural-networks-bag_mlp-1">Bagged Neural Networks (<code>bag_mlp()</code>)</a></li>
  <li><a href="#bagged-decision-trees-bag_tree-1" id="toc-bagged-decision-trees-bag_tree-1" class="nav-link" data-scroll-target="#bagged-decision-trees-bag_tree-1">Bagged Decision Trees (<code>bag_tree()</code>)</a></li>
  <li><a href="#bayesian-additive-regression-trees-bart-1" id="toc-bayesian-additive-regression-trees-bart-1" class="nav-link" data-scroll-target="#bayesian-additive-regression-trees-bart-1">Bayesian Additive Regression Trees (<code>bart()</code>)</a></li>
  <li><a href="#boosted-decision-trees-boost_tree-1" id="toc-boosted-decision-trees-boost_tree-1" class="nav-link" data-scroll-target="#boosted-decision-trees-boost_tree-1">Boosted Decision Trees (<code>boost_tree()</code>)</a></li>
  <li><a href="#cubist-rules-cubist_rules" id="toc-cubist-rules-cubist_rules" class="nav-link" data-scroll-target="#cubist-rules-cubist_rules">Cubist Rules (<code>cubist_rules()</code>)</a></li>
  <li><a href="#decision-tree-decision_tree-1" id="toc-decision-tree-decision_tree-1" class="nav-link" data-scroll-target="#decision-tree-decision_tree-1">Decision Tree (<code>decision_tree()</code>)</a></li>
  <li><a href="#generalized-additive-models-gen_additive_mod-1" id="toc-generalized-additive-models-gen_additive_mod-1" class="nav-link" data-scroll-target="#generalized-additive-models-gen_additive_mod-1">Generalized Additive Models (<code>gen_additive_mod()</code>)</a></li>
  <li><a href="#linear-reg-linear_reg" id="toc-linear-reg-linear_reg" class="nav-link" data-scroll-target="#linear-reg-linear_reg">Linear Reg (<code>linear_reg()</code>)</a></li>
  <li><a href="#multivariate-adaptive-regression-splines-mars-1" id="toc-multivariate-adaptive-regression-splines-mars-1" class="nav-link" data-scroll-target="#multivariate-adaptive-regression-splines-mars-1">Multivariate Adaptive Regression Splines (<code>mars()</code>)</a></li>
  <li><a href="#neural-networks-mlp-1" id="toc-neural-networks-mlp-1" class="nav-link" data-scroll-target="#neural-networks-mlp-1">Neural Networks (<code>mlp()</code>)</a></li>
  <li><a href="#k-nearest-neighbors-nearest_neighbor-1" id="toc-k-nearest-neighbors-nearest_neighbor-1" class="nav-link" data-scroll-target="#k-nearest-neighbors-nearest_neighbor-1">K-Nearest Neighbors (<code>nearest_neighbor()</code>)</a></li>
  <li><a href="#partial-least-squares-pls-1" id="toc-partial-least-squares-pls-1" class="nav-link" data-scroll-target="#partial-least-squares-pls-1">Partial Least Squares (<code>pls()</code>)</a></li>
  <li><a href="#poisson-reg-poisson_reg" id="toc-poisson-reg-poisson_reg" class="nav-link" data-scroll-target="#poisson-reg-poisson_reg">Poisson Reg (<code>poisson_reg()</code>)</a></li>
  <li><a href="#random-forests-rand_forest-1" id="toc-random-forests-rand_forest-1" class="nav-link" data-scroll-target="#random-forests-rand_forest-1">Random Forests (<code>rand_forest()</code>)</a></li>
  <li><a href="#rule-fit-rule_fit-1" id="toc-rule-fit-rule_fit-1" class="nav-link" data-scroll-target="#rule-fit-rule_fit-1">Rule Fit (<code>rule_fit()</code>)</a></li>
  <li><a href="#support-vector-machine-linear-kernel-svm_linear-1" id="toc-support-vector-machine-linear-kernel-svm_linear-1" class="nav-link" data-scroll-target="#support-vector-machine-linear-kernel-svm_linear-1">Support Vector Machine (Linear Kernel) (<code>svm_linear()</code>)</a></li>
  <li><a href="#support-vector-machine-polynomial-kernel-svm_poly-1" id="toc-support-vector-machine-polynomial-kernel-svm_poly-1" class="nav-link" data-scroll-target="#support-vector-machine-polynomial-kernel-svm_poly-1">Support Vector Machine (Polynomial Kernel) (<code>svm_poly()</code>)</a></li>
  <li><a href="#support-vector-machine-radial-basis-function-kernel-svm_rbf-1" id="toc-support-vector-machine-radial-basis-function-kernel-svm_rbf-1" class="nav-link" data-scroll-target="#support-vector-machine-radial-basis-function-kernel-svm_rbf-1">Support Vector Machine (Radial Basis Function Kernel) (<code>svm_rbf()</code>)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#censored-regression-models" id="toc-censored-regression-models" class="nav-link" data-scroll-target="#censored-regression-models">Censored Regression Models</a>
  <ul class="collapse">
  <li><a href="#example-data-2" id="toc-example-data-2" class="nav-link" data-scroll-target="#example-data-2">Example data</a></li>
  <li><a href="#models-2" id="toc-models-2" class="nav-link" data-scroll-target="#models-2">Models</a>
  <ul class="collapse">
  <li><a href="#bagged-decision-trees-bag_tree-2" id="toc-bagged-decision-trees-bag_tree-2" class="nav-link" data-scroll-target="#bagged-decision-trees-bag_tree-2">Bagged Decision Trees (<code>bag_tree()</code>)</a></li>
  <li><a href="#boosted-decision-trees-boost_tree-2" id="toc-boosted-decision-trees-boost_tree-2" class="nav-link" data-scroll-target="#boosted-decision-trees-boost_tree-2">Boosted Decision Trees (<code>boost_tree()</code>)</a></li>
  <li><a href="#decision-tree-decision_tree-2" id="toc-decision-tree-decision_tree-2" class="nav-link" data-scroll-target="#decision-tree-decision_tree-2">Decision Tree (<code>decision_tree()</code>)</a></li>
  <li><a href="#proportional-hazards-proportional_hazards" id="toc-proportional-hazards-proportional_hazards" class="nav-link" data-scroll-target="#proportional-hazards-proportional_hazards">Proportional Hazards (<code>proportional_hazards()</code>)</a></li>
  <li><a href="#random-forests-rand_forest-2" id="toc-random-forests-rand_forest-2" class="nav-link" data-scroll-target="#random-forests-rand_forest-2">Random Forests (<code>rand_forest()</code>)</a></li>
  <li><a href="#parametric-survival-models-survival_reg" id="toc-parametric-survival-models-survival_reg" class="nav-link" data-scroll-target="#parametric-survival-models-survival_reg">Parametric Survival Models (<code>survival_reg()</code>)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#quantile-regression-models" id="toc-quantile-regression-models" class="nav-link" data-scroll-target="#quantile-regression-models">Quantile Regression Models</a>
  <ul class="collapse">
  <li><a href="#example-data-3" id="toc-example-data-3" class="nav-link" data-scroll-target="#example-data-3">Example data</a></li>
  <li><a href="#models-3" id="toc-models-3" class="nav-link" data-scroll-target="#models-3">Models</a>
  <ul class="collapse">
  <li><a href="#linear-regression-linear_reg" id="toc-linear-regression-linear_reg" class="nav-link" data-scroll-target="#linear-regression-linear_reg">Linear Regression (<code>linear_reg()</code>)</a></li>
  <li><a href="#random-forests-rand_forest-3" id="toc-random-forests-rand_forest-3" class="nav-link" data-scroll-target="#random-forests-rand_forest-3">Random Forests (<code>rand_forest()</code>)</a></li>
  </ul></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session information</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/tidymodels/tidymodels.org/edit/main/learn/models/parsnip-predictions/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/tidymodels/tidymodels.org/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Fitting and predicting with parsnip</h1>
  <div class="quarto-categories">
    <div class="quarto-category">model fitting</div>
    <div class="quarto-category">parsnip</div>
    <div class="quarto-category">regression</div>
    <div class="quarto-category">classification</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Examples that show how to fit and predict with different combinations of model, mode, and engine.</p>
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This page shows examples of how to <em>fit</em> and <em>predict</em> with different combinations of model, mode, and engine. As a reminder, in parsnip,</p>
<ul>
<li><p>the <strong>model type</strong> differentiates basic modeling approaches, such as random forests, logistic regression, linear support vector machines, etc.,</p></li>
<li><p>the <strong>mode</strong> denotes in what kind of modeling context it will be used (most commonly, classification or regression), and</p></li>
<li><p>the computational <strong>engine</strong> indicates how the model is fit, such as with a specific R package implementation or even methods outside of R like Keras or Stan.</p></li>
</ul>
<p>We’ll break the examples up by their mode. For each model, we’ll show different data sets used across the different engines.</p>
<p>To use code in this article, you will need to install the following packages: agua, baguette, bonsai, censored, discrim, HSAUR3, lme4, multilevelmod, plsmod, poissonreg, prodlim, rules, sparklyr, survival, and tidymodels.</p>
<p>There are numerous other “engine” packages that are required. If you use a model that is missing one or more installed packages, parsnip will prompt you to install them. There are some packages that require non-standard installation or rely on external dependencies. We’ll describe these next.</p>
<section id="external-dependencies" class="level2">
<h2 class="anchored" data-anchor-id="external-dependencies">External Dependencies</h2>
<p>Some models available in parsnip use other computational frameworks for computations. There may be some additional downloads for engines using <strong>catboost</strong>, <strong>Spark</strong>, <strong>h2o</strong>, <strong>tensorflow</strong>/<strong>keras</strong>, and <strong>torch</strong>. You can expand the sections below to get basic installation instructions.</p>
<details>
<summary>
catboost installation instructions
</summary>
<p>catboost is a popular boosting framework. Unfortunately, the R package is not available on CRAN. First, go to <a href="&quot;https://github.com/catboost/catboost/releases/">https://github.com/catboost/catboost/releases/</a> and search for “<code>[R-package]</code>” to find the most recent release.</p>
<p>The following code can be used to install and test the package (which requires the glue package to be installed):</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the current version number in this variable: </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>version_number <span class="ot">&lt;-</span> <span class="st">"#.#.#"</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>template <span class="ot">&lt;-</span> <span class="st">"https://github.com/catboost/catboost/releases/download/v{version_number}/catboost-R-darwin-universal2-{version_number}.tgz"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>target_url <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(template)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>target_dest <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(target_url, target_dest)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"^mac"</span>, .Platform<span class="sc">$</span>pkgType)) {</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  options <span class="ot">&lt;-</span> <span class="st">"--no-staged-install"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  options <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="dv">0</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>inst <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"R CMD INSTALL {options} {target_dest}"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(inst)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>To test, fit an example model:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(catboost)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>train_pool_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"adult_train.1000"</span>, <span class="at">package =</span> <span class="st">"catboost"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>test_pool_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"adult_test.1000"</span>, <span class="at">package =</span> <span class="st">"catboost"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>cd_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"adult.cd"</span>, <span class="at">package =</span> <span class="st">"catboost"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>train_pool <span class="ot">&lt;-</span> <span class="fu">catboost.load_pool</span>(train_pool_path, <span class="at">column_description =</span> cd_path)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>test_pool <span class="ot">&lt;-</span> <span class="fu">catboost.load_pool</span>(test_pool_path, <span class="at">column_description =</span> cd_path)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>fit_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterations =</span> <span class="dv">100</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss_function =</span> <span class="st">'Logloss'</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ignored_features =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">9</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">border_count =</span> <span class="dv">32</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">depth =</span> <span class="dv">5</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">learning_rate =</span> <span class="fl">0.03</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2_leaf_reg =</span> <span class="fl">3.5</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_dir =</span> <span class="fu">tempdir</span>())</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>fit_params</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
<details>
<summary>
Apache Spark installation instructions
</summary>
<p>To use <a href="https://spark.apache.org/">Apache Spark</a> as an engine, we will first install Spark and then need a connection to a cluster. For this article, we will set up and use a single-node Spark cluster running on a laptop.</p>
<p>To install, first install sparklyr:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"sparklyr"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>and then install the Spark backend. For example, you might use:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spark_install</span>(<span class="at">version =</span> <span class="st">"4.0"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Once that is working, you can get ready to fit models using:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">spark_connect</span>(<span class="st">"local"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
<details>
<summary>
h2o installation instructions
</summary>
<p>h2o.ai offers a Java-based high-performance computing server for machine learning. This can be run locally or externally. There are general installation instructions at <a href="https://docs.h2o.ai/h2o/latest-stable/h2o-docs/downloading.html">https://docs.h2o.ai/</a>. There is a package on CRAN, but you can also install directly from <a href="https://docs.h2o.ai/h2o/latest-stable/h2o-docs/downloading.html#install-in-r">h2o</a> via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"h2o"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"source"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">repos =</span> <span class="st">"http://h2o-release.s3.amazonaws.com/h2o/latest_stable_R"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>After installation is complete, you can start a local server via <code>h2o::h2o.init()</code>.</p>
<p>The tidymodels <a href="https://agua.tidymodels.org/">agua</a> package contains some helpers and will also need to be installed. You can use its function to start a server too:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: 'agua'</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from 'package:workflowsets':</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rank_results</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">h2o_start</span>()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: JAVA not found, H2O may take minutes trying to connect.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
<details>
<summary>
Tensorflow and Keras installation instructions
</summary>
<p>R’s tensorflow and keras3 packages call Python directly. To enable this, you’ll have to install both components:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"keras3"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Once that is done, use:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>keras3<span class="sc">::</span><span class="fu">install_keras</span>(<span class="at">backend =</span> <span class="st">"tensorflow"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>There are other options for installation. See <a href="https://tensorflow.rstudio.com/install/index.html">https://tensorflow.rstudio.com/install/index.html</a> for more details.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes you are going to use a virtual environment called </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pve <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"tensorflow"</span>, reticulate<span class="sc">::</span><span class="fu">virtualenv_list</span>(), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>reticulate<span class="sc">::</span><span class="fu">use_virtualenv</span>(pve)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
<details>
<summary>
Torch installation instructions
</summary>
<p>R’s torch package is the low-level package containing the framework. Once you have installed it, you will get this message the first time you load the package:</p>
<blockquote class="blockquote">
<p>“Additional software needs to be downloaded and installed for torch to work correctly.”</p>
</blockquote>
<p>Choosing “Yes” will do the <em>one-time</em> installation.</p>
</details>
<p>To get started, let’s load the tidymodels package:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="classification-models" class="level1">
<h1>Classification Models</h1>
<section id="example-data" class="level2">
<h2 class="anchored" data-anchor-id="example-data">Example data</h2>
<p>To demonstrate classification, let’s make small training and test sets for a binary outcome. We’ll center and scale the data since some models require the same units.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">207</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>bin_split <span class="ot">&lt;-</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    modeldata<span class="sc">::</span>two_class_dat <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">class =</span> Class) <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">initial_split</span>(<span class="at">prop =</span> <span class="fl">0.994</span>, <span class="at">strata =</span> class)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>bin_split</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;Training/Testing/Total&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;785/6/791&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>bin_rec <span class="ot">&lt;-</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(class <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">training</span>(bin_split)) <span class="sc">|&gt;</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>bin_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(bin_rec, <span class="at">new_data =</span> <span class="cn">NULL</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>bin_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(bin_rec, <span class="at">new_data =</span> <span class="fu">testing</span>(bin_split))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>For models that <em>only</em> work for three or more classes, we’ll simulate:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1752</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>mtl_data <span class="ot">&lt;-</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">sim_multinomial</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">200</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>  <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">+</span> <span class="fl">0.6</span> <span class="sc">*</span> <span class="fu">abs</span>(A),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">ifelse</span>(A <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> B <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fl">1.0</span> <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> A <span class="sc">/</span> B, <span class="sc">-</span> <span class="dv">2</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> A <span class="sc">+</span> B <span class="sc">-</span> A <span class="sc">*</span> B</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>mtl_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(mtl_data, <span class="at">prop =</span> <span class="fl">0.967</span>, <span class="at">strata =</span> class)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>mtl_split</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;Training/Testing/Total&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;192/8/200&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictors are in the same units</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>mtl_train <span class="ot">&lt;-</span> <span class="fu">training</span>(mtl_split)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>mtl_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(mtl_split)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Finally, we have some models that handle hierarchical data, where some rows are statistically correlated with other rows. For these examples, we’ll use data from a clinical trial where patients were followed over time. The outcome is binary. The data are in the HSAUR3 package. We’ll split these data in a way where all rows for a specific subject are either in the training or test sets:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">72</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cls_group_split <span class="ot">&lt;-</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  HSAUR3<span class="sc">::</span>toenail <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_initial_split</span>(<span class="at">group =</span> patientID)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>cls_group_train <span class="ot">&lt;-</span> <span class="fu">training</span>(cls_group_split)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>cls_group_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(cls_group_split)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>There are 219 subjects in the training set and 75 in the test set.</p>
<p>If using the <strong>Apache Spark</strong> engine, we will need to identify the data source and then use it to create the splits. For this article, we will copy the <code>two_class_dat</code> and the <code>mtl_data</code> data sets into the Spark session.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">spark_connect</span>(<span class="st">"local"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Re-using existing Spark connection to local</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>tbl_two_class <span class="ot">&lt;-</span> <span class="fu">copy_to</span>(sc, modeldata<span class="sc">::</span>two_class_dat)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>tbl_bin <span class="ot">&lt;-</span> <span class="fu">sdf_random_split</span>(tbl_two_class, <span class="at">training =</span> <span class="fl">0.994</span>, <span class="at">test =</span> <span class="dv">1</span><span class="fl">-0.994</span>, <span class="at">seed =</span> <span class="dv">100</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>tbl_sim_mtl <span class="ot">&lt;-</span> <span class="fu">copy_to</span>(sc, mtl_data)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>tbl_mtl <span class="ot">&lt;-</span> <span class="fu">sdf_random_split</span>(tbl_sim_mtl, <span class="at">training =</span> <span class="fl">0.967</span>, <span class="at">test =</span> <span class="dv">1</span><span class="fl">-0.967</span>, <span class="at">seed =</span> <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="models" class="level2">
<h2 class="anchored" data-anchor-id="models">Models</h2>
<section id="bagged-mars-bag_mars" class="level3">
<h3 class="anchored" data-anchor-id="bagged-mars-bag_mars">Bagged MARS (<code>bag_mars()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href=""><code>earth</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>This engine requires the baguette extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>bag_mars_spec <span class="ot">&lt;-</span> <span class="fu">bag_mars</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because earth is the default.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">268</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>bag_mars_fit <span class="ot">&lt;-</span> bag_mars_spec <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: 'plotrix'</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from 'package:scales':</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rescale</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Registered S3 method overwritten by 'butcher':</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   method                 from    </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   as.character.dev_topic generics</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>bag_mars_fit</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bagged MARS (classification with 11 members)</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance scores include:</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   term  value std.error  used</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 B     100        0       11</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 A      40.4      1.60    11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_mars_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_mars_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.452       0.548 </span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.854       0.146 </span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.455       0.545 </span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.968       0.0316</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.939       0.0610</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.872       0.128</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="bagged-neural-networks-bag_mlp" class="level3">
<h3 class="anchored" data-anchor-id="bagged-neural-networks-bag_mlp">Bagged Neural Networks (<code>bag_mlp()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href=""><code>nnet</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>This engine requires the baguette extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>bag_mlp_spec <span class="ot">&lt;-</span> <span class="fu">bag_mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because nnet is the default.</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">318</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>bag_mlp_fit <span class="ot">&lt;-</span> bag_mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>bag_mlp_fit</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bagged nnet (classification with 11 members)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance scores include:</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   term  value std.error  used</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 A      52.1      2.16    11</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 B      47.9      2.16    11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_mlp_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_mlp_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.439        0.561</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.676        0.324</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.428        0.572</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.727        0.273</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.709        0.291</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.660        0.340</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="bagged-decision-trees-bag_tree" class="level3">
<h3 class="anchored" data-anchor-id="bagged-decision-trees-bag_tree">Bagged Decision Trees (<code>bag_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href=""><code>rpart</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href=""><code>C5.0</code></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>This engine requires the baguette extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bag_tree_spec <span class="ot">&lt;-</span> <span class="fu">bag_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because rpart is the default.</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">985</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>bag_tree_fit <span class="ot">&lt;-</span> bag_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>bag_tree_fit</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bagged CART (classification with 11 members)</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance scores include:</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   term  value std.error  used</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 B      272.      4.35    11</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 A      237.      5.57    11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       0            1     </span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       1            0     </span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       0.0909       0.909 </span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       1            0     </span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       0.727        0.273 </span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       0.909        0.0909</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>This engine requires the baguette extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>bag_tree_spec <span class="ot">&lt;-</span> <span class="fu">bag_tree</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"C5.0"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">937</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>bag_tree_fit <span class="ot">&lt;-</span> bag_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>bag_tree_fit</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bagged C5.0 (classification with 11 members)</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance scores include:</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   term  value std.error  used</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 B     100        0       11</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 A      48.7      7.33    11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.269        0.731</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.863        0.137</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.259        0.741</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.897        0.103</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.897        0.103</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.870        0.130</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="bayesian-additive-regression-trees-bart" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-additive-regression-trees-bart">Bayesian Additive Regression Trees (<code>bart()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href=""><code>dbarts</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bart_spec <span class="ot">&lt;-</span> <span class="fu">bart</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because dbarts is the default.</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">217</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>bart_fit <span class="ot">&lt;-</span> bart_spec <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>bart_fit</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `NULL`()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bart_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bart_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.439        0.561</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.734        0.266</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.34         0.66 </span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.957        0.043</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.931        0.069</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.782        0.218</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bart_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower_Class1 .pred_lower_Class2 .pred_upper_Class1 .pred_upper_Class2</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              0.815            0.00280              0.997              0.185</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2              0.781            0.0223               0.978              0.219</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3              0.558            0.0702               0.930              0.442</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4              0.540            0.105                0.895              0.460</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5              0.239            0.345                0.655              0.761</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6              0.195            0.469                0.531              0.805</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bart_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower_Class1 .pred_lower_Class2 .pred_upper_Class1 .pred_upper_Class2</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                  0                  0                  1                  1</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                  0                  0                  1                  1</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                  0                  0                  1                  1</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                  0                  0                  1                  1</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                  0                  0                  1                  1</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                  0                  0                  1                  1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="boosted-decision-trees-boost_tree" class="level3">
<h3 class="anchored" data-anchor-id="boosted-decision-trees-boost_tree">Boosted Decision Trees (<code>boost_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href=""><code>xgboost</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href=""><code>C5.0</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href=""><code>catboost</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false" href=""><code>h2o_gbm</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false" href=""><code>lightgbm</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because xgboost is the default.</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">738</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ##### xgb.Booster</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; call:</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     subsample = 1, nthread = 1, objective = "binary:logistic"), </span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = x$data, nrounds = 15, evals = x$watchlist, verbose = 0)</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # of features: 2 </span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # of rounds:  15 </span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; callbacks:</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    evaluation_log </span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; evaluation_log:</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   iter training_logloss</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  &lt;num&gt;            &lt;num&gt;</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1        0.5486970</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      2        0.4698863</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    ---              ---</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     14        0.2646550</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     15        0.2616105</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.214       0.786 </span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.766       0.234 </span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.289       0.711 </span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.962       0.0377</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.831       0.169 </span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.945       0.0552</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"C5.0"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">984</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; C5.0.default(x = x, y = y, trials = 15, control = C50::C5.0Control(minCases</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  = 2, sample = 0))</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Classification Tree</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of samples: 785 </span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 2 </span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of boosting iterations: 15 requested;  7 used due to early stopping</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Average tree size: 3.1 </span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Non-standard options: attempt to group attributes</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.307        0.693</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.756        0.244</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.281        0.719</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        1            0    </span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        1            0    </span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.626        0.374</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"catboost"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">644</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CatBoost model (1000 trees)</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loss function: Logloss</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fit to 2 feature(s)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.291      0.709  </span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.836      0.164  </span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.344      0.656  </span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.998      0.00245</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.864      0.136  </span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.902      0.0983</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o_gbm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">186</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialModel: gbm</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  GBM_model_R_1770287512312_5613 </span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Summary: </span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_trees number_of_internal_trees model_size_in_bytes min_depth</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              50                       50               25380         6</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max_depth mean_depth min_leaves max_leaves mean_leaves</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         6    6.00000         21         55    35.70000</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialMetrics: gbm</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.007948832</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.08915622</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLoss:  0.05942305</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Per-Class Error:  0</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUC:  1</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUCPR:  1</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gini:  1</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R^2:  0.9678452</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC:  NaN</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Class1 Class2    Error    Rate</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1    434      0 0.000000  =0/434</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2      0    351 0.000000  =0/351</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Totals    434    351 0.000000  =0/785</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Metrics: Maximum metrics at their respective thresholds</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         metric threshold      value idx</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                       max f1  0.598690   1.000000 200</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                       max f2  0.598690   1.000000 200</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 max f0point5  0.598690   1.000000 200</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 max accuracy  0.598690   1.000000 200</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                max precision  0.998192   1.000000   0</span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                   max recall  0.598690   1.000000 200</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7              max specificity  0.998192   1.000000   0</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             max absolute_mcc  0.598690   1.000000 200</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   max min_per_class_accuracy  0.598690   1.000000 200</span></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 max mean_per_class_accuracy  0.598690   1.000000 200</span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11                     max tns  0.998192 434.000000   0</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12                     max fns  0.998192 349.000000   0</span></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13                     max fps  0.000831 434.000000 399</span></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14                     max tps  0.598690 351.000000 200</span></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15                     max tnr  0.998192   1.000000   0</span></span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16                     max fnr  0.998192   0.994302   0</span></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17                     max fpr  0.000831   1.000000 399</span></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18                     max tpr  0.598690   1.000000 200</span></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       0.0496      0.950  </span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       0.905       0.0953 </span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       0.0738      0.926  </span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       0.997       0.00273</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       0.979       0.0206 </span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       0.878       0.122</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o_gbm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">724</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialModel: gbm</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  GBM_model_R_1770287512312_5665 </span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Summary: </span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_trees number_of_internal_trees model_size_in_bytes min_depth</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              50                       50               25379         6</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max_depth mean_depth min_leaves max_leaves mean_leaves</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         6    6.00000         21         55    35.70000</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialMetrics: gbm</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.007948832</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.08915622</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLoss:  0.05942305</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Per-Class Error:  0</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUC:  1</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUCPR:  1</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gini:  1</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R^2:  0.9678452</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC:  NaN</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Class1 Class2    Error    Rate</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1    434      0 0.000000  =0/434</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2      0    351 0.000000  =0/351</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Totals    434    351 0.000000  =0/785</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Metrics: Maximum metrics at their respective thresholds</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         metric threshold      value idx</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                       max f1  0.598690   1.000000 200</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                       max f2  0.598690   1.000000 200</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 max f0point5  0.598690   1.000000 200</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 max accuracy  0.598690   1.000000 200</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                max precision  0.998192   1.000000   0</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                   max recall  0.598690   1.000000 200</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7              max specificity  0.998192   1.000000   0</span></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             max absolute_mcc  0.598690   1.000000 200</span></span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   max min_per_class_accuracy  0.598690   1.000000 200</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 max mean_per_class_accuracy  0.598690   1.000000 200</span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11                     max tns  0.998192 434.000000   0</span></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12                     max fns  0.998192 349.000000   0</span></span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13                     max fps  0.000831 434.000000 399</span></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14                     max tps  0.598690 351.000000 200</span></span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15                     max tnr  0.998192   1.000000   0</span></span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16                     max fnr  0.998192   0.994302   0</span></span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17                     max fpr  0.000831   1.000000 399</span></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18                     max tpr  0.598690   1.000000 200</span></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       0.0496      0.950  </span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       0.905       0.0953 </span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       0.0738      0.926  </span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       0.997       0.00273</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       0.979       0.0206 </span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       0.878       0.122</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lightgbm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">906</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LightGBM Model (100 trees)</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Objective: binary</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitted to dataset with 2 columns</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.147       0.853 </span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.930       0.0699</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.237       0.763 </span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.990       0.0101</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.929       0.0714</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.956       0.0445</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">285</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> tbl_bin<span class="sc">$</span>training)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: Class ~ .</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GBTClassificationModel: uid = gradient_boosted_trees__1c57358a_ec7a_4c0c_8911_2c8d306fa909, numTrees=20, numClasses=2, numFeatures=2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> tbl_bin<span class="sc">$</span>test)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_class</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     </span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2    </span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class2    </span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1    </span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class2    </span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class2    </span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1    </span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 Class2</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> tbl_bin<span class="sc">$</span>test)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 2]</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_Class1 pred_Class2</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      0.307       0.693 </span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      0.292       0.708 </span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      0.856       0.144 </span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      0.192       0.808 </span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      0.332       0.668 </span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      0.952       0.0476</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7      0.0865      0.914</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="c5-rules-c5_rules" class="level3">
<h3 class="anchored" data-anchor-id="c5-rules-c5_rules">C5 Rules (<code>C5_rules()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href=""><code>C5.0</code></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>This engine requires the rules extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rules)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because C5.0 is the default.</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>C5_rules_spec <span class="ot">&lt;-</span> <span class="fu">C5_rules</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">93</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>C5_rules_fit <span class="ot">&lt;-</span> C5_rules_spec <span class="sc">|&gt;</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>C5_rules_fit</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; C5.0.default(x = x, y = y, trials = trials, rules = TRUE, control</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  = C50::C5.0Control(minCases = minCases, seed = sample.int(10^5,</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1), earlyStopping = FALSE))</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rule-Based Model</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of samples: 785 </span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 2 </span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Rules: 4 </span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Non-standard options: attempt to group attributes</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(C5_rules_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class1     </span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(C5_rules_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1            1            0</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2            1            0</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3            0            1</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4            1            0</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5            1            0</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6            1            0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="decision-tree-decision_tree" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree-decision_tree">Decision Tree (<code>decision_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href=""><code>rpart</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href=""><code>C5.0</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href=""><code>partykit</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because rpart is the default.</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; n= 785 </span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; node), split, n, loss, yval, (yprob)</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       * denotes terminal node</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1) root 785 351 Class1 (0.5528662 0.4471338)  </span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2) B&lt; -0.06526451 399  61 Class1 (0.8471178 0.1528822) *</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3) B&gt;=-0.06526451 386  96 Class2 (0.2487047 0.7512953)  </span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      6) B&lt; 0.7339337 194  72 Class2 (0.3711340 0.6288660)  </span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       12) A&gt;=0.6073948 49  13 Class1 (0.7346939 0.2653061) *</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       13) A&lt; 0.6073948 145  36 Class2 (0.2482759 0.7517241) *</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      7) B&gt;=0.7339337 192  24 Class2 (0.1250000 0.8750000) *</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class1     </span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.735        0.265</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.847        0.153</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.248        0.752</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.847        0.153</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.847        0.153</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.847        0.153</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"C5.0"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; C5.0.default(x = x, y = y, trials = 1, control = C50::C5.0Control(minCases =</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2, sample = 0))</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Classification Tree</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of samples: 785 </span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 2 </span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tree size: 4 </span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Non-standard options: attempt to group attributes</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class1     </span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.732        0.268</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.846        0.154</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.236        0.764</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.846        0.154</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.846        0.154</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.846        0.154</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"partykit"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model formula:</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class ~ A + B</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitted party:</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] B &lt;= -0.06906</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] B &lt;= -0.50486: Class1 (n = 291, err = 8.2%)</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] B &gt; -0.50486</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] A &lt;= -0.07243: Class1 (n = 77, err = 45.5%)</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [6] A &gt; -0.07243: Class1 (n = 31, err = 6.5%)</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [7] B &gt; -0.06906</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [8] B &lt;= 0.72938</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [9] A &lt;= 0.60196: Class2 (n = 145, err = 24.8%)</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [10] A &gt; 0.60196</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [11] B &lt;= 0.44701: Class1 (n = 23, err = 4.3%)</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [12] B &gt; 0.44701: Class1 (n = 26, err = 46.2%)</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [13] B &gt; 0.72938: Class2 (n = 192, err = 12.5%)</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of inner nodes:    6</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of terminal nodes: 7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class1     </span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.538       0.462 </span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.935       0.0645</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.248       0.752 </span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.918       0.0825</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.918       0.0825</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.935       0.0645</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> tbl_bin<span class="sc">$</span>training)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: Class ~ .</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DecisionTreeClassificationModel: uid=decision_tree_classifier__a4e63506_aa0e_40d3_9ba8_a6534c10629f, depth=5, numNodes=43, numClasses=2, numFeatures=2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> tbl_bin<span class="sc">$</span>test)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_class</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     </span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2    </span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class2    </span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1    </span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class2    </span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class2    </span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1    </span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 Class2</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> tbl_bin<span class="sc">$</span>test)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 2]</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_Class1 pred_Class2</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      0.260       0.740 </span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      0.260       0.740 </span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      0.860       0.140 </span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      0.260       0.740 </span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      0.260       0.740 </span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      0.923       0.0769</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7      0.0709      0.929</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="flexible-discriminant-analysis-discrim_flexible" class="level3">
<h3 class="anchored" data-anchor-id="flexible-discriminant-analysis-discrim_flexible">Flexible Discriminant Analysis (<code>discrim_flexible()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href=""><code>earth</code></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because earth is the default.</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>discrim_flexible_spec <span class="ot">&lt;-</span> <span class="fu">discrim_flexible</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>discrim_flexible_fit <span class="ot">&lt;-</span> discrim_flexible_spec <span class="sc">|&gt;</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>discrim_flexible_fit</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mda::fda(formula = class ~ ., data = data, method = earth::earth)</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension: 1 </span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Percent Between-Group Variance Explained:</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  v1 </span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 100 </span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training Misclassification Error: 0.1707 ( N = 785 )</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_flexible_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_flexible_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.339       0.661 </span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.848       0.152 </span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.342       0.658 </span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.964       0.0360</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.964       0.0360</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.875       0.125</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="linear-discriminant-analysis-discrim_linear" class="level3">
<h3 class="anchored" data-anchor-id="linear-discriminant-analysis-discrim_linear">Linear Discriminant Analysis (<code>discrim_linear()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href=""><code>MASS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href=""><code>mda</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href=""><code>sda</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false" href=""><code>sparsediscrim</code></a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because MASS is the default.</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>discrim_linear_spec <span class="ot">&lt;-</span> <span class="fu">discrim_linear</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>discrim_linear_fit <span class="ot">&lt;-</span> discrim_linear_spec <span class="sc">|&gt;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>discrim_linear_fit</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lda(class ~ ., data = data)</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prior probabilities of groups:</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Class1    Class2 </span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.5528662 0.4471338 </span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Group means:</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 A          B</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1 -0.2982900 -0.5573140</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2  0.3688258  0.6891006</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients of linear discriminants:</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          LD1</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; A -0.6068479</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; B  1.7079953</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_linear_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_linear_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.369       0.631 </span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.868       0.132 </span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.541       0.459 </span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.984       0.0158</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.928       0.0718</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.854       0.146</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>discrim_linear_spec <span class="ot">&lt;-</span> <span class="fu">discrim_linear</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"mda"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>discrim_linear_fit <span class="ot">&lt;-</span> discrim_linear_spec <span class="sc">|&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>discrim_linear_fit</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mda::fda(formula = class ~ ., data = data, method = mda::gen.ridge, </span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     keep.fitted = FALSE)</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension: 1 </span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Percent Between-Group Variance Explained:</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  v1 </span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 100 </span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom (per dimension): 1.99423 </span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training Misclassification Error: 0.17707 ( N = 785 )</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_linear_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_linear_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.368       0.632 </span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.867       0.133 </span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.542       0.458 </span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.984       0.0158</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.928       0.0718</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.853       0.147</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>discrim_linear_spec <span class="ot">&lt;-</span> <span class="fu">discrim_linear</span>() <span class="sc">|&gt;</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"sda"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>discrim_linear_fit <span class="ot">&lt;-</span> discrim_linear_spec <span class="sc">|&gt;</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>discrim_linear_fit</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $regularization</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       lambda   lambda.var lambda.freqs </span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.003136201  0.067551534  0.112819609 </span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $freqs</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Class1    Class2 </span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.5469019 0.4530981 </span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $alpha</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Class1     Class2 </span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.8934125 -1.2349286 </span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $beta</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 A         B</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1  0.4565325 -1.298858</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2 -0.5510473  1.567757</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "shrinkage"</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "sda"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_linear_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_linear_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.366       0.634 </span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.860       0.140 </span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.536       0.464 </span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.982       0.0176</span></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.923       0.0768</span></span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.845       0.155</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>discrim_linear_spec <span class="ot">&lt;-</span> <span class="fu">discrim_linear</span>() <span class="sc">|&gt;</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"sparsediscrim"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>discrim_linear_fit <span class="ot">&lt;-</span> discrim_linear_spec <span class="sc">|&gt;</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>discrim_linear_fit</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diagonal LDA</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sample Size: 785 </span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Features: 2 </span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Classes and Prior Probabilities:</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Class1 (55.29%), Class2 (44.71%)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_linear_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_linear_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.182      0.818  </span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.755      0.245  </span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.552      0.448  </span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.996      0.00372</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.973      0.0274 </span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.629      0.371</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="quandratic-discriminant-analysis-discrim_quad" class="level3">
<h3 class="anchored" data-anchor-id="quandratic-discriminant-analysis-discrim_quad">Quandratic Discriminant Analysis (<code>discrim_quad()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href=""><code>MASS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href=""><code>sparsediscrim</code></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>discrim_quad_spec <span class="ot">&lt;-</span> <span class="fu">discrim_quad</span>()</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because MASS is the default.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>discrim_quad_fit <span class="ot">&lt;-</span> discrim_quad_spec <span class="sc">|&gt;</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>discrim_quad_fit</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; qda(class ~ ., data = data)</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prior probabilities of groups:</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Class1    Class2 </span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.5528662 0.4471338 </span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Group means:</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 A          B</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1 -0.2982900 -0.5573140</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2  0.3688258  0.6891006</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_quad_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_quad_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.340       0.660 </span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.884       0.116 </span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.500       0.500 </span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.965       0.0349</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.895       0.105 </span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.895       0.105</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>discrim_quad_spec <span class="ot">&lt;-</span> <span class="fu">discrim_quad</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"sparsediscrim"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>discrim_quad_fit <span class="ot">&lt;-</span> discrim_quad_spec <span class="sc">|&gt;</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>discrim_quad_fit</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diagonal QDA</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sample Size: 785 </span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Features: 2 </span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Classes and Prior Probabilities:</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Class1 (55.29%), Class2 (44.71%)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_quad_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_quad_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.180      0.820  </span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.750      0.250  </span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.556      0.444  </span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.994      0.00634</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.967      0.0328 </span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.630      0.370</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="regularized-discriminant-analysis-discrim_regularized" class="level3">
<h3 class="anchored" data-anchor-id="regularized-discriminant-analysis-discrim_regularized">Regularized Discriminant Analysis (<code>discrim_regularized()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href=""><code>klaR</code></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because klaR is the default.</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>discrim_regularized_spec <span class="ot">&lt;-</span> <span class="fu">discrim_regularized</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>discrim_regularized_fit <span class="ot">&lt;-</span> discrim_regularized_spec <span class="sc">|&gt;</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>discrim_regularized_fit</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call: </span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rda(formula = class ~ ., data = data)</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Regularization parameters: </span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        gamma       lambda </span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3.348721e-05 3.288193e-04 </span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prior probabilities of groups: </span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Class1    Class2 </span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.5528662 0.4471338 </span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Misclassification rate: </span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        apparent: 17.707 %</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cross-validated: 17.566 %</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_regularized_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(discrim_regularized_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.340       0.660 </span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.884       0.116 </span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.501       0.499 </span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.965       0.0349</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.895       0.105 </span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.895       0.105</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="generalized-additive-models-gen_additive_mod" class="level3">
<h3 class="anchored" data-anchor-id="generalized-additive-models-gen_additive_mod">Generalized Additive Models (<code>gen_additive_mod()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href=""><code>mgcv</code></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>gen_additive_mod_spec <span class="ot">&lt;-</span> <span class="fu">gen_additive_mod</span>() <span class="sc">|&gt;</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because mgcv is the default.</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>gen_additive_mod_fit <span class="ot">&lt;-</span> </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  gen_additive_mod_spec <span class="sc">|&gt;</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> <span class="fu">s</span>(A) <span class="sc">+</span> <span class="fu">s</span>(B), <span class="at">data =</span> bin_train)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>gen_additive_mod_fit</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family: binomial </span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Link function: logit </span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class ~ s(A) + s(B)</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2.76 4.22  total = 7.98 </span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UBRE score: -0.153537</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(gen_additive_mod_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(gen_additive_mod_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.400       0.600 </span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.826       0.174 </span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.454       0.546 </span></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.975       0.0250</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.929       0.0711</span></span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.829       0.171</span></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(gen_additive_mod_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower_Class1 .pred_upper_Class1 .pred_lower_Class2 .pred_upper_Class2</span></span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &lt;dbl[1d]&gt;          &lt;dbl[1d]&gt;          &lt;dbl[1d]&gt;          &lt;dbl[1d]&gt;</span></span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              0.304              0.504            0.496                0.696</span></span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2              0.739              0.889            0.111                0.261</span></span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3              0.364              0.546            0.454                0.636</span></span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4              0.846              0.996            0.00358              0.154</span></span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5              0.881              0.958            0.0416               0.119</span></span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6              0.735              0.894            0.106                0.265</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="logistic-regression-logistic_reg" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-logistic_reg">Logistic Regression (<code>logistic_reg()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href=""><code>glm</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href=""><code>brulee</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href=""><code>gee</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false" href=""><code>glmer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-5" role="tab" aria-controls="tabset-13-5" aria-selected="false" href=""><code>glmnet</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-6" role="tab" aria-controls="tabset-13-6" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-7" role="tab" aria-controls="tabset-13-7" aria-selected="false" href=""><code>keras</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-8" role="tab" aria-controls="tabset-13-8" aria-selected="false" href=""><code>LiblineaR</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-9" role="tab" aria-controls="tabset-13-9" aria-selected="false" href=""><code>stan</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-10" role="tab" aria-controls="tabset-13-10" aria-selected="false" href=""><code>stan_glmer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-11" role="tab" aria-controls="tabset-13-11" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>()</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because glm is the default.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> logistic_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  stats::glm(formula = class ~ ., family = stats::binomial, data = data)</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)            A            B  </span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -0.3563      -1.1250       2.8154  </span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 784 Total (i.e. Null);  782 Residual</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       1079 </span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 666.9     AIC: 672.9</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.400       0.600 </span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.862       0.138 </span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.541       0.459 </span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.977       0.0234</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.909       0.0905</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.853       0.147</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower_Class1 .pred_upper_Class1 .pred_lower_Class2 .pred_upper_Class2</span></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              0.339              0.465             0.535              0.661 </span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2              0.816              0.897             0.103              0.184 </span></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3              0.493              0.588             0.412              0.507 </span></span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4              0.960              0.986             0.0137             0.0395</span></span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5              0.875              0.935             0.0647             0.125 </span></span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6              0.800              0.894             0.106              0.200</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">466</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> logistic_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Logistic regression</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 785 samples, 2 features, 2 classes </span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class weights Class1=1, Class2=1 </span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weight decay: 0.001 </span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; batch size: 707 </span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; validation loss after 1 epoch: 0.283</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.412       0.588 </span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.854       0.146 </span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.537       0.463 </span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.971       0.0294</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.896       0.104 </span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.848       0.152</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"gee"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  logistic_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> visit <span class="sc">+</span> <span class="fu">id_var</span>(patientID), <span class="at">data =</span> cls_group_train)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; running glm to get initial regression estimate</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  gee S-function, version 4.13 modified 98/01/27 (1998) </span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Link:                      Logit </span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance to Mean Relation: Binomial </span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Correlation Structure:     Independent </span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gee::gee(formula = outcome ~ treatment + visit, id = data$patientID, </span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = data, family = binomial)</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of observations :  1433 </span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum cluster size   :  7 </span></span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          (Intercept) treatmentterbinafine                visit </span></span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          -0.06853546          -0.25700680          -0.35646522 </span></span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated Scale Parameter:  0.9903994</span></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Iterations:  1</span></span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Working Correlation[1:4,1:4]</span></span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]    0    1    0    0</span></span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]    0    0    1    0</span></span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,]    0    0    0    1</span></span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Returned Error Value:</span></span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 1</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_class </span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       </span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 none or mild</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 none or mild</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 none or mild</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 none or mild</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 none or mild</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 none or mild</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 none or mild</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 none or mild</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 none or mild</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 none or mild</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 2</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    `.pred_none or mild` `.pred_moderate or severe`</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   &lt;dbl&gt;                      &lt;dbl&gt;</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1                0.664                     0.336 </span></span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2                0.739                     0.261 </span></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3                0.801                     0.199 </span></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4                0.852                     0.148 </span></span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5                0.892                     0.108 </span></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6                0.922                     0.0784</span></span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7                0.944                     0.0562</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8                0.605                     0.395 </span></span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9                0.686                     0.314 </span></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10                0.757                     0.243 </span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  logistic_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> visit <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> patientID), <span class="at">data =</span> cls_group_train)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Approximation) [glmerMod]</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: binomial  ( logit )</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: outcome ~ treatment * visit + (1 | patientID)</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: data</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       AIC       BIC    logLik -2*log(L)  df.resid </span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  863.8271  890.1647 -426.9135  853.8271      1428 </span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups    Name        Std.Dev.</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  patientID (Intercept) 8.35    </span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of obs: 1433, groups:  patientID, 219</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed Effects:</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (Intercept)        treatmentterbinafine  </span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  -4.574209                   -0.511919  </span></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      visit  treatmentterbinafine:visit  </span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  -0.987246                   -0.001121</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 1</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_class </span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       </span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 none or mild</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 none or mild</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 none or mild</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 none or mild</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 none or mild</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 none or mild</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 none or mild</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 none or mild</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 none or mild</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 none or mild</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 2</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    `.pred_none or mild` `.pred_moderate or severe`</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   &lt;dbl&gt;                      &lt;dbl&gt;</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1                0.998                 0.00230   </span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2                0.999                 0.000856  </span></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3                1.000                 0.000319  </span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4                1.000                 0.000119  </span></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5                1.000                 0.0000441 </span></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6                1.000                 0.0000164 </span></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7                1.000                 0.00000612</span></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8                0.996                 0.00383   </span></span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9                0.999                 0.00143   </span></span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10                0.999                 0.000533  </span></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-5-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>(<span class="at">penalty =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> logistic_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "binomial") </span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Df  %Dev   Lambda</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0  0.00 0.308300</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   1  4.75 0.280900</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   1  8.73 0.256000</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   1 12.10 0.233200</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   1 14.99 0.212500</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   1 17.46 0.193600</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   1 19.60 0.176400</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   1 21.45 0.160800</span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   1 23.05 0.146500</span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1 24.44 0.133500</span></span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  1 25.65 0.121600</span></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  1 26.70 0.110800</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13  1 27.61 0.101000</span></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14  1 28.40 0.091990</span></span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15  1 29.08 0.083820</span></span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16  1 29.68 0.076370</span></span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17  1 30.19 0.069590</span></span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18  1 30.63 0.063410</span></span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19  1 31.00 0.057770</span></span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20  1 31.33 0.052640</span></span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21  1 31.61 0.047960</span></span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22  1 31.85 0.043700</span></span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23  1 32.05 0.039820</span></span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24  2 32.62 0.036280</span></span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25  2 33.41 0.033060</span></span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26  2 34.10 0.030120</span></span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27  2 34.68 0.027450</span></span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28  2 35.19 0.025010</span></span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29  2 35.63 0.022790</span></span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30  2 36.01 0.020760</span></span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 31  2 36.33 0.018920</span></span>
<span id="cb127-41"><a href="#cb127-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32  2 36.62 0.017240</span></span>
<span id="cb127-42"><a href="#cb127-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33  2 36.86 0.015710</span></span>
<span id="cb127-43"><a href="#cb127-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 34  2 37.06 0.014310</span></span>
<span id="cb127-44"><a href="#cb127-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 35  2 37.24 0.013040</span></span>
<span id="cb127-45"><a href="#cb127-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 36  2 37.39 0.011880</span></span>
<span id="cb127-46"><a href="#cb127-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37  2 37.52 0.010830</span></span>
<span id="cb127-47"><a href="#cb127-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 38  2 37.63 0.009864</span></span>
<span id="cb127-48"><a href="#cb127-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 39  2 37.72 0.008988</span></span>
<span id="cb127-49"><a href="#cb127-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40  2 37.80 0.008189</span></span>
<span id="cb127-50"><a href="#cb127-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 41  2 37.86 0.007462</span></span>
<span id="cb127-51"><a href="#cb127-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 42  2 37.92 0.006799</span></span>
<span id="cb127-52"><a href="#cb127-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 43  2 37.97 0.006195</span></span>
<span id="cb127-53"><a href="#cb127-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44  2 38.01 0.005644</span></span>
<span id="cb127-54"><a href="#cb127-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 45  2 38.04 0.005143</span></span>
<span id="cb127-55"><a href="#cb127-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 46  2 38.07 0.004686</span></span>
<span id="cb127-56"><a href="#cb127-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47  2 38.10 0.004270</span></span>
<span id="cb127-57"><a href="#cb127-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48  2 38.12 0.003891</span></span>
<span id="cb127-58"><a href="#cb127-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 49  2 38.13 0.003545</span></span>
<span id="cb127-59"><a href="#cb127-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 50  2 38.15 0.003230</span></span>
<span id="cb127-60"><a href="#cb127-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 51  2 38.16 0.002943</span></span>
<span id="cb127-61"><a href="#cb127-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 52  2 38.17 0.002682</span></span>
<span id="cb127-62"><a href="#cb127-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 53  2 38.18 0.002443</span></span>
<span id="cb127-63"><a href="#cb127-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 54  2 38.18 0.002226</span></span>
<span id="cb127-64"><a href="#cb127-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 55  2 38.19 0.002029</span></span>
<span id="cb127-65"><a href="#cb127-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 56  2 38.19 0.001848</span></span>
<span id="cb127-66"><a href="#cb127-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 57  2 38.20 0.001684</span></span>
<span id="cb127-67"><a href="#cb127-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 58  2 38.20 0.001534</span></span>
<span id="cb127-68"><a href="#cb127-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 59  2 38.20 0.001398</span></span>
<span id="cb127-69"><a href="#cb127-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 60  2 38.21 0.001274</span></span>
<span id="cb127-70"><a href="#cb127-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 61  2 38.21 0.001161</span></span>
<span id="cb127-71"><a href="#cb127-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 62  2 38.21 0.001058</span></span>
<span id="cb127-72"><a href="#cb127-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 63  2 38.21 0.000964</span></span>
<span id="cb127-73"><a href="#cb127-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 64  2 38.21 0.000878</span></span>
<span id="cb127-74"><a href="#cb127-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 65  2 38.21 0.000800</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.383       0.617 </span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.816       0.184 </span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.537       0.463 </span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.969       0.0313</span></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.894       0.106 </span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.797       0.203</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-6-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> logistic_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialModel: glm</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  GLM_model_R_1770287512312_5717 </span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GLM Model: summary</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     family  link                                regularization</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 binomial logit Elastic Net (alpha = 0.5, lambda = 6.162E-4 )</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_predictors_total number_of_active_predictors number_of_iterations</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                          2                           2                    4</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      training_frame</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 object_zkelygexok</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients: glm coefficients</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       names coefficients standardized_coefficients</span></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Intercept    -0.350788                 -0.350788</span></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         A    -1.084233                 -1.084233</span></span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         B     2.759366                  2.759366</span></span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialMetrics: glm</span></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.130451</span></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.3611799</span></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLoss:  0.4248206</span></span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Per-Class Error:  0.1722728</span></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUC:  0.8889644</span></span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUCPR:  0.8520865</span></span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gini:  0.7779288</span></span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R^2:  0.4722968</span></span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance:  666.9684</span></span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC:  672.9684</span></span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:</span></span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Class1 Class2    Error      Rate</span></span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1    350     84 0.193548   =84/434</span></span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2     53    298 0.150997   =53/351</span></span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Totals    403    382 0.174522  =137/785</span></span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Metrics: Maximum metrics at their respective thresholds</span></span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         metric threshold      value idx</span></span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                       max f1  0.411045   0.813097 213</span></span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                       max f2  0.229916   0.868991 279</span></span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 max f0point5  0.565922   0.816135 166</span></span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 max accuracy  0.503565   0.826752 185</span></span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                max precision  0.997356   1.000000   0</span></span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                   max recall  0.009705   1.000000 395</span></span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7              max specificity  0.997356   1.000000   0</span></span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             max absolute_mcc  0.411045   0.652014 213</span></span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   max min_per_class_accuracy  0.454298   0.822581 201</span></span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 max mean_per_class_accuracy  0.411045   0.827727 213</span></span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11                     max tns  0.997356 434.000000   0</span></span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12                     max fns  0.997356 349.000000   0</span></span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13                     max fps  0.001723 434.000000 399</span></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14                     max tps  0.009705 351.000000 395</span></span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15                     max tnr  0.997356   1.000000   0</span></span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16                     max fnr  0.997356   0.994302   0</span></span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17                     max fpr  0.001723   1.000000 399</span></span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18                     max tpr  0.009705   1.000000 395</span></span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.399       0.601 </span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.857       0.143 </span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.540       0.460 </span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.976       0.0243</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.908       0.0925</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.848       0.152</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-7-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"keras"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">730</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> logistic_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: "sequential"</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Layer (type)                       Output Shape                    Param #     </span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  dense (Dense)                      (None, 1)                       3           </span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  dense_1 (Dense)                    (None, 2)                       4           </span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total params: 7 (28.00 Byte)</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Trainable params: 7 (28.00 Byte)</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Non-trainable params: 0 (0.00 Byte)</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1/1 - 0s - 81ms/epoch - 81ms/step</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class2</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1/1 - 0s - 6ms/epoch - 6ms/step</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.212       0.788 </span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.627       0.373 </span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.580       0.420 </span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.990       0.0101</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.954       0.0461</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.470       0.530</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-8-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"LiblineaR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> logistic_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $TypeDetail</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "L2-regularized logistic regression primal (L2R_LR)"</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Type</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $W</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             A        B      Bias</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 1.014233 -2.65166 0.3363362</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Bias</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ClassNames</span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] Class1 Class2</span></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Levels: Class1 Class2</span></span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $NbClass</span></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "LiblineaR"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.397       0.603 </span></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.847       0.153 </span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.539       0.461 </span></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.973       0.0267</span></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.903       0.0974</span></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.837       0.163</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-9-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stan"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">96</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  logistic_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> visit, <span class="at">data =</span> cls_group_train)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stan_glm</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  family:       binomial [logit]</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  formula:      outcome ~ treatment * visit</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  observations: 1433</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  predictors:   4</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                            Median MAD_SD</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                -0.137  0.187</span></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatmentterbinafine       -0.108  0.264</span></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; visit                      -0.335  0.050</span></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatmentterbinafine:visit -0.048  0.073</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For help interpreting the printed output see ?print.stanreg</span></span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 1</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_class </span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       </span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 none or mild</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 none or mild</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 none or mild</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 none or mild</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 none or mild</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 none or mild</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 none or mild</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 none or mild</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 none or mild</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 none or mild</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 2</span></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    `.pred_none or mild` `.pred_moderate or severe`</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   &lt;dbl&gt;                      &lt;dbl&gt;</span></span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1                0.652                     0.348 </span></span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2                0.734                     0.266 </span></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3                0.802                     0.198 </span></span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4                0.856                     0.144 </span></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5                0.898                     0.102 </span></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6                0.928                     0.0721</span></span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7                0.950                     0.0502</span></span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8                0.617                     0.383 </span></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9                0.692                     0.308 </span></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10                0.759                     0.241 </span></span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 4</span></span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    `.pred_lower_none or mild` `.pred_upper_none or mild` .pred_lower_moderate …¹</span></span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         &lt;dbl&gt;                      &lt;dbl&gt;                   &lt;dbl&gt;</span></span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1                      0.583                      0.715                  0.285 </span></span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2                      0.689                      0.776                  0.224 </span></span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3                      0.771                      0.832                  0.168 </span></span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4                      0.827                      0.883                  0.117 </span></span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5                      0.868                      0.924                  0.0761</span></span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6                      0.899                      0.952                  0.0482</span></span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7                      0.922                      0.970                  0.0302</span></span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8                      0.547                      0.683                  0.317 </span></span>
<span id="cb142-43"><a href="#cb142-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9                      0.644                      0.736                  0.264 </span></span>
<span id="cb142-44"><a href="#cb142-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10                      0.723                      0.791                  0.209 </span></span>
<span id="cb142-45"><a href="#cb142-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb142-46"><a href="#cb142-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ abbreviated name: ¹​`.pred_lower_moderate or severe`</span></span>
<span id="cb142-47"><a href="#cb142-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 1 more variable: `.pred_upper_moderate or severe` &lt;dbl&gt;</span></span>
<span id="cb142-48"><a href="#cb142-48" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb142-49"><a href="#cb142-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 4</span></span>
<span id="cb142-50"><a href="#cb142-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    `.pred_lower_none or mild` `.pred_upper_none or mild` .pred_lower_moderate …¹</span></span>
<span id="cb142-51"><a href="#cb142-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         &lt;dbl&gt;                      &lt;dbl&gt;                   &lt;dbl&gt;</span></span>
<span id="cb142-52"><a href="#cb142-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1                          0                          1                       0</span></span>
<span id="cb142-53"><a href="#cb142-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2                          0                          1                       0</span></span>
<span id="cb142-54"><a href="#cb142-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3                          0                          1                       0</span></span>
<span id="cb142-55"><a href="#cb142-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4                          0                          1                       0</span></span>
<span id="cb142-56"><a href="#cb142-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5                          0                          1                       0</span></span>
<span id="cb142-57"><a href="#cb142-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6                          0                          1                       0</span></span>
<span id="cb142-58"><a href="#cb142-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7                          0                          1                       0</span></span>
<span id="cb142-59"><a href="#cb142-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8                          0                          1                       0</span></span>
<span id="cb142-60"><a href="#cb142-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9                          0                          1                       0</span></span>
<span id="cb142-61"><a href="#cb142-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10                          0                          1                       0</span></span>
<span id="cb142-62"><a href="#cb142-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb142-63"><a href="#cb142-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ abbreviated name: ¹​`.pred_lower_moderate or severe`</span></span>
<span id="cb142-64"><a href="#cb142-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 1 more variable: `.pred_upper_moderate or severe` &lt;dbl&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-10-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stan_glmer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">484</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  logistic_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> visit <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> patientID), <span class="at">data =</span> cls_group_train)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stan_glmer</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  family:       binomial [logit]</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  formula:      outcome ~ treatment * visit + (1 | patientID)</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  observations: 1433</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                            Median MAD_SD</span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                -0.628  0.585</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatmentterbinafine       -0.686  0.821</span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; visit                      -0.830  0.105</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; treatmentterbinafine:visit -0.023  0.143</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error terms:</span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups    Name        Std.Dev.</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  patientID (Intercept) 4.376   </span></span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Num. levels: patientID 219 </span></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For help interpreting the printed output see ?print.stanreg</span></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 1</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_class </span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       </span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 none or mild</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 none or mild</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 none or mild</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 none or mild</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 none or mild</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 none or mild</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 none or mild</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 none or mild</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 none or mild</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 none or mild</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 2</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    `.pred_none or mild` `.pred_moderate or severe`</span></span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   &lt;dbl&gt;                      &lt;dbl&gt;</span></span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1                0.671                     0.329 </span></span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2                0.730                     0.270 </span></span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3                0.796                     0.204 </span></span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4                0.847                     0.153 </span></span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5                0.882                     0.118 </span></span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6                0.909                     0.0908</span></span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7                0.934                     0.0655</span></span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8                0.613                     0.387 </span></span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9                0.681                     0.319 </span></span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10                0.744                     0.256 </span></span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb146-31"><a href="#cb146-31" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb146-32"><a href="#cb146-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 4</span></span>
<span id="cb146-33"><a href="#cb146-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    `.pred_lower_none or mild` `.pred_upper_none or mild` .pred_lower_moderate …¹</span></span>
<span id="cb146-34"><a href="#cb146-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         &lt;dbl&gt;                      &lt;dbl&gt;                   &lt;dbl&gt;</span></span>
<span id="cb146-35"><a href="#cb146-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1                   0.00184                       1.000             0.0000217  </span></span>
<span id="cb146-36"><a href="#cb146-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2                   0.00417                       1.000             0.00000942 </span></span>
<span id="cb146-37"><a href="#cb146-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3                   0.00971                       1.000             0.00000412 </span></span>
<span id="cb146-38"><a href="#cb146-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4                   0.0214                        1.000             0.00000169 </span></span>
<span id="cb146-39"><a href="#cb146-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5                   0.0465                        1.000             0.000000706</span></span>
<span id="cb146-40"><a href="#cb146-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6                   0.101                         1.000             0.000000300</span></span>
<span id="cb146-41"><a href="#cb146-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7                   0.203                         1.000             0.000000120</span></span>
<span id="cb146-42"><a href="#cb146-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8                   0.000923                      1.000             0.0000440  </span></span>
<span id="cb146-43"><a href="#cb146-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9                   0.00196                       1.000             0.0000175  </span></span>
<span id="cb146-44"><a href="#cb146-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10                   0.00447                       1.000             0.00000724 </span></span>
<span id="cb146-45"><a href="#cb146-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb146-46"><a href="#cb146-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ abbreviated name: ¹​`.pred_lower_moderate or severe`</span></span>
<span id="cb146-47"><a href="#cb146-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 1 more variable: `.pred_upper_moderate or severe` &lt;dbl&gt;</span></span>
<span id="cb146-48"><a href="#cb146-48" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> cls_group_test)</span>
<span id="cb146-49"><a href="#cb146-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 475 × 4</span></span>
<span id="cb146-50"><a href="#cb146-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    `.pred_lower_none or mild` `.pred_upper_none or mild` .pred_lower_moderate …¹</span></span>
<span id="cb146-51"><a href="#cb146-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         &lt;dbl&gt;                      &lt;dbl&gt;                   &lt;dbl&gt;</span></span>
<span id="cb146-52"><a href="#cb146-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1                          0                          1                       0</span></span>
<span id="cb146-53"><a href="#cb146-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2                          0                          1                       0</span></span>
<span id="cb146-54"><a href="#cb146-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3                          0                          1                       0</span></span>
<span id="cb146-55"><a href="#cb146-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4                          0                          1                       0</span></span>
<span id="cb146-56"><a href="#cb146-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5                          0                          1                       0</span></span>
<span id="cb146-57"><a href="#cb146-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6                          0                          1                       0</span></span>
<span id="cb146-58"><a href="#cb146-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7                          0                          1                       0</span></span>
<span id="cb146-59"><a href="#cb146-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8                          0                          1                       0</span></span>
<span id="cb146-60"><a href="#cb146-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9                          0                          1                       0</span></span>
<span id="cb146-61"><a href="#cb146-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10                          0                          1                       0</span></span>
<span id="cb146-62"><a href="#cb146-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 465 more rows</span></span>
<span id="cb146-63"><a href="#cb146-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ abbreviated name: ¹​`.pred_lower_moderate or severe`</span></span>
<span id="cb146-64"><a href="#cb146-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 1 more variable: `.pred_upper_moderate or severe` &lt;dbl&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-11-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit <span class="ot">&lt;-</span> logistic_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> tbl_bin<span class="sc">$</span>training)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>logistic_reg_fit</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: Class ~ .</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)           A           B </span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   -3.731170   -1.214355    3.794186</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> tbl_bin<span class="sc">$</span>test)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_class</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     </span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2    </span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class2    </span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1    </span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class2    </span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class2    </span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1    </span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 Class2</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logistic_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> tbl_bin<span class="sc">$</span>test)</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 2]</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_Class1 pred_Class2</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       0.130       0.870</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       0.262       0.738</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       0.787       0.213</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       0.279       0.721</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       0.498       0.502</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       0.900       0.100</span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       0.161       0.839</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="multivariate-adaptive-regression-splines-mars" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-adaptive-regression-splines-mars">Multivariate Adaptive Regression Splines (<code>mars()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href=""><code>earth</code></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>mars_spec <span class="ot">&lt;-</span> <span class="fu">mars</span>() <span class="sc">|&gt;</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because earth is the default.</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>mars_fit <span class="ot">&lt;-</span> mars_spec <span class="sc">|&gt;</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>mars_fit</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GLM (family binomial, link logit):</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  nulldev  df       dev  df   devratio     AIC iters converged</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1079.45 784   638.975 779      0.408     651     5         1</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Earth selected 6 of 13 terms, and 2 of 2 predictors</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Termination condition: Reached nk 21</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Importance: B, A</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of terms at each degree of interaction: 1 5 (additive model)</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Earth GCV 0.1342746    RSS 102.4723    GRSq 0.4582121    RSq 0.4719451</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mars_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mars_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.410       0.590 </span></span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.794       0.206 </span></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.356       0.644 </span></span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.927       0.0729</span></span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.927       0.0729</span></span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.836       0.164</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="neural-networks-mlp" class="level3">
<h3 class="anchored" data-anchor-id="neural-networks-mlp">Neural Networks (<code>mlp()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href=""><code>nnet</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href=""><code>brulee</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false" href=""><code>brulee_two_layer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-5" role="tab" aria-controls="tabset-15-5" aria-selected="false" href=""><code>keras</code></a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because nnet is the default.</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">839</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; a 2-5-1 network with 21 weights</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; inputs: A B </span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; output(s): class </span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; options were - entropy fitting</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.390        0.610</span></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.685        0.315</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.433        0.567</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.722        0.278</span></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.720        0.280</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.684        0.316</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">38</span>)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multilayer perceptron</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; relu activation,</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 hidden units,</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17 model parameters</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 785 samples, 2 features, 2 classes </span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class weights Class1=1, Class2=1 </span></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weight decay: 0.001 </span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dropout proportion: 0 </span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; batch size: 707 </span></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; learn rate: 0.01 </span></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; validation loss after 5 epochs: 0.427</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.387       0.613 </span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.854       0.146 </span></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.540       0.460 </span></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.941       0.0589</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.882       0.118 </span></span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.842       0.158</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee_two_layer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">336</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multilayer perceptron</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; c(relu,relu) activation,</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; c(3,3) hidden units,</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29 model parameters</span></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 785 samples, 2 features, 2 classes </span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class weights Class1=1, Class2=1 </span></span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weight decay: 0.001 </span></span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dropout proportion: 0 </span></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; batch size: 707 </span></span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; learn rate: 0.01 </span></span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; validation loss after 17 epochs: 0.405</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.392       0.608 </span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.835       0.165 </span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.440       0.560 </span></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.938       0.0620</span></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.938       0.0620</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.848       0.152</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">306</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialModel: deeplearning</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  DeepLearning_model_R_1770287512312_5719 </span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Status of Neuron Layers: predicting .outcome, 2-class classification, bernoulli distribution, CrossEntropy loss, 1,002 weights/biases, 16.9 KB, 7,850 training samples, mini-batch size 1</span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1     2     Input  0.00 %       NA       NA        NA       NA       NA</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2   200 Rectifier  0.00 % 0.000000 0.000000  0.008355 0.020870 0.000000</span></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     3     2   Softmax      NA 0.000000 0.000000  0.003311 0.000205 0.000000</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          NA         NA        NA       NA</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    0.001630   0.103344  0.489596 0.030962</span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   -0.001547   0.402480 -0.040452 0.052851</span></span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialMetrics: deeplearning</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Metrics reported on full training frame **</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.2977407</span></span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.5456562</span></span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLoss:  0.9645075</span></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Per-Class Error:  0.1762509</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUC:  0.8895913</span></span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUCPR:  0.8505352</span></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gini:  0.7791826</span></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:</span></span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Class1 Class2    Error      Rate</span></span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1    328    106 0.244240  =106/434</span></span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2     38    313 0.108262   =38/351</span></span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Totals    366    419 0.183439  =144/785</span></span>
<span id="cb164-41"><a href="#cb164-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb164-42"><a href="#cb164-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Metrics: Maximum metrics at their respective thresholds</span></span>
<span id="cb164-43"><a href="#cb164-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         metric threshold      value idx</span></span>
<span id="cb164-44"><a href="#cb164-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                       max f1  0.027001   0.812987 311</span></span>
<span id="cb164-45"><a href="#cb164-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                       max f2  0.014770   0.869336 342</span></span>
<span id="cb164-46"><a href="#cb164-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 max f0point5  0.076925   0.816191 240</span></span>
<span id="cb164-47"><a href="#cb164-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 max accuracy  0.052351   0.828025 273</span></span>
<span id="cb164-48"><a href="#cb164-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                max precision  0.911921   1.000000   0</span></span>
<span id="cb164-49"><a href="#cb164-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                   max recall  0.000422   1.000000 397</span></span>
<span id="cb164-50"><a href="#cb164-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7              max specificity  0.911921   1.000000   0</span></span>
<span id="cb164-51"><a href="#cb164-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             max absolute_mcc  0.051136   0.651742 274</span></span>
<span id="cb164-52"><a href="#cb164-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   max min_per_class_accuracy  0.044334   0.820513 282</span></span>
<span id="cb164-53"><a href="#cb164-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 max mean_per_class_accuracy  0.051136   0.825400 274</span></span>
<span id="cb164-54"><a href="#cb164-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11                     max tns  0.911921 434.000000   0</span></span>
<span id="cb164-55"><a href="#cb164-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12                     max fns  0.911921 350.000000   0</span></span>
<span id="cb164-56"><a href="#cb164-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13                     max fps  0.000061 434.000000 399</span></span>
<span id="cb164-57"><a href="#cb164-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14                     max tps  0.000422 351.000000 397</span></span>
<span id="cb164-58"><a href="#cb164-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15                     max tnr  0.911921   1.000000   0</span></span>
<span id="cb164-59"><a href="#cb164-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16                     max fnr  0.911921   0.997151   0</span></span>
<span id="cb164-60"><a href="#cb164-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17                     max fpr  0.000061   1.000000 399</span></span>
<span id="cb164-61"><a href="#cb164-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18                     max tpr  0.000422   1.000000 397</span></span>
<span id="cb164-62"><a href="#cb164-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb164-63"><a href="#cb164-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.930      0.0702 </span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.992      0.00786</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.957      0.0429 </span></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.999      0.00128</span></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.995      0.00534</span></span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.992      0.00821</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-15-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-5-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"keras"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">216</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: "sequential_1"</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Layer (type)                       Output Shape                    Param #     </span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  dense_2 (Dense)                    (None, 5)                       15          </span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  dense_3 (Dense)                    (None, 2)                       12          </span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total params: 27 (108.00 Byte)</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Trainable params: 27 (108.00 Byte)</span></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Non-trainable params: 0 (0.00 Byte)</span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1/1 - 0s - 38ms/epoch - 38ms/step</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class2</span></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1/1 - 0s - 6ms/epoch - 6ms/step</span></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.315        0.685</span></span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.584        0.416</span></span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.508        0.492</span></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.896        0.104</span></span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.871        0.129</span></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.475        0.525</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="multinom-regression-multinom_reg" class="level3">
<h3 class="anchored" data-anchor-id="multinom-regression-multinom_reg">Multinom Regression (<code>multinom_reg()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href=""><code>nnet</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href=""><code>brulee</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false" href=""><code>glmnet</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-5" role="tab" aria-controls="tabset-16-5" aria-selected="false" href=""><code>keras</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-6" role="tab" aria-controls="tabset-16-6" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because nnet is the default.</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>multinom_reg_spec <span class="ot">&lt;-</span> <span class="fu">multinom_reg</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">634</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit <span class="ot">&lt;-</span> multinom_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> mtl_train)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nnet::multinom(formula = class ~ ., data = data, trace = FALSE)</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       (Intercept)        A        B</span></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; two    -0.5868435 1.881920 1.379106</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; three   0.2910810 1.129622 1.292802</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 315.8164 </span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 327.8164</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 three      </span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 three      </span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 three      </span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 one        </span></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 one        </span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 two        </span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 three      </span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 one</span></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_one .pred_two .pred_three</span></span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0.145     0.213        0.641 </span></span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   0.308     0.178        0.514 </span></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   0.350     0.189        0.461 </span></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   0.983     0.00123      0.0155</span></span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   0.956     0.00275      0.0415</span></span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   0.00318   0.754        0.243 </span></span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   0.0591    0.414        0.527 </span></span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   0.522     0.0465       0.431</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_spec <span class="ot">&lt;-</span> <span class="fu">multinom_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">837</span>)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit <span class="ot">&lt;-</span> multinom_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> mtl_train)</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multinomial regression</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 192 samples, 2 features, 3 classes </span></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class weights one=1, two=1, three=1 </span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weight decay: 0.001 </span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; batch size: 173 </span></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; validation loss after 1 epoch: 0.953</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 three      </span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 three      </span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 three      </span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 one        </span></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 one        </span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 two        </span></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 three      </span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 three</span></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_one .pred_two .pred_three</span></span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0.131     0.190        0.679 </span></span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   0.303     0.174        0.523 </span></span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   0.358     0.192        0.449 </span></span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   0.983     0.00125      0.0154</span></span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   0.948     0.00275      0.0491</span></span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   0.00344   0.796        0.200 </span></span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   0.0611    0.420        0.518 </span></span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   0.443     0.0390       0.518</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_spec <span class="ot">&lt;-</span> <span class="fu">multinom_reg</span>(<span class="at">penalty =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit <span class="ot">&lt;-</span> multinom_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> mtl_train)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "multinomial") </span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Df  %Dev   Lambda</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0  0.00 0.219200</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   1  1.61 0.199700</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   2  3.90 0.181900</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   2  6.07 0.165800</span></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   2  7.93 0.151100</span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   2  9.52 0.137600</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   2 10.90 0.125400</span></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   2 12.09 0.114300</span></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   2 13.13 0.104100</span></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  2 14.22 0.094870</span></span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  2 15.28 0.086440</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  2 16.20 0.078760</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13  2 16.99 0.071760</span></span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14  2 17.68 0.065390</span></span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15  2 18.28 0.059580</span></span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16  2 18.80 0.054290</span></span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17  2 19.24 0.049460</span></span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18  2 19.63 0.045070</span></span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19  2 19.96 0.041070</span></span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20  2 20.25 0.037420</span></span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21  2 20.49 0.034090</span></span>
<span id="cb177-31"><a href="#cb177-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22  2 20.70 0.031070</span></span>
<span id="cb177-32"><a href="#cb177-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23  2 20.88 0.028310</span></span>
<span id="cb177-33"><a href="#cb177-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24  2 21.04 0.025790</span></span>
<span id="cb177-34"><a href="#cb177-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25  2 21.17 0.023500</span></span>
<span id="cb177-35"><a href="#cb177-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26  2 21.28 0.021410</span></span>
<span id="cb177-36"><a href="#cb177-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27  2 21.38 0.019510</span></span>
<span id="cb177-37"><a href="#cb177-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28  2 21.46 0.017780</span></span>
<span id="cb177-38"><a href="#cb177-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29  2 21.53 0.016200</span></span>
<span id="cb177-39"><a href="#cb177-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30  2 21.58 0.014760</span></span>
<span id="cb177-40"><a href="#cb177-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 31  2 21.63 0.013450</span></span>
<span id="cb177-41"><a href="#cb177-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32  2 21.67 0.012250</span></span>
<span id="cb177-42"><a href="#cb177-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33  2 21.71 0.011160</span></span>
<span id="cb177-43"><a href="#cb177-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 34  2 21.74 0.010170</span></span>
<span id="cb177-44"><a href="#cb177-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 35  2 21.77 0.009269</span></span>
<span id="cb177-45"><a href="#cb177-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 36  2 21.79 0.008445</span></span>
<span id="cb177-46"><a href="#cb177-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37  2 21.82 0.007695</span></span>
<span id="cb177-47"><a href="#cb177-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 38  2 21.83 0.007011</span></span>
<span id="cb177-48"><a href="#cb177-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 39  2 21.85 0.006389</span></span>
<span id="cb177-49"><a href="#cb177-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40  2 21.86 0.005821</span></span>
<span id="cb177-50"><a href="#cb177-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 41  2 21.87 0.005304</span></span>
<span id="cb177-51"><a href="#cb177-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 42  2 21.88 0.004833</span></span>
<span id="cb177-52"><a href="#cb177-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 43  2 21.89 0.004403</span></span>
<span id="cb177-53"><a href="#cb177-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44  2 21.89 0.004012</span></span>
<span id="cb177-54"><a href="#cb177-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 45  2 21.90 0.003656</span></span>
<span id="cb177-55"><a href="#cb177-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 46  2 21.90 0.003331</span></span>
<span id="cb177-56"><a href="#cb177-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47  2 21.91 0.003035</span></span>
<span id="cb177-57"><a href="#cb177-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48  2 21.91 0.002765</span></span>
<span id="cb177-58"><a href="#cb177-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 49  2 21.91 0.002520</span></span>
<span id="cb177-59"><a href="#cb177-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 50  2 21.91 0.002296</span></span>
<span id="cb177-60"><a href="#cb177-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 51  2 21.92 0.002092</span></span>
<span id="cb177-61"><a href="#cb177-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 52  2 21.92 0.001906</span></span>
<span id="cb177-62"><a href="#cb177-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 53  2 21.92 0.001737</span></span>
<span id="cb177-63"><a href="#cb177-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 54  2 21.92 0.001582</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 three      </span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 three      </span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 three      </span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 one        </span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 one        </span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 two        </span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 three      </span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 one</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_one .pred_two .pred_three</span></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0.163     0.211        0.626 </span></span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   0.318     0.185        0.496 </span></span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   0.358     0.198        0.444 </span></span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   0.976     0.00268      0.0217</span></span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   0.940     0.00529      0.0544</span></span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   0.00617   0.699        0.295 </span></span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   0.0757    0.390        0.534 </span></span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   0.506     0.0563       0.438</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_spec <span class="ot">&lt;-</span> <span class="fu">multinom_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit <span class="ot">&lt;-</span> multinom_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> mtl_train)</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OMultinomialModel: glm</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  GLM_model_R_1770287512312_5722 </span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GLM Model: summary</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        family        link                                regularization</span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 multinomial multinomial Elastic Net (alpha = 0.5, lambda = 4.372E-4 )</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_predictors_total number_of_active_predictors number_of_iterations</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                          9                           6                    4</span></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      training_frame</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 object_jbhwnlsrno</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients: glm multinomial coefficients</span></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       names coefs_class_0 coefs_class_1 coefs_class_2 std_coefs_class_0</span></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Intercept     -1.119482     -0.831434     -1.706488         -1.083442</span></span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         A     -1.119327      0.002894      0.750746         -1.029113</span></span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         B     -1.208210      0.078752      0.162842         -1.187423</span></span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   std_coefs_class_1 std_coefs_class_2</span></span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         -0.819868         -1.830487</span></span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          0.002661          0.690238</span></span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          0.077397          0.160041</span></span>
<span id="cb181-28"><a href="#cb181-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-29"><a href="#cb181-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OMultinomialMetrics: glm</span></span>
<span id="cb181-30"><a href="#cb181-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb181-31"><a href="#cb181-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-32"><a href="#cb181-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training Set Metrics: </span></span>
<span id="cb181-33"><a href="#cb181-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =====================</span></span>
<span id="cb181-34"><a href="#cb181-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-35"><a href="#cb181-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Extract training frame with `h2o.getFrame("object_jbhwnlsrno")`</span></span>
<span id="cb181-36"><a href="#cb181-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.2982118</span></span>
<span id="cb181-37"><a href="#cb181-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.5460878</span></span>
<span id="cb181-38"><a href="#cb181-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.822443</span></span>
<span id="cb181-39"><a href="#cb181-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Per-Class Error: 0.4583896</span></span>
<span id="cb181-40"><a href="#cb181-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUC: (Extract with `h2o.auc`) NaN</span></span>
<span id="cb181-41"><a href="#cb181-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUCPR: (Extract with `h2o.aucpr`) NaN</span></span>
<span id="cb181-42"><a href="#cb181-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance: (Extract with `h2o.nulldeviance`) 404.5036</span></span>
<span id="cb181-43"><a href="#cb181-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: (Extract with `h2o.residual_deviance`) 315.8181</span></span>
<span id="cb181-44"><a href="#cb181-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R^2: (Extract with `h2o.r2`) 0.4682043</span></span>
<span id="cb181-45"><a href="#cb181-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: (Extract with `h2o.aic`) NaN</span></span>
<span id="cb181-46"><a href="#cb181-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></span>
<span id="cb181-47"><a href="#cb181-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =========================================================================</span></span>
<span id="cb181-48"><a href="#cb181-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></span>
<span id="cb181-49"><a href="#cb181-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        one three two  Error       Rate</span></span>
<span id="cb181-50"><a href="#cb181-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; one     59    18   1 0.2436 =  19 / 78</span></span>
<span id="cb181-51"><a href="#cb181-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; three   19    52   5 0.3158 =  24 / 76</span></span>
<span id="cb181-52"><a href="#cb181-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; two      7    24   7 0.8158 =  31 / 38</span></span>
<span id="cb181-53"><a href="#cb181-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Totals  85    94  13 0.3854 = 74 / 192</span></span>
<span id="cb181-54"><a href="#cb181-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-55"><a href="#cb181-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></span>
<span id="cb181-56"><a href="#cb181-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =======================================================================</span></span>
<span id="cb181-57"><a href="#cb181-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Top-3 Hit Ratios: </span></span>
<span id="cb181-58"><a href="#cb181-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   k hit_ratio</span></span>
<span id="cb181-59"><a href="#cb181-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1  0.614583</span></span>
<span id="cb181-60"><a href="#cb181-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 2  0.890625</span></span>
<span id="cb181-61"><a href="#cb181-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 3  1.000000</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 three      </span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 three      </span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 three      </span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 one        </span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 one        </span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 two        </span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 three      </span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 one</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_one .pred_three .pred_two</span></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0.146        0.641    0.213  </span></span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   0.308        0.513    0.179  </span></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   0.350        0.460    0.190  </span></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   0.983        0.0158   0.00128</span></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   0.955        0.0422   0.00284</span></span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   0.00329      0.244    0.752  </span></span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   0.0599       0.527    0.413  </span></span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   0.521        0.432    0.0469</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-16-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-5-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_spec <span class="ot">&lt;-</span> <span class="fu">multinom_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"keras"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit <span class="ot">&lt;-</span> multinom_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> mtl_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: "sequential_2"</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Layer (type)                       Output Shape                    Param #     </span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  dense_4 (Dense)                    (None, 1)                       3           </span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  dense_5 (Dense)                    (None, 3)                       6           </span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total params: 9 (36.00 Byte)</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Trainable params: 9 (36.00 Byte)</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Non-trainable params: 0 (0.00 Byte)</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1/1 - 0s - 38ms/epoch - 38ms/step</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 three      </span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 three      </span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 one        </span></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 one        </span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 one        </span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 three      </span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 three      </span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 one</span></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> mtl_test)</span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1/1 - 0s - 5ms/epoch - 5ms/step</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_one .pred_two .pred_three</span></span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    0.261      0.342      0.397 </span></span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    0.335      0.326      0.339 </span></span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    0.352      0.322      0.326 </span></span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    0.753      0.156      0.0914</span></span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    0.683      0.192      0.126 </span></span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    0.0913     0.336      0.572 </span></span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7    0.202      0.349      0.449 </span></span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8    0.418      0.302      0.281</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-16-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-6-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_spec <span class="ot">&lt;-</span> <span class="fu">multinom_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit <span class="ot">&lt;-</span> multinom_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> tbl_mtl<span class="sc">$</span>training)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>multinom_reg_fit</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: class ~ .</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       (Intercept)          A          B</span></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; one    0.05447853 -1.0569131 -0.9049194</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; three  0.41207949  0.1458870  0.3959664</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; two   -0.46655802  0.9110261  0.5089529</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> tbl_mtl<span class="sc">$</span>test)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_class</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     </span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 one       </span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 one       </span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 three     </span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 three     </span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 three     </span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 three     </span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 three</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(multinom_reg_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> tbl_mtl<span class="sc">$</span>test)</span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 3]</span></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_one pred_three pred_two</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0.910      0.0814  0.00904</span></span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   0.724      0.233   0.0427 </span></span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   0.124      0.620   0.256  </span></span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   0.0682     0.610   0.322  </span></span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   0.130      0.571   0.300  </span></span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   0.115      0.549   0.336  </span></span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   0.0517     0.524   0.424</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="naive-bayes-naive_bayes" class="level3">
<h3 class="anchored" data-anchor-id="naive-bayes-naive_bayes">Naive Bayes (<code>naive_Bayes()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href=""><code>klaR</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false" href=""><code>naivebayes</code></a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>naive_Bayes_spec <span class="ot">&lt;-</span> <span class="fu">naive_Bayes</span>() <span class="sc">|&gt;</span> </span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>naive_Bayes_fit <span class="ot">&lt;-</span> naive_Bayes_spec <span class="sc">|&gt;</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>naive_Bayes_fit</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialModel: naivebayes</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  NaiveBayes_model_R_1770287512312_5723 </span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Summary: </span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_response_levels min_apriori_probability max_apriori_probability</span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                         2                 0.44713                 0.55287</span></span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialMetrics: naivebayes</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.1737113</span></span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.4167869</span></span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLoss:  0.5473431</span></span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Per-Class Error:  0.2356138</span></span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUC:  0.8377152</span></span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUCPR:  0.788608</span></span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gini:  0.6754303</span></span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-27"><a href="#cb192-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:</span></span>
<span id="cb192-28"><a href="#cb192-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Class1 Class2    Error      Rate</span></span>
<span id="cb192-29"><a href="#cb192-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1    274    160 0.368664  =160/434</span></span>
<span id="cb192-30"><a href="#cb192-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2     36    315 0.102564   =36/351</span></span>
<span id="cb192-31"><a href="#cb192-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Totals    310    475 0.249682  =196/785</span></span>
<span id="cb192-32"><a href="#cb192-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-33"><a href="#cb192-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Metrics: Maximum metrics at their respective thresholds</span></span>
<span id="cb192-34"><a href="#cb192-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         metric threshold      value idx</span></span>
<span id="cb192-35"><a href="#cb192-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                       max f1  0.175296   0.762712 286</span></span>
<span id="cb192-36"><a href="#cb192-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                       max f2  0.133412   0.851119 306</span></span>
<span id="cb192-37"><a href="#cb192-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 max f0point5  0.497657   0.731343 183</span></span>
<span id="cb192-38"><a href="#cb192-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 max accuracy  0.281344   0.765605 248</span></span>
<span id="cb192-39"><a href="#cb192-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                max precision  0.999709   1.000000   0</span></span>
<span id="cb192-40"><a href="#cb192-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                   max recall  0.020983   1.000000 390</span></span>
<span id="cb192-41"><a href="#cb192-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7              max specificity  0.999709   1.000000   0</span></span>
<span id="cb192-42"><a href="#cb192-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             max absolute_mcc  0.280325   0.541898 249</span></span>
<span id="cb192-43"><a href="#cb192-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   max min_per_class_accuracy  0.398369   0.758065 215</span></span>
<span id="cb192-44"><a href="#cb192-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 max mean_per_class_accuracy  0.280325   0.771945 249</span></span>
<span id="cb192-45"><a href="#cb192-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11                     max tns  0.999709 434.000000   0</span></span>
<span id="cb192-46"><a href="#cb192-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12                     max fns  0.999709 347.000000   0</span></span>
<span id="cb192-47"><a href="#cb192-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13                     max fps  0.006522 434.000000 399</span></span>
<span id="cb192-48"><a href="#cb192-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14                     max tps  0.020983 351.000000 390</span></span>
<span id="cb192-49"><a href="#cb192-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15                     max tnr  0.999709   1.000000   0</span></span>
<span id="cb192-50"><a href="#cb192-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16                     max fnr  0.999709   0.988604   0</span></span>
<span id="cb192-51"><a href="#cb192-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17                     max fpr  0.006522   1.000000 399</span></span>
<span id="cb192-52"><a href="#cb192-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18                     max tpr  0.020983   1.000000 390</span></span>
<span id="cb192-53"><a href="#cb192-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-54"><a href="#cb192-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(naive_Bayes_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class2     </span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class2</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(naive_Bayes_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.181      0.819  </span></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.750      0.250  </span></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.556      0.444  </span></span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.994      0.00643</span></span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.967      0.0331 </span></span>
<span id="cb193-20"><a href="#cb193-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.630      0.370</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because klaR is the default.</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>naive_Bayes_spec <span class="ot">&lt;-</span> <span class="fu">naive_Bayes</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>naive_Bayes_fit <span class="ot">&lt;-</span> naive_Bayes_spec <span class="sc">|&gt;</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(naive_Bayes_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(naive_Bayes_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.250      0.750  </span></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.593      0.407  </span></span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.333      0.667  </span></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.993      0.00658</span></span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.978      0.0223 </span></span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.531      0.469</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<p>This engine requires the discrim extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>naive_Bayes_spec <span class="ot">&lt;-</span> <span class="fu">naive_Bayes</span>() <span class="sc">|&gt;</span> </span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"naivebayes"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>naive_Bayes_fit <span class="ot">&lt;-</span> naive_Bayes_spec <span class="sc">|&gt;</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>naive_Bayes_fit</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================= Naive Bayes ==================================</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; naive_bayes.default(x = maybe_data_frame(x), y = y, usekernel = TRUE)</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Laplace smoothing: 0</span></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; A priori probabilities: </span></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Class1    Class2 </span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.5528662 0.4471338 </span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tables: </span></span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; :: A::Class1 (KDE)</span></span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb200-32"><a href="#cb200-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  density.default(x = x, na.rm = TRUE)</span></span>
<span id="cb200-33"><a href="#cb200-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-34"><a href="#cb200-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data: x (434 obs.);  Bandwidth 'bw' = 0.2548</span></span>
<span id="cb200-35"><a href="#cb200-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-36"><a href="#cb200-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        x                 y            </span></span>
<span id="cb200-37"><a href="#cb200-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :-2.5638   Min.   :0.0002915  </span></span>
<span id="cb200-38"><a href="#cb200-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:-1.2013   1st Qu.:0.0506201  </span></span>
<span id="cb200-39"><a href="#cb200-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 0.1612   Median :0.1619843  </span></span>
<span id="cb200-40"><a href="#cb200-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 0.1612   Mean   :0.1831190  </span></span>
<span id="cb200-41"><a href="#cb200-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 1.5237   3rd Qu.:0.2581668  </span></span>
<span id="cb200-42"><a href="#cb200-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   : 2.8862   Max.   :0.5370762  </span></span>
<span id="cb200-43"><a href="#cb200-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-44"><a href="#cb200-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; :: A::Class2 (KDE)</span></span>
<span id="cb200-45"><a href="#cb200-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-46"><a href="#cb200-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-47"><a href="#cb200-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb200-48"><a href="#cb200-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  density.default(x = x, na.rm = TRUE)</span></span>
<span id="cb200-49"><a href="#cb200-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-50"><a href="#cb200-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data: x (351 obs.);  Bandwidth 'bw' = 0.2596</span></span>
<span id="cb200-51"><a href="#cb200-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-52"><a href="#cb200-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        x                 y            </span></span>
<span id="cb200-53"><a href="#cb200-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :-2.5428   Min.   :4.977e-05  </span></span>
<span id="cb200-54"><a href="#cb200-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:-1.1840   1st Qu.:2.672e-02  </span></span>
<span id="cb200-55"><a href="#cb200-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 0.1748   Median :2.239e-01  </span></span>
<span id="cb200-56"><a href="#cb200-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 0.1748   Mean   :1.836e-01  </span></span>
<span id="cb200-57"><a href="#cb200-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 1.5336   3rd Qu.:2.926e-01  </span></span>
<span id="cb200-58"><a href="#cb200-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   : 2.8924   Max.   :3.740e-01  </span></span>
<span id="cb200-59"><a href="#cb200-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-60"><a href="#cb200-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-61"><a href="#cb200-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; :: B::Class1 (KDE)</span></span>
<span id="cb200-62"><a href="#cb200-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-63"><a href="#cb200-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-64"><a href="#cb200-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb200-65"><a href="#cb200-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  density.default(x = x, na.rm = TRUE)</span></span>
<span id="cb200-66"><a href="#cb200-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-67"><a href="#cb200-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data: x (434 obs.);  Bandwidth 'bw' = 0.1793</span></span>
<span id="cb200-68"><a href="#cb200-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-69"><a href="#cb200-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        x                 y            </span></span>
<span id="cb200-70"><a href="#cb200-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :-2.4501   Min.   :5.747e-05  </span></span>
<span id="cb200-71"><a href="#cb200-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:-1.0894   1st Qu.:1.424e-02  </span></span>
<span id="cb200-72"><a href="#cb200-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 0.2713   Median :8.798e-02  </span></span>
<span id="cb200-73"><a href="#cb200-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 0.2713   Mean   :1.834e-01  </span></span>
<span id="cb200-74"><a href="#cb200-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 1.6320   3rd Qu.:2.758e-01  </span></span>
<span id="cb200-75"><a href="#cb200-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   : 2.9927   Max.   :6.872e-01  </span></span>
<span id="cb200-76"><a href="#cb200-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-77"><a href="#cb200-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-78"><a href="#cb200-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; :: B::Class2 (KDE)</span></span>
<span id="cb200-79"><a href="#cb200-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span id="cb200-80"><a href="#cb200-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-81"><a href="#cb200-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb200-82"><a href="#cb200-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  density.default(x = x, na.rm = TRUE)</span></span>
<span id="cb200-83"><a href="#cb200-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-84"><a href="#cb200-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data: x (351 obs.);  Bandwidth 'bw' = 0.2309</span></span>
<span id="cb200-85"><a href="#cb200-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-86"><a href="#cb200-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        x                 y            </span></span>
<span id="cb200-87"><a href="#cb200-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :-2.4621   Min.   :5.623e-05  </span></span>
<span id="cb200-88"><a href="#cb200-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:-0.8979   1st Qu.:1.489e-02  </span></span>
<span id="cb200-89"><a href="#cb200-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 0.6663   Median :7.738e-02  </span></span>
<span id="cb200-90"><a href="#cb200-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 0.6663   Mean   :1.595e-01  </span></span>
<span id="cb200-91"><a href="#cb200-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 2.2305   3rd Qu.:3.336e-01  </span></span>
<span id="cb200-92"><a href="#cb200-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   : 3.7948   Max.   :4.418e-01  </span></span>
<span id="cb200-93"><a href="#cb200-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-94"><a href="#cb200-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(naive_Bayes_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(naive_Bayes_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.249      0.751  </span></span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.593      0.407  </span></span>
<span id="cb201-17"><a href="#cb201-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.332      0.668  </span></span>
<span id="cb201-18"><a href="#cb201-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.993      0.00674</span></span>
<span id="cb201-19"><a href="#cb201-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.978      0.0224 </span></span>
<span id="cb201-20"><a href="#cb201-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.532      0.468</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="k-nearest-neighbors-nearest_neighbor" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors-nearest_neighbor">K-Nearest Neighbors (<code>nearest_neighbor()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href=""><code>kknn</code></a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>nearest_neighbor_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>() <span class="sc">|&gt;</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because kknn is the default.</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>nearest_neighbor_fit <span class="ot">&lt;-</span> nearest_neighbor_spec <span class="sc">|&gt;</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>nearest_neighbor_fit</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kknn::train.kknn(formula = class ~ ., data = data, ks = min_rows(5,     data, 5))</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Type of response variable: nominal</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Minimal misclassification: 0.2101911</span></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best kernel: optimal</span></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best k: 5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(nearest_neighbor_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(nearest_neighbor_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         0.2          0.8 </span></span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         0.72         0.28</span></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         0.32         0.68</span></span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4         1            0   </span></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5         1            0   </span></span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6         1            0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="null-model-null_model" class="level3">
<h3 class="anchored" data-anchor-id="null-model-null_model">Null Model (<code>null_model()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true" href=""><code>parsnip</code></a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>null_model_spec <span class="ot">&lt;-</span> <span class="fu">null_model</span>() <span class="sc">|&gt;</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because parsnip is the default.</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>null_model_fit <span class="ot">&lt;-</span> null_model_spec <span class="sc">|&gt;</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>null_model_fit</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Regression Model</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Predicted Value: Class1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(null_model_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class1     </span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(null_model_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.553        0.447</span></span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.553        0.447</span></span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.553        0.447</span></span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.553        0.447</span></span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.553        0.447</span></span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.553        0.447</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="partial-least-squares-pls" class="level3">
<h3 class="anchored" data-anchor-id="partial-least-squares-pls">Partial Least Squares (<code>pls()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true" href=""><code>mixOmics</code></a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<p>This engine requires the plsmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plsmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>pls_spec <span class="ot">&lt;-</span> <span class="fu">pls</span>() <span class="sc">|&gt;</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because mixOmics is the default.</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>pls_fit <span class="ot">&lt;-</span> pls_spec <span class="sc">|&gt;</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>pls_fit</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  mixOmics::splsda(X = x, Y = y, ncomp = ncomp, keepX = keepX) </span></span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  sPLS-DA (regression mode) with 2 sPLS-DA components. </span></span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  You entered data X of dimensions: 785 2 </span></span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  You entered data Y with 2 classes. </span></span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selection of [2] [2] variables on each of the sPLS-DA components on the X data set. </span></span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  No Y variables can be selected. </span></span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Main numerical outputs: </span></span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -------------------- </span></span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  loading vectors: see object$loadings </span></span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  variates: see object$variates </span></span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  variable names: see object$names </span></span>
<span id="cb210-22"><a href="#cb210-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-23"><a href="#cb210-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Functions to visualise samples: </span></span>
<span id="cb210-24"><a href="#cb210-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -------------------- </span></span>
<span id="cb210-25"><a href="#cb210-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  plotIndiv, plotArrow, cim </span></span>
<span id="cb210-26"><a href="#cb210-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-27"><a href="#cb210-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Functions to visualise variables: </span></span>
<span id="cb210-28"><a href="#cb210-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -------------------- </span></span>
<span id="cb210-29"><a href="#cb210-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  plotVar, plotLoadings, network, cim </span></span>
<span id="cb210-30"><a href="#cb210-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-31"><a href="#cb210-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Other functions: </span></span>
<span id="cb210-32"><a href="#cb210-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -------------------- </span></span>
<span id="cb210-33"><a href="#cb210-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  selectVar, tune, perf, auc</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(pls_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(pls_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.462        0.538</span></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.631        0.369</span></span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.512        0.488</span></span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.765        0.235</span></span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.675        0.325</span></span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.624        0.376</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="random-forests-rand_forest" class="level3">
<h3 class="anchored" data-anchor-id="random-forests-rand_forest">Random Forests (<code>rand_forest()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true" href=""><code>ranger</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false" href=""><code>aorsf</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false" href=""><code>grf</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-4" role="tab" aria-controls="tabset-21-4" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-5" role="tab" aria-controls="tabset-21-5" aria-selected="false" href=""><code>partykit</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-6" role="tab" aria-controls="tabset-21-6" aria-selected="false" href=""><code>randomForest</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-7" role="tab" aria-controls="tabset-21-7" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because ranger is the default.</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"ranger"</span>, <span class="at">keep.inbag =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># However, we'll set the engine and use the keep.inbag=TRUE option so that we </span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># can produce interval predictions. This is not generally required. </span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">841</span>)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Ranger result</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ranger::ranger(x = maybe_data_frame(x), y = y, keep.inbag = ~TRUE,      num.threads = 1, verbose = FALSE, seed = sample.int(10^5,          1), probability = TRUE) </span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Type:                             Probability estimation </span></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of trees:                  500 </span></span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sample size:                      785 </span></span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of independent variables:  2 </span></span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mtry:                             1 </span></span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target node size:                 10 </span></span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance mode:         none </span></span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Splitrule:                        gini </span></span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; OOB prediction error (Brier s.):  0.1477679</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.220       0.780 </span></span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.837       0.163 </span></span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.220       0.780 </span></span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.951       0.0485</span></span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.785       0.215 </span></span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.913       0.0868</span></span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb214-22"><a href="#cb214-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in rInfJack(x, inbag.counts): Sample size &lt;=20, no calibration</span></span>
<span id="cb214-23"><a href="#cb214-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; performed.</span></span>
<span id="cb214-24"><a href="#cb214-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in rInfJack(x, inbag.counts): Sample size &lt;=20, no calibration</span></span>
<span id="cb214-25"><a href="#cb214-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; performed.</span></span>
<span id="cb214-26"><a href="#cb214-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in sqrt(infjack): NaNs produced</span></span>
<span id="cb214-27"><a href="#cb214-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb214-28"><a href="#cb214-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower_Class1 .pred_upper_Class1 .pred_lower_Class2 .pred_upper_Class2</span></span>
<span id="cb214-29"><a href="#cb214-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span id="cb214-30"><a href="#cb214-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1            0                    0.477              0.523              1    </span></span>
<span id="cb214-31"><a href="#cb214-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2            0.604                1                  0                  0.396</span></span>
<span id="cb214-32"><a href="#cb214-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3            0.01000              0.431              0.569              0.990</span></span>
<span id="cb214-33"><a href="#cb214-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4            0.846                1                  0                  0.154</span></span>
<span id="cb214-34"><a href="#cb214-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5            0.469                1                  0                  0.531</span></span>
<span id="cb214-35"><a href="#cb214-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6          NaN                  NaN                NaN                NaN</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"aorsf"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">923</span>)</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------- Oblique random classification forest</span></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Linear combinations: Accelerated Logistic regression</span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           N observations: 785</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                N classes: 2</span></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  N trees: 500</span></span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       N predictors total: 2</span></span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    N predictors per node: 2</span></span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Average leaves per tree: 24.076</span></span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Min observations in leaf: 5</span></span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           OOB stat value: 0.87</span></span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            OOB stat type: AUC-ROC</span></span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Variable importance: anova</span></span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb217-22"><a href="#cb217-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.188       0.812 </span></span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.870       0.130 </span></span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.346       0.654 </span></span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.979       0.0206</span></span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.940       0.0599</span></span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.899       0.101</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"grf"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">546</span>)</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GRF forest object of type probability_forest </span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of trees: 2000 </span></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of training samples: 785 </span></span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance: </span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1    2 </span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.26 0.74</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.381       0.619 </span></span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.779       0.221 </span></span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.367       0.633 </span></span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.981       0.0186</span></span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.883       0.117 </span></span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.797       0.203</span></span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower_Class1 .pred_lower_Class2 .pred_upper_Class1 .pred_upper_Class2</span></span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              0.567             0.806               0.194            0.433  </span></span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2              0.869             0.311               0.689            0.131  </span></span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3              0.585             0.852               0.148            0.415  </span></span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4              1.02              0.0565              0.944           -0.0193 </span></span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5              0.994             0.228               0.772            0.00601</span></span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6              0.979             0.385               0.615            0.0207</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-21-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-4-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">493</span>)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialModel: drf</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  DRF_model_R_1770287512312_5725 </span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Summary: </span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_trees number_of_internal_trees model_size_in_bytes min_depth</span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              50                       50               92621        12</span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max_depth mean_depth min_leaves max_leaves mean_leaves</span></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        20   16.60000        126        166   143.08000</span></span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialMetrics: drf</span></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Metrics reported on Out-Of-Bag training samples **</span></span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.164699</span></span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.4058312</span></span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLoss:  1.506369</span></span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Per-Class Error:  0.200195</span></span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUC:  0.8389854</span></span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUCPR:  0.7931927</span></span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gini:  0.6779708</span></span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R^2:  0.3337559</span></span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC:  NaN</span></span>
<span id="cb224-33"><a href="#cb224-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-34"><a href="#cb224-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:</span></span>
<span id="cb224-35"><a href="#cb224-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Class1 Class2    Error      Rate</span></span>
<span id="cb224-36"><a href="#cb224-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1    327    107 0.246544  =107/434</span></span>
<span id="cb224-37"><a href="#cb224-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2     54    297 0.153846   =54/351</span></span>
<span id="cb224-38"><a href="#cb224-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Totals    381    404 0.205096  =161/785</span></span>
<span id="cb224-39"><a href="#cb224-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-40"><a href="#cb224-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Metrics: Maximum metrics at their respective thresholds</span></span>
<span id="cb224-41"><a href="#cb224-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         metric threshold      value idx</span></span>
<span id="cb224-42"><a href="#cb224-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                       max f1  0.363636   0.786755 125</span></span>
<span id="cb224-43"><a href="#cb224-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                       max f2  0.238095   0.832435 148</span></span>
<span id="cb224-44"><a href="#cb224-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 max f0point5  0.421053   0.760108 115</span></span>
<span id="cb224-45"><a href="#cb224-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 max accuracy  0.363636   0.794904 125</span></span>
<span id="cb224-46"><a href="#cb224-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                max precision  1.000000   0.890244   0</span></span>
<span id="cb224-47"><a href="#cb224-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                   max recall  0.000000   1.000000 208</span></span>
<span id="cb224-48"><a href="#cb224-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7              max specificity  1.000000   0.979263   0</span></span>
<span id="cb224-49"><a href="#cb224-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             max absolute_mcc  0.363636   0.596505 125</span></span>
<span id="cb224-50"><a href="#cb224-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   max min_per_class_accuracy  0.450000   0.785714 110</span></span>
<span id="cb224-51"><a href="#cb224-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 max mean_per_class_accuracy  0.363636   0.799805 125</span></span>
<span id="cb224-52"><a href="#cb224-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11                     max tns  1.000000 425.000000   0</span></span>
<span id="cb224-53"><a href="#cb224-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12                     max fns  1.000000 278.000000   0</span></span>
<span id="cb224-54"><a href="#cb224-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13                     max fps  0.000000 434.000000 208</span></span>
<span id="cb224-55"><a href="#cb224-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14                     max tps  0.000000 351.000000 208</span></span>
<span id="cb224-56"><a href="#cb224-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15                     max tnr  1.000000   0.979263   0</span></span>
<span id="cb224-57"><a href="#cb224-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16                     max fnr  1.000000   0.792023   0</span></span>
<span id="cb224-58"><a href="#cb224-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17                     max fpr  0.000000   1.000000 208</span></span>
<span id="cb224-59"><a href="#cb224-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18                     max tpr  0.000000   1.000000 208</span></span>
<span id="cb224-60"><a href="#cb224-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb224-61"><a href="#cb224-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.12        0.88  </span></span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.94        0.0600</span></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.175       0.825 </span></span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        1           0     </span></span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.78        0.22  </span></span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.92        0.0800</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-21-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-5-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"partykit"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">252</span>)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The print method has a lot of output:</p>
<details>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">print</span>(rand_forest_fit))[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>] <span class="sc">|&gt;</span> <span class="fu">cat</span>(<span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[1]]</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V3 &lt;= -0.06906</span></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.61707</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [4] V3 &lt;= -0.83314</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [5] V3 &lt;= -0.99048</span></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [6] V3 &lt;= -1.29863</span></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [7] V2 &lt;= -0.93951 *</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [8] V2 &gt; -0.93951 *</span></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [9] V3 &gt; -1.29863</span></span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [10] V3 &lt;= -1.21418 *</span></span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [11] V3 &gt; -1.21418</span></span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   [12] V2 &lt;= -1.13676 *</span></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   [13] V2 &gt; -1.13676</span></span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   |   [14] V3 &lt;= -1.14373 *</span></span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   |   [15] V3 &gt; -1.14373 *</span></span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [16] V3 &gt; -0.99048</span></span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [17] V2 &lt;= -1.10136 *</span></span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [18] V2 &gt; -1.10136 *</span></span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [19] V3 &gt; -0.83314</span></span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [20] V3 &lt;= -0.68684</span></span>
<span id="cb229-26"><a href="#cb229-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [21] V2 &lt;= -0.62666 *</span></span>
<span id="cb229-27"><a href="#cb229-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [22] V2 &gt; -0.62666 *</span></span>
<span id="cb229-28"><a href="#cb229-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [23] V3 &gt; -0.68684 *</span></span>
<span id="cb229-29"><a href="#cb229-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [24] V3 &gt; -0.61707</span></span>
<span id="cb229-30"><a href="#cb229-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [25] V2 &lt;= -0.10774</span></span>
<span id="cb229-31"><a href="#cb229-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [26] V3 &lt;= -0.35574</span></span>
<span id="cb229-32"><a href="#cb229-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [27] V3 &lt;= -0.41085</span></span>
<span id="cb229-33"><a href="#cb229-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [28] V3 &lt;= -0.52674 *</span></span>
<span id="cb229-34"><a href="#cb229-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [29] V3 &gt; -0.52674 *</span></span>
<span id="cb229-35"><a href="#cb229-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [30] V3 &gt; -0.41085 *</span></span>
<span id="cb229-36"><a href="#cb229-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [31] V3 &gt; -0.35574</span></span>
<span id="cb229-37"><a href="#cb229-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [32] V3 &lt;= -0.17325 *</span></span>
<span id="cb229-38"><a href="#cb229-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [33] V3 &gt; -0.17325 *</span></span>
<span id="cb229-39"><a href="#cb229-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [34] V2 &gt; -0.10774</span></span>
<span id="cb229-40"><a href="#cb229-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [35] V3 &lt;= -0.38428 *</span></span>
<span id="cb229-41"><a href="#cb229-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [36] V3 &gt; -0.38428 *</span></span>
<span id="cb229-42"><a href="#cb229-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [37] V3 &gt; -0.06906</span></span>
<span id="cb229-43"><a href="#cb229-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [38] V3 &lt;= 0.54852</span></span>
<span id="cb229-44"><a href="#cb229-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [39] V2 &lt;= 0.53027</span></span>
<span id="cb229-45"><a href="#cb229-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [40] V2 &lt;= 0.21749</span></span>
<span id="cb229-46"><a href="#cb229-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [41] V3 &lt;= 0.09376 *</span></span>
<span id="cb229-47"><a href="#cb229-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [42] V3 &gt; 0.09376</span></span>
<span id="cb229-48"><a href="#cb229-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [43] V3 &lt;= 0.28687</span></span>
<span id="cb229-49"><a href="#cb229-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   [44] V3 &lt;= 0.17513 *</span></span>
<span id="cb229-50"><a href="#cb229-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   [45] V3 &gt; 0.17513 *</span></span>
<span id="cb229-51"><a href="#cb229-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [46] V3 &gt; 0.28687 *</span></span>
<span id="cb229-52"><a href="#cb229-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [47] V2 &gt; 0.21749 *</span></span>
<span id="cb229-53"><a href="#cb229-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [48] V2 &gt; 0.53027 *</span></span>
<span id="cb229-54"><a href="#cb229-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [49] V3 &gt; 0.54852</span></span>
<span id="cb229-55"><a href="#cb229-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [50] V2 &lt;= 1.99786</span></span>
<span id="cb229-56"><a href="#cb229-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [51] V3 &lt;= 1.02092</span></span>
<span id="cb229-57"><a href="#cb229-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [52] V2 &lt;= 0.5469</span></span>
<span id="cb229-58"><a href="#cb229-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [53] V3 &lt;= 0.83487</span></span>
<span id="cb229-59"><a href="#cb229-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   [54] V2 &lt;= 0.36626 *</span></span>
<span id="cb229-60"><a href="#cb229-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   [55] V2 &gt; 0.36626 *</span></span>
<span id="cb229-61"><a href="#cb229-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [56] V3 &gt; 0.83487 *</span></span>
<span id="cb229-62"><a href="#cb229-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [57] V2 &gt; 0.5469</span></span>
<span id="cb229-63"><a href="#cb229-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [58] V3 &lt;= 0.62673 *</span></span>
<span id="cb229-64"><a href="#cb229-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [59] V3 &gt; 0.62673 *</span></span>
<span id="cb229-65"><a href="#cb229-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [60] V3 &gt; 1.02092</span></span>
<span id="cb229-66"><a href="#cb229-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [61] V3 &lt;= 1.29539</span></span>
<span id="cb229-67"><a href="#cb229-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [62] V3 &lt;= 1.2241 *</span></span>
<span id="cb229-68"><a href="#cb229-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [63] V3 &gt; 1.2241 *</span></span>
<span id="cb229-69"><a href="#cb229-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [64] V3 &gt; 1.29539</span></span>
<span id="cb229-70"><a href="#cb229-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [65] V3 &lt;= 2.01809 *</span></span>
<span id="cb229-71"><a href="#cb229-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [66] V3 &gt; 2.01809 *</span></span>
<span id="cb229-72"><a href="#cb229-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [67] V2 &gt; 1.99786 *</span></span>
<span id="cb229-73"><a href="#cb229-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-74"><a href="#cb229-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[2]]</span></span>
<span id="cb229-75"><a href="#cb229-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb229-76"><a href="#cb229-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V3 &lt;= -0.00054</span></span>
<span id="cb229-77"><a href="#cb229-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.58754</span></span>
<span id="cb229-78"><a href="#cb229-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [4] V3 &lt;= -0.83314</span></span>
<span id="cb229-79"><a href="#cb229-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [5] V2 &lt;= -1.15852</span></span>
<span id="cb229-80"><a href="#cb229-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [6] V2 &lt;= -1.76192 *</span></span>
<span id="cb229-81"><a href="#cb229-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [7] V2 &gt; -1.76192 *</span></span>
<span id="cb229-82"><a href="#cb229-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [8] V2 &gt; -1.15852</span></span>
<span id="cb229-83"><a href="#cb229-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [9] V3 &lt;= -1.21418</span></span>
<span id="cb229-84"><a href="#cb229-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [10] V3 &lt;= -1.32176 *</span></span>
<span id="cb229-85"><a href="#cb229-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [11] V3 &gt; -1.32176 *</span></span>
<span id="cb229-86"><a href="#cb229-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [12] V3 &gt; -1.21418</span></span>
<span id="cb229-87"><a href="#cb229-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [13] V2 &lt;= -1.08164 *</span></span>
<span id="cb229-88"><a href="#cb229-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [14] V2 &gt; -1.08164</span></span>
<span id="cb229-89"><a href="#cb229-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   [15] V3 &lt;= -1.14373 *</span></span>
<span id="cb229-90"><a href="#cb229-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   |   [16] V3 &gt; -1.14373 *</span></span>
<span id="cb229-91"><a href="#cb229-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [17] V3 &gt; -0.83314</span></span>
<span id="cb229-92"><a href="#cb229-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [18] V2 &lt;= -0.51524</span></span>
<span id="cb229-93"><a href="#cb229-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [19] V3 &lt;= -0.66041</span></span>
<span id="cb229-94"><a href="#cb229-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [20] V3 &lt;= -0.70885 *</span></span>
<span id="cb229-95"><a href="#cb229-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [21] V3 &gt; -0.70885 *</span></span>
<span id="cb229-96"><a href="#cb229-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [22] V3 &gt; -0.66041 *</span></span>
<span id="cb229-97"><a href="#cb229-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [23] V2 &gt; -0.51524 *</span></span>
<span id="cb229-98"><a href="#cb229-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [24] V3 &gt; -0.58754</span></span>
<span id="cb229-99"><a href="#cb229-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [25] V2 &lt;= -0.07243</span></span>
<span id="cb229-100"><a href="#cb229-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [26] V3 &lt;= -0.31247</span></span>
<span id="cb229-101"><a href="#cb229-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [27] V2 &lt;= -0.98014 *</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.375       0.625 </span></span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.813       0.187 </span></span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.284       0.716 </span></span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.963       0.0365</span></span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.892       0.108 </span></span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.922       0.0785</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-21-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-6-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"randomForest"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">726</span>)</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  randomForest(x = maybe_data_frame(x), y = y) </span></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Type of random forest: classification</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Number of trees: 500</span></span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; No. of variables tried at each split: 1</span></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         OOB estimate of  error rate: 21.53%</span></span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion matrix:</span></span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Class1 Class2 class.error</span></span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1    349     85   0.1958525</span></span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2     84    267   0.2393162</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.162        0.838</span></span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.848        0.152</span></span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.108        0.892</span></span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        1            0    </span></span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.74         0.26 </span></span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.91         0.09</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-21-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-7-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">693</span>)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> tbl_bin<span class="sc">$</span>training)</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: Class ~ .</span></span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RandomForestClassificationModel: uid=random_forest__c160ba73_c71f_46ca_9bf4_22a163b941e4, numTrees=20, numClasses=2, numFeatures=2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> tbl_bin<span class="sc">$</span>test)</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_class</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     </span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2    </span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class2    </span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1    </span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class2    </span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class2    </span></span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1    </span></span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 Class2</span></span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> tbl_bin<span class="sc">$</span>test)</span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 2]</span></span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pred_Class1 pred_Class2</span></span>
<span id="cb236-17"><a href="#cb236-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb236-18"><a href="#cb236-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      0.315       0.685 </span></span>
<span id="cb236-19"><a href="#cb236-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      0.241       0.759 </span></span>
<span id="cb236-20"><a href="#cb236-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      0.732       0.268 </span></span>
<span id="cb236-21"><a href="#cb236-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      0.235       0.765 </span></span>
<span id="cb236-22"><a href="#cb236-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      0.259       0.741 </span></span>
<span id="cb236-23"><a href="#cb236-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      0.933       0.0674</span></span>
<span id="cb236-24"><a href="#cb236-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7      0.0968      0.903</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="rule-fit-rule_fit" class="level3">
<h3 class="anchored" data-anchor-id="rule-fit-rule_fit">Rule Fit (<code>rule_fit()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true" href=""><code>xrf</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false" href=""><code>h2o</code></a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<p>This engine requires the rules extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rules)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>rule_fit_spec <span class="ot">&lt;-</span> <span class="fu">rule_fit</span>() <span class="sc">|&gt;</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because xrf is the default.</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">95</span>)</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>rule_fit_fit <span class="ot">&lt;-</span> rule_fit_spec <span class="sc">|&gt;</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>rule_fit_fit</span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An eXtreme RuleFit model of 368 rules.</span></span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Original Formula:</span></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class ~ A + B</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rule_fit_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rule_fit_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.413        0.587</span></span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.641        0.359</span></span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.530        0.470</span></span>
<span id="cb240-18"><a href="#cb240-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.890        0.110</span></span>
<span id="cb240-19"><a href="#cb240-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.804        0.196</span></span>
<span id="cb240-20"><a href="#cb240-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.607        0.393</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>rule_fit_spec <span class="ot">&lt;-</span> <span class="fu">rule_fit</span>() <span class="sc">|&gt;</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">536</span>)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>rule_fit_fit <span class="ot">&lt;-</span> rule_fit_spec <span class="sc">|&gt;</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>rule_fit_fit</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialModel: rulefit</span></span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  RuleFit_model_R_1770287512312_5776 </span></span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rulefit Model Summary: </span></span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     family  link            regularization number_of_predictors_total</span></span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 binomial logit Lasso (lambda = 0.03081 )                       2329</span></span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_active_predictors number_of_iterations rule_ensemble_size</span></span>
<span id="cb243-17"><a href="#cb243-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                           3                    4               2327</span></span>
<span id="cb243-18"><a href="#cb243-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_trees number_of_internal_trees min_depth max_depth mean_depth</span></span>
<span id="cb243-19"><a href="#cb243-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             150                      150         0         5    4.00000</span></span>
<span id="cb243-20"><a href="#cb243-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   min_leaves max_leaves mean_leaves</span></span>
<span id="cb243-21"><a href="#cb243-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          0         29    15.51333</span></span>
<span id="cb243-22"><a href="#cb243-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-23"><a href="#cb243-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-24"><a href="#cb243-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2OBinomialMetrics: rulefit</span></span>
<span id="cb243-25"><a href="#cb243-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb243-26"><a href="#cb243-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-27"><a href="#cb243-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.1411478</span></span>
<span id="cb243-28"><a href="#cb243-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.3756964</span></span>
<span id="cb243-29"><a href="#cb243-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LogLoss:  0.4472749</span></span>
<span id="cb243-30"><a href="#cb243-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Per-Class Error:  0.1850933</span></span>
<span id="cb243-31"><a href="#cb243-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUC:  0.8779327</span></span>
<span id="cb243-32"><a href="#cb243-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AUCPR:  0.8372496</span></span>
<span id="cb243-33"><a href="#cb243-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gini:  0.7558654</span></span>
<span id="cb243-34"><a href="#cb243-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-35"><a href="#cb243-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:</span></span>
<span id="cb243-36"><a href="#cb243-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Class1 Class2    Error      Rate</span></span>
<span id="cb243-37"><a href="#cb243-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class1    350     84 0.193548   =84/434</span></span>
<span id="cb243-38"><a href="#cb243-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Class2     62    289 0.176638   =62/351</span></span>
<span id="cb243-39"><a href="#cb243-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Totals    412    373 0.185987  =146/785</span></span>
<span id="cb243-40"><a href="#cb243-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-41"><a href="#cb243-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Metrics: Maximum metrics at their respective thresholds</span></span>
<span id="cb243-42"><a href="#cb243-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         metric threshold      value idx</span></span>
<span id="cb243-43"><a href="#cb243-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                       max f1  0.499611   0.798343 199</span></span>
<span id="cb243-44"><a href="#cb243-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                       max f2  0.226927   0.861169 285</span></span>
<span id="cb243-45"><a href="#cb243-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 max f0point5  0.626200   0.803634 144</span></span>
<span id="cb243-46"><a href="#cb243-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 max accuracy  0.523044   0.815287 191</span></span>
<span id="cb243-47"><a href="#cb243-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                max precision  0.980574   1.000000   0</span></span>
<span id="cb243-48"><a href="#cb243-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                   max recall  0.052101   1.000000 394</span></span>
<span id="cb243-49"><a href="#cb243-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7              max specificity  0.980574   1.000000   0</span></span>
<span id="cb243-50"><a href="#cb243-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             max absolute_mcc  0.523044   0.627478 191</span></span>
<span id="cb243-51"><a href="#cb243-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   max min_per_class_accuracy  0.512020   0.813364 196</span></span>
<span id="cb243-52"><a href="#cb243-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 max mean_per_class_accuracy  0.499611   0.814907 199</span></span>
<span id="cb243-53"><a href="#cb243-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11                     max tns  0.980574 434.000000   0</span></span>
<span id="cb243-54"><a href="#cb243-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12                     max fns  0.980574 350.000000   0</span></span>
<span id="cb243-55"><a href="#cb243-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13                     max fps  0.043433 434.000000 399</span></span>
<span id="cb243-56"><a href="#cb243-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14                     max tps  0.052101 351.000000 394</span></span>
<span id="cb243-57"><a href="#cb243-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15                     max tnr  0.980574   1.000000   0</span></span>
<span id="cb243-58"><a href="#cb243-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16                     max fnr  0.980574   0.997151   0</span></span>
<span id="cb243-59"><a href="#cb243-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17                     max fpr  0.043433   1.000000 399</span></span>
<span id="cb243-60"><a href="#cb243-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18                     max tpr  0.052101   1.000000 394</span></span>
<span id="cb243-61"><a href="#cb243-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-62"><a href="#cb243-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rule_fit_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rule_fit_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.393       0.607 </span></span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.739       0.261 </span></span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.455       0.545 </span></span>
<span id="cb244-18"><a href="#cb244-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.956       0.0442</span></span>
<span id="cb244-19"><a href="#cb244-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.882       0.118 </span></span>
<span id="cb244-20"><a href="#cb244-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.693       0.307</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="support-vector-machine-linear-kernel-svm_linear" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-linear-kernel-svm_linear">Support Vector Machine (Linear Kernel) (<code>svm_linear()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true" href=""><code>kernlab</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false" href=""><code>LiblineaR</code></a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>svm_linear_spec <span class="ot">&lt;-</span> <span class="fu">svm_linear</span>() <span class="sc">|&gt;</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>svm_linear_fit <span class="ot">&lt;-</span> svm_linear_spec <span class="sc">|&gt;</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>svm_linear_fit</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Support Vector Machine object of class "ksvm" </span></span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SV type: C-svc  (classification) </span></span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  parameter : cost C = 1 </span></span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb246-11"><a href="#cb246-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear (vanilla) kernel function. </span></span>
<span id="cb246-12"><a href="#cb246-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb246-13"><a href="#cb246-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Support Vectors : 357 </span></span>
<span id="cb246-14"><a href="#cb246-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb246-15"><a href="#cb246-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Objective Function Value : -353.0043 </span></span>
<span id="cb246-16"><a href="#cb246-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training error : 0.17707 </span></span>
<span id="cb246-17"><a href="#cb246-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Probability model included.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_linear_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb247-10"><a href="#cb247-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb247-11"><a href="#cb247-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_linear_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb247-12"><a href="#cb247-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb247-13"><a href="#cb247-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb247-14"><a href="#cb247-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb247-15"><a href="#cb247-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.404       0.596 </span></span>
<span id="cb247-16"><a href="#cb247-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.858       0.142 </span></span>
<span id="cb247-17"><a href="#cb247-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.541       0.459 </span></span>
<span id="cb247-18"><a href="#cb247-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.975       0.0254</span></span>
<span id="cb247-19"><a href="#cb247-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.905       0.0950</span></span>
<span id="cb247-20"><a href="#cb247-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.850       0.150</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>svm_linear_spec <span class="ot">&lt;-</span> <span class="fu">svm_linear</span>() <span class="sc">|&gt;</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because LiblineaR is the default.</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>svm_linear_fit <span class="ot">&lt;-</span> svm_linear_spec <span class="sc">|&gt;</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>svm_linear_fit</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $TypeDetail</span></span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "L2-regularized L2-loss support vector classification dual (L2R_L2LOSS_SVC_DUAL)"</span></span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Type</span></span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $W</span></span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              A          B      Bias</span></span>
<span id="cb249-14"><a href="#cb249-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.3641766 -0.9648797 0.1182725</span></span>
<span id="cb249-15"><a href="#cb249-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb249-16"><a href="#cb249-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Bias</span></span>
<span id="cb249-17"><a href="#cb249-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb249-18"><a href="#cb249-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb249-19"><a href="#cb249-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ClassNames</span></span>
<span id="cb249-20"><a href="#cb249-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] Class1 Class2</span></span>
<span id="cb249-21"><a href="#cb249-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Levels: Class1 Class2</span></span>
<span id="cb249-22"><a href="#cb249-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb249-23"><a href="#cb249-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $NbClass</span></span>
<span id="cb249-24"><a href="#cb249-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb249-25"><a href="#cb249-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb249-26"><a href="#cb249-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb249-27"><a href="#cb249-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "LiblineaR"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_linear_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="support-vector-machine-polynomial-kernel-svm_poly" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-polynomial-kernel-svm_poly">Support Vector Machine (Polynomial Kernel) (<code>svm_poly()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true" href=""><code>kernlab</code></a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>svm_poly_spec <span class="ot">&lt;-</span> <span class="fu">svm_poly</span>() <span class="sc">|&gt;</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because kernlab is the default.</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>svm_poly_fit <span class="ot">&lt;-</span> svm_poly_spec <span class="sc">|&gt;</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Setting default kernel parameters</span></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>svm_poly_fit</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Support Vector Machine object of class "ksvm" </span></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SV type: C-svc  (classification) </span></span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  parameter : cost C = 1 </span></span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Polynomial kernel function. </span></span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Hyperparameters : degree =  1  scale =  1  offset =  1 </span></span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-15"><a href="#cb252-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Support Vectors : 357 </span></span>
<span id="cb252-16"><a href="#cb252-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-17"><a href="#cb252-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Objective Function Value : -353.0043 </span></span>
<span id="cb252-18"><a href="#cb252-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training error : 0.17707 </span></span>
<span id="cb252-19"><a href="#cb252-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Probability model included.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_poly_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class2     </span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class1     </span></span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_poly_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb253-15"><a href="#cb253-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.399       0.601 </span></span>
<span id="cb253-16"><a href="#cb253-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.861       0.139 </span></span>
<span id="cb253-17"><a href="#cb253-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.538       0.462 </span></span>
<span id="cb253-18"><a href="#cb253-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.976       0.0237</span></span>
<span id="cb253-19"><a href="#cb253-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.908       0.0917</span></span>
<span id="cb253-20"><a href="#cb253-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.853       0.147</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="support-vector-machine-radial-basis-function-kernel-svm_rbf" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-radial-basis-function-kernel-svm_rbf">Support Vector Machine (Radial Basis Function Kernel) (<code>svm_rbf()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true" href=""><code>kernlab</code></a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>svm_rbf_spec <span class="ot">&lt;-</span> <span class="fu">svm_rbf</span>() <span class="sc">|&gt;</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because kernlab is the default.</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>svm_rbf_fit <span class="ot">&lt;-</span> svm_rbf_spec <span class="sc">|&gt;</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(class <span class="sc">~</span> ., <span class="at">data =</span> bin_train)</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>svm_rbf_fit</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Support Vector Machine object of class "ksvm" </span></span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SV type: C-svc  (classification) </span></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  parameter : cost C = 1 </span></span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gaussian Radial Basis kernel function. </span></span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Hyperparameter : sigma =  1.9107071282545 </span></span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb255-14"><a href="#cb255-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Support Vectors : 335 </span></span>
<span id="cb255-15"><a href="#cb255-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb255-16"><a href="#cb255-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Objective Function Value : -296.4885 </span></span>
<span id="cb255-17"><a href="#cb255-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training error : 0.173248 </span></span>
<span id="cb255-18"><a href="#cb255-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Probability model included.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_rbf_fit, <span class="at">type =</span> <span class="st">"class"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 1</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_class</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;      </span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Class1     </span></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Class1     </span></span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Class2     </span></span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Class1     </span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Class1     </span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Class1</span></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_rbf_fit, <span class="at">type =</span> <span class="st">"prob"</span>, <span class="at">new_data =</span> bin_test)</span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_Class1 .pred_Class2</span></span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.547        0.453</span></span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.871        0.129</span></span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.260        0.740</span></span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.861        0.139</span></span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.863        0.137</span></span>
<span id="cb256-20"><a href="#cb256-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.863        0.137</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="regression-models" class="level1">
<h1>Regression Models</h1>
<section id="example-data-1" class="level2">
<h2 class="anchored" data-anchor-id="example-data-1">Example data</h2>
<p>To demonstrate regression, we’ll subset some data, make a training/test split, and standardize the predictors:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">938</span>)</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>reg_split <span class="ot">&lt;-</span></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>  modeldata<span class="sc">::</span>concrete <span class="sc">|&gt;</span> </span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">strength =</span> compressive_strength, cement, age) <span class="sc">|&gt;</span> </span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(<span class="at">prop =</span> <span class="fl">0.95</span>, <span class="at">strata =</span> strength)</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>reg_split</span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;Training/Testing/Total&gt;</span></span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;92/8/100&gt;</span></span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a>reg_rec <span class="ot">&lt;-</span> </span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">training</span>(reg_split)) <span class="sc">|&gt;</span> </span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb257-14"><a href="#cb257-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb257-15"><a href="#cb257-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-16"><a href="#cb257-16" aria-hidden="true" tabindex="-1"></a>reg_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(reg_rec, <span class="at">new_data =</span> <span class="cn">NULL</span>)</span>
<span id="cb257-17"><a href="#cb257-17" aria-hidden="true" tabindex="-1"></a>reg_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(reg_rec, <span class="at">new_data =</span> <span class="fu">testing</span>(reg_split))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We also have models that are specifically designed for integer count outcomes. The data for these are:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">207</span>)</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>count_split <span class="ot">&lt;-</span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  attrition <span class="sc">|&gt;</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">num_years =</span> TotalWorkingYears, <span class="at">age =</span> Age, <span class="at">income =</span> MonthlyIncome) <span class="sc">|&gt;</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(<span class="at">prop =</span> <span class="fl">0.994</span>)</span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>count_split</span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;Training/Testing/Total&gt;</span></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;1461/9/1470&gt;</span></span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a>count_rec <span class="ot">&lt;-</span></span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(num_years <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">training</span>(count_split)) <span class="sc">|&gt;</span></span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a>count_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(count_rec, <span class="at">new_data =</span> <span class="cn">NULL</span>)</span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a>count_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(count_rec, <span class="at">new_data =</span> <span class="fu">testing</span>(count_split))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Finally, we have some models that handle hierarchical data, where some rows are statistically correlated with other rows. For these examples, we’ll use a data set that models body weights as a function of time for several “subjects” (rats, actually). We’ll split these data in a way where all rows for a specific subject are either in the training or the test set:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">224</span>)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>reg_group_split <span class="ot">&lt;-</span> </span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>  nlme<span class="sc">::</span>BodyWeight <span class="sc">|&gt;</span> </span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get rid of some extra attributes added by the nlme package</span></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to an _unordered_ factor</span></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rat =</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(Rat))) <span class="sc">|&gt;</span> </span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_initial_split</span>(<span class="at">group =</span> Rat)</span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a>reg_group_train <span class="ot">&lt;-</span> <span class="fu">training</span>(reg_group_split)</span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>reg_group_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(reg_group_split)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>There are 12 subjects in the training set and 4 in the test set.</p>
<p>If using the <strong>Apache Spark</strong> engine, we will need to identify the data source, and then use it to create the splits. For this article, we will copy the <code>concrete</code> data set into the Spark session.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">spark_connect</span>(<span class="st">"local"</span>)</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Re-using existing Spark connection to local</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>tbl_concrete <span class="ot">&lt;-</span> <span class="fu">copy_to</span>(sc, modeldata<span class="sc">::</span>concrete)</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>tbl_reg <span class="ot">&lt;-</span> <span class="fu">sdf_random_split</span>(tbl_concrete, <span class="at">training =</span> <span class="fl">0.95</span>, <span class="at">test =</span> <span class="fl">0.05</span>, <span class="at">seed =</span> <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="models-1" class="level2">
<h2 class="anchored" data-anchor-id="models-1">Models</h2>
<section id="bagged-mars-bag_mars-1" class="level3">
<h3 class="anchored" data-anchor-id="bagged-mars-bag_mars-1">Bagged MARS (<code>bag_mars()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true" href=""><code>earth</code></a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<p>This engine requires the baguette extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>bag_mars_spec <span class="ot">&lt;-</span> <span class="fu">bag_mars</span>() <span class="sc">|&gt;</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because earth is the default.</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">147</span>)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>bag_mars_fit <span class="ot">&lt;-</span> bag_mars_spec <span class="sc">|&gt;</span> </span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>bag_mars_fit</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bagged MARS (regression with 11 members)</span></span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance scores include:</span></span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   term   value std.error  used</span></span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 age     93.1      4.61    11</span></span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 cement  69.4      4.95    11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_mars_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  22.4</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  41.9</span></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  26.7</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  56.6</span></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  36.4</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  36.2</span></span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  37.8</span></span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  37.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="bagged-neural-networks-bag_mlp-1" class="level3">
<h3 class="anchored" data-anchor-id="bagged-neural-networks-bag_mlp-1">Bagged Neural Networks (<code>bag_mlp()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true" href=""><code>nnet</code></a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<p>This engine requires the baguette extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>bag_mlp_spec <span class="ot">&lt;-</span> <span class="fu">bag_mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because nnet is the default.</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">324</span>)</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>bag_mlp_fit <span class="ot">&lt;-</span> bag_mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>bag_mlp_fit</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bagged nnet (regression with 11 members)</span></span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance scores include:</span></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   term   value std.error  used</span></span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 age     55.9      2.96    11</span></span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 cement  44.1      2.96    11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_mlp_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  19.9</span></span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  39.1</span></span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.3</span></span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  68.8</span></span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  44.1</span></span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  36.3</span></span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  40.8</span></span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  37.0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="bagged-decision-trees-bag_tree-1" class="level3">
<h3 class="anchored" data-anchor-id="bagged-decision-trees-bag_tree-1">Bagged Decision Trees (<code>bag_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true" href=""><code>rpart</code></a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<p>This engine requires the baguette extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>bag_tree_spec <span class="ot">&lt;-</span> <span class="fu">bag_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because rpart is the default.</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">230</span>)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>bag_tree_fit <span class="ot">&lt;-</span> bag_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>bag_tree_fit</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bagged CART (regression with 11 members)</span></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance scores include:</span></span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   term    value std.error  used</span></span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb271-15"><a href="#cb271-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 cement 16621.     1392.    11</span></span>
<span id="cb271-16"><a href="#cb271-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 age    12264.      710.    11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_tree_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  23.0</span></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  33.0</span></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  29.6</span></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  54.2</span></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  36.2</span></span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  39.4</span></span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  40.7</span></span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  46.5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="bayesian-additive-regression-trees-bart-1" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-additive-regression-trees-bart-1">Bayesian Additive Regression Trees (<code>bart()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true" href=""><code>dbarts</code></a></li></ul>
<div class="tab-content">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>bart_spec <span class="ot">&lt;-</span> <span class="fu">bart</span>() <span class="sc">|&gt;</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because dbarts is the default.</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">134</span>)</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>bart_fit <span class="ot">&lt;-</span> bart_spec <span class="sc">|&gt;</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>bart_fit</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `NULL`()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bart_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  24.2</span></span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  40.9</span></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  26.0</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  52.0</span></span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  36.5</span></span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  36.7</span></span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  39.0</span></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  37.8</span></span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bart_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> reg_test)</span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower .pred_upper</span></span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        17.0        32.4</span></span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        33.0        48.9</span></span>
<span id="cb275-19"><a href="#cb275-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        20.1        31.5</span></span>
<span id="cb275-20"><a href="#cb275-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        42.0        62.5</span></span>
<span id="cb275-21"><a href="#cb275-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        28.5        44.5</span></span>
<span id="cb275-22"><a href="#cb275-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        30.3        42.3</span></span>
<span id="cb275-23"><a href="#cb275-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        33.1        45.3</span></span>
<span id="cb275-24"><a href="#cb275-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        26.3        48.8</span></span>
<span id="cb275-25"><a href="#cb275-25" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bart_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> reg_test)</span>
<span id="cb275-26"><a href="#cb275-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span id="cb275-27"><a href="#cb275-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower .pred_upper</span></span>
<span id="cb275-28"><a href="#cb275-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb275-29"><a href="#cb275-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        5.00        41.8</span></span>
<span id="cb275-30"><a href="#cb275-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       19.9         60.5</span></span>
<span id="cb275-31"><a href="#cb275-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        7.37        44.3</span></span>
<span id="cb275-32"><a href="#cb275-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       32.4         72.1</span></span>
<span id="cb275-33"><a href="#cb275-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       15.7         56.4</span></span>
<span id="cb275-34"><a href="#cb275-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       18.9         56.8</span></span>
<span id="cb275-35"><a href="#cb275-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       21.2         57.2</span></span>
<span id="cb275-36"><a href="#cb275-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8       17.2         58.5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="boosted-decision-trees-boost_tree-1" class="level3">
<h3 class="anchored" data-anchor-id="boosted-decision-trees-boost_tree-1">Boosted Decision Trees (<code>boost_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true" href=""><code>xgboost</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false" href=""><code>catboost</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-4" role="tab" aria-controls="tabset-30-4" aria-selected="false" href=""><code>h2o_gbm</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-5" role="tab" aria-controls="tabset-30-5" aria-selected="false" href=""><code>lightgbm</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-6" role="tab" aria-controls="tabset-30-6" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because xgboost is the default.</span></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">748</span>)</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ##### xgb.Booster</span></span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; call:</span></span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span></span>
<span id="cb277-11"><a href="#cb277-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span></span>
<span id="cb277-12"><a href="#cb277-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     subsample = 1, nthread = 1, objective = "reg:squarederror"), </span></span>
<span id="cb277-13"><a href="#cb277-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = x$data, nrounds = 15, evals = x$watchlist, verbose = 0)</span></span>
<span id="cb277-14"><a href="#cb277-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # of features: 2 </span></span>
<span id="cb277-15"><a href="#cb277-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # of rounds:  15 </span></span>
<span id="cb277-16"><a href="#cb277-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; callbacks:</span></span>
<span id="cb277-17"><a href="#cb277-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    evaluation_log </span></span>
<span id="cb277-18"><a href="#cb277-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; evaluation_log:</span></span>
<span id="cb277-19"><a href="#cb277-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   iter training_rmse</span></span>
<span id="cb277-20"><a href="#cb277-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  &lt;num&gt;         &lt;num&gt;</span></span>
<span id="cb277-21"><a href="#cb277-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1     13.566385</span></span>
<span id="cb277-22"><a href="#cb277-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      2     10.756125</span></span>
<span id="cb277-23"><a href="#cb277-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    ---           ---</span></span>
<span id="cb277-24"><a href="#cb277-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     14      2.269873</span></span>
<span id="cb277-25"><a href="#cb277-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     15      2.118914</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  26.9</span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  32.8</span></span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  27.9</span></span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  55.3</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  35.5</span></span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  37.4</span></span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  41.1</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  33.5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"catboost"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">557</span>)</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CatBoost model (1000 trees)</span></span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loss function: RMSE</span></span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fit to 2 feature(s)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  26.6</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  33.9</span></span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  27.8</span></span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  60.6</span></span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  34.7</span></span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  36.3</span></span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  43.6</span></span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  29.3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-30-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o_gbm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">720</span>)</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb285-10"><a href="#cb285-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb285-11"><a href="#cb285-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionModel: gbm</span></span>
<span id="cb285-12"><a href="#cb285-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  GBM_model_R_1770287512312_5932 </span></span>
<span id="cb285-13"><a href="#cb285-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Summary: </span></span>
<span id="cb285-14"><a href="#cb285-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_trees number_of_internal_trees model_size_in_bytes min_depth</span></span>
<span id="cb285-15"><a href="#cb285-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              50                       50               20474         6</span></span>
<span id="cb285-16"><a href="#cb285-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max_depth mean_depth min_leaves max_leaves mean_leaves</span></span>
<span id="cb285-17"><a href="#cb285-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         6    6.00000         14         43    27.92000</span></span>
<span id="cb285-18"><a href="#cb285-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb285-19"><a href="#cb285-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb285-20"><a href="#cb285-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionMetrics: gbm</span></span>
<span id="cb285-21"><a href="#cb285-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb285-22"><a href="#cb285-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb285-23"><a href="#cb285-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.001563879</span></span>
<span id="cb285-24"><a href="#cb285-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.03954591</span></span>
<span id="cb285-25"><a href="#cb285-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MAE:  0.02903684</span></span>
<span id="cb285-26"><a href="#cb285-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSLE:  0.001771464</span></span>
<span id="cb285-27"><a href="#cb285-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Residual Deviance :  0.001563879</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  29.7</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  32.2</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  26.9</span></span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  63.2</span></span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  34.9</span></span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  39.0</span></span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  40.0</span></span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  32.9</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-30-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-4-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o_gbm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">90</span>)</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionModel: gbm</span></span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  GBM_model_R_1770287512312_5933 </span></span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Summary: </span></span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_trees number_of_internal_trees model_size_in_bytes min_depth</span></span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              50                       50               20474         6</span></span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max_depth mean_depth min_leaves max_leaves mean_leaves</span></span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         6    6.00000         14         43    27.92000</span></span>
<span id="cb289-18"><a href="#cb289-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb289-19"><a href="#cb289-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb289-20"><a href="#cb289-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionMetrics: gbm</span></span>
<span id="cb289-21"><a href="#cb289-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb289-22"><a href="#cb289-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb289-23"><a href="#cb289-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  0.001563879</span></span>
<span id="cb289-24"><a href="#cb289-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  0.03954591</span></span>
<span id="cb289-25"><a href="#cb289-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MAE:  0.02903684</span></span>
<span id="cb289-26"><a href="#cb289-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSLE:  0.001771464</span></span>
<span id="cb289-27"><a href="#cb289-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Residual Deviance :  0.001563879</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  29.7</span></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  32.2</span></span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  26.9</span></span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  63.2</span></span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  34.9</span></span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  39.0</span></span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  40.0</span></span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  32.9</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-30-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-5-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lightgbm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">570</span>)</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LightGBM Model (100 trees)</span></span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Objective: regression</span></span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitted to dataset with 2 columns</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  20.6</span></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  42.5</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  27.0</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  49.2</span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  43.7</span></span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  38.3</span></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  41.1</span></span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  36.9</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-30-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-6-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">620</span>)</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(compressive_strength <span class="sc">~</span> ., <span class="at">data =</span> tbl_reg<span class="sc">$</span>training)</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: compressive_strength ~ .</span></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GBTRegressionModel: uid=gradient_boosted_trees__5897a9f5_9ed9_4360_80cb_7c5694d8b78b, numTrees=20, numFeatures=8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">new_data =</span> tbl_reg<span class="sc">$</span>test)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     pred</span></span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 20.8 </span></span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 28.1 </span></span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 15.5 </span></span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 22.4 </span></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  9.37</span></span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 40.1 </span></span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 14.2 </span></span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 32.1 </span></span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 37.4 </span></span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 49.5 </span></span>
<span id="cb297-16"><a href="#cb297-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="cubist-rules-cubist_rules" class="level3">
<h3 class="anchored" data-anchor-id="cubist-rules-cubist_rules">Cubist Rules (<code>cubist_rules()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true" href=""><code>Cubist</code></a></li></ul>
<div class="tab-content">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<p>This engine requires the rules extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rules)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because Cubist is the default.</span></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>cubist_rules_spec <span class="ot">&lt;-</span> <span class="fu">cubist_rules</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">188</span>)</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>cubist_rules_fit <span class="ot">&lt;-</span> cubist_rules_spec <span class="sc">|&gt;</span></span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>cubist_rules_fit</span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cubist.default(x = x, y = y, committees = 1)</span></span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of samples: 92 </span></span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 2 </span></span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of committees: 1 </span></span>
<span id="cb300-16"><a href="#cb300-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of rules: 2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(cubist_rules_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  24.2</span></span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  46.3</span></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  23.6</span></span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  54.4</span></span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  32.7</span></span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  37.8</span></span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.8</span></span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  38.6</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="decision-tree-decision_tree-1" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree-decision_tree-1">Decision Tree (<code>decision_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true" href=""><code>rpart</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false" href=""><code>partykit</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-3" role="tab" aria-controls="tabset-32-3" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because rpart is the default.</span></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; n= 92 </span></span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; node), split, n, deviance, yval</span></span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       * denotes terminal node</span></span>
<span id="cb303-10"><a href="#cb303-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb303-11"><a href="#cb303-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1) root 92 26564.7400 33.57728  </span></span>
<span id="cb303-12"><a href="#cb303-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2) cement&lt; 0.7861846 69 12009.9000 27.81493  </span></span>
<span id="cb303-13"><a href="#cb303-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      4) age&lt; -0.5419541 23   964.6417 14.42348  </span></span>
<span id="cb303-14"><a href="#cb303-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        8) cement&lt; -0.3695209 12   292.7811 11.14083 *</span></span>
<span id="cb303-15"><a href="#cb303-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        9) cement&gt;=-0.3695209 11   401.4871 18.00455 *</span></span>
<span id="cb303-16"><a href="#cb303-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      5) age&gt;=-0.5419541 46  4858.3440 34.51065  </span></span>
<span id="cb303-17"><a href="#cb303-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       10) age&lt; 0.008934354 32  2208.3040 31.16781  </span></span>
<span id="cb303-18"><a href="#cb303-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         20) cement&lt; 0.311975 24  1450.6200 28.75583 *</span></span>
<span id="cb303-19"><a href="#cb303-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         21) cement&gt;=0.311975 8   199.1900 38.40375 *</span></span>
<span id="cb303-20"><a href="#cb303-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       11) age&gt;=0.008934354 14  1475.1130 42.15143 *</span></span>
<span id="cb303-21"><a href="#cb303-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3) cement&gt;=0.7861846 23  5390.3320 50.86435  </span></span>
<span id="cb303-22"><a href="#cb303-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      6) age&lt; -0.5419541 7   390.4204 40.08429 *</span></span>
<span id="cb303-23"><a href="#cb303-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      7) age&gt;=-0.5419541 16  3830.5510 55.58062 *</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  18.0</span></span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  42.2</span></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.8</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  55.6</span></span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  40.1</span></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  38.4</span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.4</span></span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  40.1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"partykit"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model formula:</span></span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; strength ~ cement + age</span></span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitted party:</span></span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] cement &lt;= 0.72078</span></span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] age &lt;= -0.60316</span></span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [4] cement &lt;= -0.38732: 11.141 (n = 12, err = 292.8)</span></span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] cement &gt; -0.38732: 18.005 (n = 11, err = 401.5)</span></span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [6] age &gt; -0.60316</span></span>
<span id="cb307-17"><a href="#cb307-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [7] cement &lt;= 0.24945</span></span>
<span id="cb307-18"><a href="#cb307-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [8] age &lt;= -0.2359: 28.756 (n = 24, err = 1450.6)</span></span>
<span id="cb307-19"><a href="#cb307-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [9] age &gt; -0.2359: 39.014 (n = 11, err = 634.8)</span></span>
<span id="cb307-20"><a href="#cb307-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [10] cement &gt; 0.24945: 42.564 (n = 11, err = 1041.7)</span></span>
<span id="cb307-21"><a href="#cb307-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [11] cement &gt; 0.72078: 50.864 (n = 23, err = 5390.3)</span></span>
<span id="cb307-22"><a href="#cb307-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb307-23"><a href="#cb307-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of inner nodes:    5</span></span>
<span id="cb307-24"><a href="#cb307-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of terminal nodes: 6</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  18.0</span></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  39.0</span></span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.8</span></span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  50.9</span></span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  50.9</span></span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  42.6</span></span>
<span id="cb308-11"><a href="#cb308-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  42.6</span></span>
<span id="cb308-12"><a href="#cb308-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  50.9</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-32-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-3-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(compressive_strength <span class="sc">~</span> ., <span class="at">data =</span> tbl_reg<span class="sc">$</span>training)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: compressive_strength ~ .</span></span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DecisionTreeRegressionModel: uid=decision_tree_regressor__b9233b83_d74a_41e1_97df_0e3d97b8556e, depth=5, numNodes=63, numFeatures=8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">new_data =</span> tbl_reg<span class="sc">$</span>test)</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     pred</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  26.7</span></span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  26.7</span></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  14.9</span></span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  26.7</span></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  10.5</span></span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  40.2</span></span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  15.0</span></span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  40.2</span></span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  40.2</span></span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  41.4</span></span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="generalized-additive-models-gen_additive_mod-1" class="level3">
<h3 class="anchored" data-anchor-id="generalized-additive-models-gen_additive_mod-1">Generalized Additive Models (<code>gen_additive_mod()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-33-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-1" role="tab" aria-controls="tabset-33-1" aria-selected="true" href=""><code>mgcv</code></a></li></ul>
<div class="tab-content">
<div id="tabset-33-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-33-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>gen_additive_mod_spec <span class="ot">&lt;-</span> <span class="fu">gen_additive_mod</span>() <span class="sc">|&gt;</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because mgcv is the default.</span></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>gen_additive_mod_fit <span class="ot">&lt;-</span> </span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>  gen_additive_mod_spec <span class="sc">|&gt;</span> </span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> <span class="fu">s</span>(age) <span class="sc">+</span> <span class="fu">s</span>(cement), <span class="at">data =</span> reg_train)</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>gen_additive_mod_fit</span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; strength ~ s(age) + s(cement)</span></span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4.18 3.56  total = 8.74 </span></span>
<span id="cb313-16"><a href="#cb313-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-17"><a href="#cb313-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GCV score: 108.4401</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(gen_additive_mod_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  23.1</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  41.2</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  26.7</span></span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  55.9</span></span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  35.2</span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  37.1</span></span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.5</span></span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  39.6</span></span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(gen_additive_mod_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> reg_test)</span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower .pred_upper</span></span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl[1d]&gt;   &lt;dbl[1d]&gt;</span></span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        18.9        27.4</span></span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        35.7        46.6</span></span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        22.4        31.0</span></span>
<span id="cb314-20"><a href="#cb314-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        47.0        64.7</span></span>
<span id="cb314-21"><a href="#cb314-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        30.1        40.4</span></span>
<span id="cb314-22"><a href="#cb314-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        32.9        41.2</span></span>
<span id="cb314-23"><a href="#cb314-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        34.3        42.6</span></span>
<span id="cb314-24"><a href="#cb314-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        30.3        49.0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="linear-reg-linear_reg" class="level3">
<h3 class="anchored" data-anchor-id="linear-reg-linear_reg">Linear Reg (<code>linear_reg()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-34-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-1" role="tab" aria-controls="tabset-34-1" aria-selected="true" href=""><code>lm</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-2" role="tab" aria-controls="tabset-34-2" aria-selected="false" href=""><code>brulee</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-3" role="tab" aria-controls="tabset-34-3" aria-selected="false" href=""><code>gee</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-4" role="tab" aria-controls="tabset-34-4" aria-selected="false" href=""><code>glm</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-5" role="tab" aria-controls="tabset-34-5" aria-selected="false" href=""><code>glmer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-6" role="tab" aria-controls="tabset-34-6" aria-selected="false" href=""><code>glmnet</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-7" role="tab" aria-controls="tabset-34-7" aria-selected="false" href=""><code>gls</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-8" role="tab" aria-controls="tabset-34-8" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-9" role="tab" aria-controls="tabset-34-9" aria-selected="false" href=""><code>keras</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-10" role="tab" aria-controls="tabset-34-10" aria-selected="false" href=""><code>lme</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-11" role="tab" aria-controls="tabset-34-11" aria-selected="false" href=""><code>lmer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-12" role="tab" aria-controls="tabset-34-12" aria-selected="false" href=""><code>stan</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-13" role="tab" aria-controls="tabset-34-13" aria-selected="false" href=""><code>stan_glmer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-14" role="tab" aria-controls="tabset-34-14" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-34-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-34-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because lm is the default.</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats::lm(formula = strength ~ ., data = data)</span></span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb316-11"><a href="#cb316-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       cement          age  </span></span>
<span id="cb316-12"><a href="#cb316-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      33.577        8.795        5.471</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  32.1</span></span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.3</span></span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.6</span></span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  51.4</span></span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  40.3</span></span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.3</span></span>
<span id="cb317-11"><a href="#cb317-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.3</span></span>
<span id="cb317-12"><a href="#cb317-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  48.8</span></span>
<span id="cb317-13"><a href="#cb317-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> reg_test)</span>
<span id="cb317-14"><a href="#cb317-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span id="cb317-15"><a href="#cb317-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower .pred_upper</span></span>
<span id="cb317-16"><a href="#cb317-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb317-17"><a href="#cb317-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        28.8        35.4</span></span>
<span id="cb317-18"><a href="#cb317-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        27.1        33.5</span></span>
<span id="cb317-19"><a href="#cb317-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        17.3        25.9</span></span>
<span id="cb317-20"><a href="#cb317-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        44.6        58.1</span></span>
<span id="cb317-21"><a href="#cb317-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        35.6        45.0</span></span>
<span id="cb317-22"><a href="#cb317-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        32.3        38.3</span></span>
<span id="cb317-23"><a href="#cb317-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        33.2        39.4</span></span>
<span id="cb317-24"><a href="#cb317-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        41.6        56.0</span></span>
<span id="cb317-25"><a href="#cb317-25" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> reg_test)</span>
<span id="cb317-26"><a href="#cb317-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span id="cb317-27"><a href="#cb317-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower .pred_upper</span></span>
<span id="cb317-28"><a href="#cb317-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb317-29"><a href="#cb317-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        5.72        58.5</span></span>
<span id="cb317-30"><a href="#cb317-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        3.89        56.7</span></span>
<span id="cb317-31"><a href="#cb317-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       -4.94        48.2</span></span>
<span id="cb317-32"><a href="#cb317-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       24.3         78.5</span></span>
<span id="cb317-33"><a href="#cb317-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       13.7         67.0</span></span>
<span id="cb317-34"><a href="#cb317-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        8.95        61.7</span></span>
<span id="cb317-35"><a href="#cb317-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        9.89        62.7</span></span>
<span id="cb317-36"><a href="#cb317-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8       21.6         76.0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear regression</span></span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 92 samples, 2 features, numeric outcome </span></span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weight decay: 0.001 </span></span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; batch size: 83 </span></span>
<span id="cb319-13"><a href="#cb319-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scaled validation loss after 1 epoch: 235</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  32.1</span></span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.1</span></span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.6</span></span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  51.2</span></span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  40.3</span></span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.2</span></span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.2</span></span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  48.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-3-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"gee"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>  linear_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Time <span class="sc">+</span> Diet <span class="sc">+</span> <span class="fu">id_var</span>(Rat), <span class="at">data =</span> reg_group_train)</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span></span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; running glm to get initial regression estimate</span></span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA</span></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  gee S-function, version 4.13 modified 98/01/27 (1998) </span></span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb323-14"><a href="#cb323-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Link:                      Identity </span></span>
<span id="cb323-15"><a href="#cb323-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance to Mean Relation: Gaussian </span></span>
<span id="cb323-16"><a href="#cb323-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Correlation Structure:     Independent </span></span>
<span id="cb323-17"><a href="#cb323-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-18"><a href="#cb323-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb323-19"><a href="#cb323-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gee::gee(formula = weight ~ Time + Diet, id = data$Rat, data = data, </span></span>
<span id="cb323-20"><a href="#cb323-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     family = gaussian)</span></span>
<span id="cb323-21"><a href="#cb323-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-22"><a href="#cb323-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of observations :  132 </span></span>
<span id="cb323-23"><a href="#cb323-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-24"><a href="#cb323-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum cluster size   :  11 </span></span>
<span id="cb323-25"><a href="#cb323-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-26"><a href="#cb323-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-27"><a href="#cb323-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb323-28"><a href="#cb323-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        Time       Diet2       Diet3 </span></span>
<span id="cb323-29"><a href="#cb323-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  245.410439    0.549192  185.621212  259.287879 </span></span>
<span id="cb323-30"><a href="#cb323-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-31"><a href="#cb323-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated Scale Parameter:  272.1604</span></span>
<span id="cb323-32"><a href="#cb323-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Iterations:  1</span></span>
<span id="cb323-33"><a href="#cb323-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-34"><a href="#cb323-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Working Correlation[1:4,1:4]</span></span>
<span id="cb323-35"><a href="#cb323-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb323-36"><a href="#cb323-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span id="cb323-37"><a href="#cb323-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]    0    1    0    0</span></span>
<span id="cb323-38"><a href="#cb323-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]    0    0    1    0</span></span>
<span id="cb323-39"><a href="#cb323-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,]    0    0    0    1</span></span>
<span id="cb323-40"><a href="#cb323-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-41"><a href="#cb323-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-42"><a href="#cb323-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Returned Error Value:</span></span>
<span id="cb323-43"><a href="#cb323-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  246.</span></span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  250.</span></span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  254.</span></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  257.</span></span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  261.</span></span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  265.</span></span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  269.</span></span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  270.</span></span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  273.</span></span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  277.</span></span>
<span id="cb324-15"><a href="#cb324-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-4-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  stats::glm(formula = strength ~ ., family = stats::gaussian, </span></span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = data)</span></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       cement          age  </span></span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      33.577        8.795        5.471  </span></span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 91 Total (i.e. Null);  89 Residual</span></span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       26560 </span></span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 15480     AIC: 740.6</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  32.1</span></span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.3</span></span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.6</span></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  51.4</span></span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  40.3</span></span>
<span id="cb327-10"><a href="#cb327-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.3</span></span>
<span id="cb327-11"><a href="#cb327-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.3</span></span>
<span id="cb327-12"><a href="#cb327-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  48.8</span></span>
<span id="cb327-13"><a href="#cb327-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> reg_test)</span>
<span id="cb327-14"><a href="#cb327-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span id="cb327-15"><a href="#cb327-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower .pred_upper</span></span>
<span id="cb327-16"><a href="#cb327-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb327-17"><a href="#cb327-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        28.8        35.4</span></span>
<span id="cb327-18"><a href="#cb327-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        27.1        33.5</span></span>
<span id="cb327-19"><a href="#cb327-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        17.3        25.9</span></span>
<span id="cb327-20"><a href="#cb327-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        44.6        58.1</span></span>
<span id="cb327-21"><a href="#cb327-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        35.6        45.0</span></span>
<span id="cb327-22"><a href="#cb327-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        32.3        38.3</span></span>
<span id="cb327-23"><a href="#cb327-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        33.2        39.4</span></span>
<span id="cb327-24"><a href="#cb327-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        41.6        56.0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-5-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>  linear_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Rat), <span class="at">data =</span> reg_group_train)</span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in lme4::glmer(formula = weight ~ Diet + Time + (1 | Rat), data = data,</span></span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; : calling glmer() with family=gaussian (identity link) as a shortcut to lmer()</span></span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; is deprecated; please call lmer() directly</span></span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: weight ~ Diet + Time + (1 | Rat)</span></span>
<span id="cb330-12"><a href="#cb330-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: data</span></span>
<span id="cb330-13"><a href="#cb330-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; REML criterion at convergence: 955.6549</span></span>
<span id="cb330-14"><a href="#cb330-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb330-15"><a href="#cb330-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Std.Dev.</span></span>
<span id="cb330-16"><a href="#cb330-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Rat      (Intercept) 16.331  </span></span>
<span id="cb330-17"><a href="#cb330-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Residual              8.117  </span></span>
<span id="cb330-18"><a href="#cb330-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of obs: 132, groups:  Rat, 12</span></span>
<span id="cb330-19"><a href="#cb330-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed Effects:</span></span>
<span id="cb330-20"><a href="#cb330-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        Diet2        Diet3         Time  </span></span>
<span id="cb330-21"><a href="#cb330-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    245.4104     185.6212     259.2879       0.5492</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  246.</span></span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  250.</span></span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  254.</span></span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  257.</span></span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  261.</span></span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  265.</span></span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  269.</span></span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  270.</span></span>
<span id="cb331-13"><a href="#cb331-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  273.</span></span>
<span id="cb331-14"><a href="#cb331-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  277.</span></span>
<span id="cb331-15"><a href="#cb331-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-6-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">penalty =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "gaussian") </span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Df  %Dev Lambda</span></span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0  0.00 9.5680</span></span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   1  5.38 8.7180</span></span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   1  9.85 7.9430</span></span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   1 13.56 7.2380</span></span>
<span id="cb333-14"><a href="#cb333-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   1 16.64 6.5950</span></span>
<span id="cb333-15"><a href="#cb333-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   2 19.99 6.0090</span></span>
<span id="cb333-16"><a href="#cb333-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   2 23.68 5.4750</span></span>
<span id="cb333-17"><a href="#cb333-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   2 26.75 4.9890</span></span>
<span id="cb333-18"><a href="#cb333-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   2 29.29 4.5450</span></span>
<span id="cb333-19"><a href="#cb333-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  2 31.40 4.1420</span></span>
<span id="cb333-20"><a href="#cb333-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  2 33.15 3.7740</span></span>
<span id="cb333-21"><a href="#cb333-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  2 34.61 3.4380</span></span>
<span id="cb333-22"><a href="#cb333-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13  2 35.82 3.1330</span></span>
<span id="cb333-23"><a href="#cb333-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14  2 36.82 2.8550</span></span>
<span id="cb333-24"><a href="#cb333-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15  2 37.65 2.6010</span></span>
<span id="cb333-25"><a href="#cb333-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16  2 38.34 2.3700</span></span>
<span id="cb333-26"><a href="#cb333-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17  2 38.92 2.1590</span></span>
<span id="cb333-27"><a href="#cb333-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18  2 39.39 1.9680</span></span>
<span id="cb333-28"><a href="#cb333-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19  2 39.79 1.7930</span></span>
<span id="cb333-29"><a href="#cb333-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20  2 40.12 1.6340</span></span>
<span id="cb333-30"><a href="#cb333-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21  2 40.39 1.4880</span></span>
<span id="cb333-31"><a href="#cb333-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22  2 40.62 1.3560</span></span>
<span id="cb333-32"><a href="#cb333-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23  2 40.80 1.2360</span></span>
<span id="cb333-33"><a href="#cb333-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24  2 40.96 1.1260</span></span>
<span id="cb333-34"><a href="#cb333-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25  2 41.09 1.0260</span></span>
<span id="cb333-35"><a href="#cb333-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26  2 41.20 0.9348</span></span>
<span id="cb333-36"><a href="#cb333-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27  2 41.29 0.8517</span></span>
<span id="cb333-37"><a href="#cb333-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28  2 41.36 0.7761</span></span>
<span id="cb333-38"><a href="#cb333-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29  2 41.42 0.7071</span></span>
<span id="cb333-39"><a href="#cb333-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30  2 41.47 0.6443</span></span>
<span id="cb333-40"><a href="#cb333-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 31  2 41.52 0.5871</span></span>
<span id="cb333-41"><a href="#cb333-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32  2 41.55 0.5349</span></span>
<span id="cb333-42"><a href="#cb333-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33  2 41.58 0.4874</span></span>
<span id="cb333-43"><a href="#cb333-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 34  2 41.60 0.4441</span></span>
<span id="cb333-44"><a href="#cb333-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 35  2 41.63 0.4046</span></span>
<span id="cb333-45"><a href="#cb333-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 36  2 41.64 0.3687</span></span>
<span id="cb333-46"><a href="#cb333-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37  2 41.66 0.3359</span></span>
<span id="cb333-47"><a href="#cb333-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 38  2 41.67 0.3061</span></span>
<span id="cb333-48"><a href="#cb333-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 39  2 41.68 0.2789</span></span>
<span id="cb333-49"><a href="#cb333-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40  2 41.68 0.2541</span></span>
<span id="cb333-50"><a href="#cb333-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 41  2 41.69 0.2316</span></span>
<span id="cb333-51"><a href="#cb333-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 42  2 41.70 0.2110</span></span>
<span id="cb333-52"><a href="#cb333-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 43  2 41.70 0.1922</span></span>
<span id="cb333-53"><a href="#cb333-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44  2 41.71 0.1752</span></span>
<span id="cb333-54"><a href="#cb333-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 45  2 41.71 0.1596</span></span>
<span id="cb333-55"><a href="#cb333-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 46  2 41.71 0.1454</span></span>
<span id="cb333-56"><a href="#cb333-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47  2 41.71 0.1325</span></span>
<span id="cb333-57"><a href="#cb333-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48  2 41.71 0.1207</span></span>
<span id="cb333-58"><a href="#cb333-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 49  2 41.72 0.1100</span></span>
<span id="cb333-59"><a href="#cb333-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 50  2 41.72 0.1002</span></span>
<span id="cb333-60"><a href="#cb333-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 51  2 41.72 0.0913</span></span>
<span id="cb333-61"><a href="#cb333-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 52  2 41.72 0.0832</span></span>
<span id="cb333-62"><a href="#cb333-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 53  2 41.72 0.0758</span></span>
<span id="cb333-63"><a href="#cb333-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 54  2 41.72 0.0691</span></span>
<span id="cb333-64"><a href="#cb333-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 55  2 41.72 0.0630</span></span>
<span id="cb333-65"><a href="#cb333-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 56  2 41.72 0.0574</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  32.2</span></span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.3</span></span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.7</span></span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  51.3</span></span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  40.3</span></span>
<span id="cb334-10"><a href="#cb334-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.3</span></span>
<span id="cb334-11"><a href="#cb334-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.3</span></span>
<span id="cb334-12"><a href="#cb334-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  48.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-7-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Also, nlme::gls() specifies the random effects outside of the formula so</span></span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we set that as an engine parameter</span></span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"gls"</span>, <span class="at">correlation =</span> nlme<span class="sc">::</span><span class="fu">corCompSymm</span>(<span class="at">form =</span> <span class="sc">~</span>Time<span class="sc">|</span>Rat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Time <span class="sc">+</span> Diet, <span class="at">data =</span> reg_group_train)</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Generalized least squares fit by REML</span></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Model: weight ~ Time + Diet </span></span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Data: data </span></span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Log-restricted-likelihood: -477.8274</span></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        Time       Diet2       Diet3 </span></span>
<span id="cb337-13"><a href="#cb337-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  245.410439    0.549192  185.621212  259.287879 </span></span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation Structure: Compound symmetry</span></span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Formula: ~Time | Rat </span></span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Rho </span></span>
<span id="cb337-19"><a href="#cb337-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.8019221 </span></span>
<span id="cb337-20"><a href="#cb337-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of freedom: 132 total; 128 residual</span></span>
<span id="cb337-21"><a href="#cb337-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 18.23695</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  246.</span></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  250.</span></span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  254.</span></span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  257.</span></span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  261.</span></span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  265.</span></span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  269.</span></span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  270.</span></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  273.</span></span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  277.</span></span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-8-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionModel: glm</span></span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  GLM_model_R_1770287512312_5934 </span></span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GLM Model: summary</span></span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     family     link                               regularization</span></span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 gaussian identity Elastic Net (alpha = 0.5, lambda = 0.01903 )</span></span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_predictors_total number_of_active_predictors number_of_iterations</span></span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                          2                           2                    1</span></span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      training_frame</span></span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 object_ujvnjgioue</span></span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients: glm coefficients</span></span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       names coefficients standardized_coefficients</span></span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Intercept    33.577283                 33.577283</span></span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    cement     8.708461                  8.708461</span></span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       age     5.422201                  5.422201</span></span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionMetrics: glm</span></span>
<span id="cb341-26"><a href="#cb341-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb341-27"><a href="#cb341-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb341-28"><a href="#cb341-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  168.2822</span></span>
<span id="cb341-29"><a href="#cb341-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  12.97236</span></span>
<span id="cb341-30"><a href="#cb341-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MAE:  10.62672</span></span>
<span id="cb341-31"><a href="#cb341-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSLE:  0.4645554</span></span>
<span id="cb341-32"><a href="#cb341-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Residual Deviance :  168.2822</span></span>
<span id="cb341-33"><a href="#cb341-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R^2 :  0.4171988</span></span>
<span id="cb341-34"><a href="#cb341-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance :26564.74</span></span>
<span id="cb341-35"><a href="#cb341-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null D.o.F. :91</span></span>
<span id="cb341-36"><a href="#cb341-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance :15481.96</span></span>
<span id="cb341-37"><a href="#cb341-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual D.o.F. :89</span></span>
<span id="cb341-38"><a href="#cb341-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC :740.6438</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  32.1</span></span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.3</span></span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.7</span></span>
<span id="cb342-8"><a href="#cb342-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  51.2</span></span>
<span id="cb342-9"><a href="#cb342-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  40.3</span></span>
<span id="cb342-10"><a href="#cb342-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.3</span></span>
<span id="cb342-11"><a href="#cb342-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.3</span></span>
<span id="cb342-12"><a href="#cb342-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  48.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-9-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"keras"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">596</span>)</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: "sequential_3"</span></span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Layer (type)                       Output Shape                    Param #     </span></span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb345-8"><a href="#cb345-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  dense_6 (Dense)                    (None, 1)                       3           </span></span>
<span id="cb345-9"><a href="#cb345-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  dense_7 (Dense)                    (None, 1)                       2           </span></span>
<span id="cb345-10"><a href="#cb345-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb345-11"><a href="#cb345-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total params: 5 (20.00 Byte)</span></span>
<span id="cb345-12"><a href="#cb345-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Trainable params: 5 (20.00 Byte)</span></span>
<span id="cb345-13"><a href="#cb345-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Non-trainable params: 0 (0.00 Byte)</span></span>
<span id="cb345-14"><a href="#cb345-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1/1 - 0s - 40ms/epoch - 40ms/step</span></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       .pred</span></span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt;</span></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0.157   </span></span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 -0.000522</span></span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 -0.0670  </span></span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  0.413   </span></span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  0.290   </span></span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  0.154   </span></span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  0.169   </span></span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  0.442</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-10-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.. </span></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nlme::lme() makes us set the random effects outside of the formula so we</span></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add it as an engine parameter. </span></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lme"</span>, <span class="at">random =</span> <span class="sc">~</span> Time <span class="sc">|</span> Rat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time, <span class="at">data =</span> reg_group_train)</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear mixed-effects model fit by REML</span></span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Data: data </span></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Log-restricted-likelihood: -426.5662</span></span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Fixed: weight ~ Diet + Time </span></span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       Diet2       Diet3        Time </span></span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  240.483603  199.723140  264.893298    0.549192 </span></span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb349-13"><a href="#cb349-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb349-14"><a href="#cb349-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Formula: ~Time | Rat</span></span>
<span id="cb349-15"><a href="#cb349-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Structure: General positive-definite, Log-Cholesky parametrization</span></span>
<span id="cb349-16"><a href="#cb349-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             StdDev     Corr  </span></span>
<span id="cb349-17"><a href="#cb349-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 25.2657397 (Intr)</span></span>
<span id="cb349-18"><a href="#cb349-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time         0.3411097 -0.816</span></span>
<span id="cb349-19"><a href="#cb349-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual     4.5940697       </span></span>
<span id="cb349-20"><a href="#cb349-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb349-21"><a href="#cb349-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Observations: 132</span></span>
<span id="cb349-22"><a href="#cb349-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Groups: 12</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  241.</span></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  245.</span></span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  249.</span></span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  253.</span></span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  256.</span></span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  260.</span></span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  264.</span></span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  265.</span></span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  268.</span></span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  272.</span></span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-11-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lmer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>  linear_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Rat), <span class="at">data =</span> reg_group_train)</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: weight ~ Diet + Time + (1 | Rat)</span></span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: data</span></span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; REML criterion at convergence: 955.6549</span></span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Std.Dev.</span></span>
<span id="cb353-13"><a href="#cb353-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Rat      (Intercept) 16.331  </span></span>
<span id="cb353-14"><a href="#cb353-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Residual              8.117  </span></span>
<span id="cb353-15"><a href="#cb353-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of obs: 132, groups:  Rat, 12</span></span>
<span id="cb353-16"><a href="#cb353-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed Effects:</span></span>
<span id="cb353-17"><a href="#cb353-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        Diet2        Diet3         Time  </span></span>
<span id="cb353-18"><a href="#cb353-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    245.4104     185.6212     259.2879       0.5492</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  246.</span></span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  250.</span></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  254.</span></span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  257.</span></span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  261.</span></span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  265.</span></span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  269.</span></span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  270.</span></span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  273.</span></span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  277.</span></span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-12-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stan"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">357</span>)</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time, <span class="at">data =</span> reg_group_train)</span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stan_glm</span></span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  family:       gaussian [identity]</span></span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  formula:      weight ~ Diet + Time</span></span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  observations: 132</span></span>
<span id="cb356-12"><a href="#cb356-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  predictors:   4</span></span>
<span id="cb356-13"><a href="#cb356-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb356-14"><a href="#cb356-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Median MAD_SD</span></span>
<span id="cb356-15"><a href="#cb356-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 245.3    3.3 </span></span>
<span id="cb356-16"><a href="#cb356-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diet2       185.6    3.6 </span></span>
<span id="cb356-17"><a href="#cb356-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diet3       259.3    3.4 </span></span>
<span id="cb356-18"><a href="#cb356-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time          0.6    0.1 </span></span>
<span id="cb356-19"><a href="#cb356-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb356-20"><a href="#cb356-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Auxiliary parameter(s):</span></span>
<span id="cb356-21"><a href="#cb356-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Median MAD_SD</span></span>
<span id="cb356-22"><a href="#cb356-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma 16.6    1.0  </span></span>
<span id="cb356-23"><a href="#cb356-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb356-24"><a href="#cb356-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb356-25"><a href="#cb356-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For help interpreting the printed output see ?print.stanreg</span></span>
<span id="cb356-26"><a href="#cb356-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  246.</span></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  250.</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  254.</span></span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  257.</span></span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  261.</span></span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  265.</span></span>
<span id="cb357-11"><a href="#cb357-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  269.</span></span>
<span id="cb357-12"><a href="#cb357-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  270.</span></span>
<span id="cb357-13"><a href="#cb357-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  273.</span></span>
<span id="cb357-14"><a href="#cb357-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  277.</span></span>
<span id="cb357-15"><a href="#cb357-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span>
<span id="cb357-16"><a href="#cb357-16" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb357-17"><a href="#cb357-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 2</span></span>
<span id="cb357-18"><a href="#cb357-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_lower .pred_upper</span></span>
<span id="cb357-19"><a href="#cb357-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb357-20"><a href="#cb357-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1        240.        252.</span></span>
<span id="cb357-21"><a href="#cb357-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2        244.        255.</span></span>
<span id="cb357-22"><a href="#cb357-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3        249.        258.</span></span>
<span id="cb357-23"><a href="#cb357-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4        253.        262.</span></span>
<span id="cb357-24"><a href="#cb357-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5        257.        265.</span></span>
<span id="cb357-25"><a href="#cb357-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6        261.        269.</span></span>
<span id="cb357-26"><a href="#cb357-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7        265.        273.</span></span>
<span id="cb357-27"><a href="#cb357-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8        265.        274.</span></span>
<span id="cb357-28"><a href="#cb357-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9        268.        278.</span></span>
<span id="cb357-29"><a href="#cb357-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10        271.        282.</span></span>
<span id="cb357-30"><a href="#cb357-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span>
<span id="cb357-31"><a href="#cb357-31" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb357-32"><a href="#cb357-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 2</span></span>
<span id="cb357-33"><a href="#cb357-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_lower .pred_upper</span></span>
<span id="cb357-34"><a href="#cb357-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb357-35"><a href="#cb357-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1        213.        278.</span></span>
<span id="cb357-36"><a href="#cb357-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2        216.        282.</span></span>
<span id="cb357-37"><a href="#cb357-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3        220.        287.</span></span>
<span id="cb357-38"><a href="#cb357-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4        224.        290.</span></span>
<span id="cb357-39"><a href="#cb357-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5        228.        292.</span></span>
<span id="cb357-40"><a href="#cb357-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6        230.        297.</span></span>
<span id="cb357-41"><a href="#cb357-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7        236.        301.</span></span>
<span id="cb357-42"><a href="#cb357-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8        236.        302.</span></span>
<span id="cb357-43"><a href="#cb357-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9        240.        305.</span></span>
<span id="cb357-44"><a href="#cb357-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10        244.        310.</span></span>
<span id="cb357-45"><a href="#cb357-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-13-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stan_glmer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">895</span>)</span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a>  linear_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Rat), <span class="at">data =</span> reg_group_train)</span>
<span id="cb360-6"><a href="#cb360-6" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb360-7"><a href="#cb360-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb360-8"><a href="#cb360-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb360-9"><a href="#cb360-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stan_glmer</span></span>
<span id="cb360-10"><a href="#cb360-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  family:       gaussian [identity]</span></span>
<span id="cb360-11"><a href="#cb360-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  formula:      weight ~ Diet + Time + (1 | Rat)</span></span>
<span id="cb360-12"><a href="#cb360-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  observations: 132</span></span>
<span id="cb360-13"><a href="#cb360-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb360-14"><a href="#cb360-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Median MAD_SD</span></span>
<span id="cb360-15"><a href="#cb360-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 245.6    6.8 </span></span>
<span id="cb360-16"><a href="#cb360-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diet2       185.7   11.5 </span></span>
<span id="cb360-17"><a href="#cb360-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diet3       259.2   11.5 </span></span>
<span id="cb360-18"><a href="#cb360-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time          0.5    0.0 </span></span>
<span id="cb360-19"><a href="#cb360-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb360-20"><a href="#cb360-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Auxiliary parameter(s):</span></span>
<span id="cb360-21"><a href="#cb360-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Median MAD_SD</span></span>
<span id="cb360-22"><a href="#cb360-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma 8.2    0.5   </span></span>
<span id="cb360-23"><a href="#cb360-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb360-24"><a href="#cb360-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error terms:</span></span>
<span id="cb360-25"><a href="#cb360-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Std.Dev.</span></span>
<span id="cb360-26"><a href="#cb360-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Rat      (Intercept) 17.2    </span></span>
<span id="cb360-27"><a href="#cb360-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Residual              8.2    </span></span>
<span id="cb360-28"><a href="#cb360-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Num. levels: Rat 12 </span></span>
<span id="cb360-29"><a href="#cb360-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb360-30"><a href="#cb360-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb360-31"><a href="#cb360-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For help interpreting the printed output see ?print.stanreg</span></span>
<span id="cb360-32"><a href="#cb360-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  246.</span></span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  250.</span></span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  254.</span></span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  258.</span></span>
<span id="cb361-9"><a href="#cb361-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  262.</span></span>
<span id="cb361-10"><a href="#cb361-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  266.</span></span>
<span id="cb361-11"><a href="#cb361-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  269.</span></span>
<span id="cb361-12"><a href="#cb361-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  270.</span></span>
<span id="cb361-13"><a href="#cb361-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  273.</span></span>
<span id="cb361-14"><a href="#cb361-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  277.</span></span>
<span id="cb361-15"><a href="#cb361-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span>
<span id="cb361-16"><a href="#cb361-16" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb361-17"><a href="#cb361-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 2</span></span>
<span id="cb361-18"><a href="#cb361-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_lower .pred_upper</span></span>
<span id="cb361-19"><a href="#cb361-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb361-20"><a href="#cb361-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1        205.        285.</span></span>
<span id="cb361-21"><a href="#cb361-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2        211.        289.</span></span>
<span id="cb361-22"><a href="#cb361-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3        214.        292.</span></span>
<span id="cb361-23"><a href="#cb361-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4        218.        295.</span></span>
<span id="cb361-24"><a href="#cb361-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5        221.        300.</span></span>
<span id="cb361-25"><a href="#cb361-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6        225.        303.</span></span>
<span id="cb361-26"><a href="#cb361-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7        230.        307.</span></span>
<span id="cb361-27"><a href="#cb361-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8        230.        309.</span></span>
<span id="cb361-28"><a href="#cb361-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9        233.        312.</span></span>
<span id="cb361-29"><a href="#cb361-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10        237.        314.</span></span>
<span id="cb361-30"><a href="#cb361-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-34-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-14-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(compressive_strength <span class="sc">~</span> ., <span class="at">data =</span> tbl_reg<span class="sc">$</span>training)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: compressive_strength ~ .</span></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (Intercept)             cement blast_furnace_slag            fly_ash </span></span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       -21.80239627         0.12003251         0.10399582         0.08747677 </span></span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              water   superplasticizer   coarse_aggregate     fine_aggregate </span></span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        -0.15701342         0.28531613         0.01777782         0.02018358 </span></span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                age </span></span>
<span id="cb363-14"><a href="#cb363-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         0.11678247</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">new_data =</span> tbl_reg<span class="sc">$</span>test)</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     pred</span></span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  16.5</span></span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  19.7</span></span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  26.1</span></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  23.6</span></span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  24.2</span></span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  29.1</span></span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  21.3</span></span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  24.2</span></span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  33.9</span></span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  57.7</span></span>
<span id="cb364-16"><a href="#cb364-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="multivariate-adaptive-regression-splines-mars-1" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-adaptive-regression-splines-mars-1">Multivariate Adaptive Regression Splines (<code>mars()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-35-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-1" role="tab" aria-controls="tabset-35-1" aria-selected="true" href=""><code>earth</code></a></li></ul>
<div class="tab-content">
<div id="tabset-35-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-35-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>mars_spec <span class="ot">&lt;-</span> <span class="fu">mars</span>() <span class="sc">|&gt;</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because earth is the default.</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>mars_fit <span class="ot">&lt;-</span> mars_spec <span class="sc">|&gt;</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>mars_fit</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Selected 4 of 9 terms, and 2 of 2 predictors</span></span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Termination condition: RSq changed by less than 0.001 at 9 terms</span></span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Importance: age, cement</span></span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of terms at each degree of interaction: 1 3 (additive model)</span></span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GCV 113.532    RSS 8915.965    GRSq 0.6153128    RSq 0.6643684</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mars_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  22.0</span></span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  43.1</span></span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.1</span></span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  58.0</span></span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  33.8</span></span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  34.9</span></span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.3</span></span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  43.5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="neural-networks-mlp-1" class="level3">
<h3 class="anchored" data-anchor-id="neural-networks-mlp-1">Neural Networks (<code>mlp()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-36-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-1" role="tab" aria-controls="tabset-36-1" aria-selected="true" href=""><code>nnet</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-2" role="tab" aria-controls="tabset-36-2" aria-selected="false" href=""><code>brulee</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-3" role="tab" aria-controls="tabset-36-3" aria-selected="false" href=""><code>brulee_two_layer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-4" role="tab" aria-controls="tabset-36-4" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-5" role="tab" aria-controls="tabset-36-5" aria-selected="false" href=""><code>keras</code></a></li></ul>
<div class="tab-content">
<div id="tabset-36-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-36-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because nnet is the default.</span></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">159</span>)</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; a 2-5-1 network with 21 weights</span></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; inputs: cement age </span></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; output(s): strength </span></span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; options were - linear output units</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  14.8</span></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  38.5</span></span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  32.0</span></span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  63.6</span></span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  43.5</span></span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  42.7</span></span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  42.3</span></span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  33.1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-36-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">407</span>)</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multilayer perceptron</span></span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; relu activation,</span></span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 hidden units,</span></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13 model parameters</span></span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 92 samples, 2 features, numeric outcome </span></span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weight decay: 0.001 </span></span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dropout proportion: 0 </span></span>
<span id="cb372-16"><a href="#cb372-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; batch size: 83 </span></span>
<span id="cb372-17"><a href="#cb372-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; learn rate: 0.01 </span></span>
<span id="cb372-18"><a href="#cb372-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scaled validation loss after 9 epochs: 0.189</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  23.1</span></span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  39.4</span></span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  26.9</span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  56.4</span></span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  32.9</span></span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  37.2</span></span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.4</span></span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  40.1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-36-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-3-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"brulee_two_layer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">585</span>)</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multilayer perceptron</span></span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; c(relu,relu) activation,</span></span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; c(3,3) hidden units,</span></span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25 model parameters</span></span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 92 samples, 2 features, numeric outcome </span></span>
<span id="cb375-14"><a href="#cb375-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weight decay: 0.001 </span></span>
<span id="cb375-15"><a href="#cb375-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dropout proportion: 0 </span></span>
<span id="cb375-16"><a href="#cb375-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; batch size: 83 </span></span>
<span id="cb375-17"><a href="#cb375-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; learn rate: 0.01 </span></span>
<span id="cb375-18"><a href="#cb375-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scaled validation loss after 3 epochs: 0.379</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  23.5</span></span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  32.6</span></span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  24.6</span></span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  50.5</span></span>
<span id="cb376-9"><a href="#cb376-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  46.7</span></span>
<span id="cb376-10"><a href="#cb376-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  33.8</span></span>
<span id="cb376-11"><a href="#cb376-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  37.0</span></span>
<span id="cb376-12"><a href="#cb376-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  50.5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-36-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-4-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">93</span>)</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a>mlp_fit</span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb379-9"><a href="#cb379-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb379-10"><a href="#cb379-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb379-11"><a href="#cb379-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionModel: deeplearning</span></span>
<span id="cb379-12"><a href="#cb379-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  DeepLearning_model_R_1770287512312_5935 </span></span>
<span id="cb379-13"><a href="#cb379-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Status of Neuron Layers: predicting .outcome, regression, gaussian distribution, Quadratic loss, 801 weights/biases, 14.5 KB, 920 training samples, mini-batch size 1</span></span>
<span id="cb379-14"><a href="#cb379-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></span>
<span id="cb379-15"><a href="#cb379-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1     2     Input  0.00 %       NA       NA        NA       NA       NA</span></span>
<span id="cb379-16"><a href="#cb379-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2   200 Rectifier  0.00 % 0.000000 0.000000  0.009004 0.020737 0.000000</span></span>
<span id="cb379-17"><a href="#cb379-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     3     1    Linear      NA 0.000000 0.000000  0.000818 0.000240 0.000000</span></span>
<span id="cb379-18"><a href="#cb379-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></span>
<span id="cb379-19"><a href="#cb379-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          NA         NA        NA       NA</span></span>
<span id="cb379-20"><a href="#cb379-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   -0.014857   0.124650  0.494931 0.011050</span></span>
<span id="cb379-21"><a href="#cb379-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   -0.000526   0.099345  0.006964 0.000000</span></span>
<span id="cb379-22"><a href="#cb379-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb379-23"><a href="#cb379-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb379-24"><a href="#cb379-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionMetrics: deeplearning</span></span>
<span id="cb379-25"><a href="#cb379-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb379-26"><a href="#cb379-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Metrics reported on full training frame **</span></span>
<span id="cb379-27"><a href="#cb379-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb379-28"><a href="#cb379-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  136.9811</span></span>
<span id="cb379-29"><a href="#cb379-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  11.70389</span></span>
<span id="cb379-30"><a href="#cb379-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MAE:  9.370161</span></span>
<span id="cb379-31"><a href="#cb379-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSLE:  0.4189636</span></span>
<span id="cb379-32"><a href="#cb379-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Residual Deviance :  136.9811</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  30.2</span></span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  32.5</span></span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.2</span></span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  51.8</span></span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  38.6</span></span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.3</span></span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.3</span></span>
<span id="cb380-12"><a href="#cb380-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  46.8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-36-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-5-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>mlp_spec <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"keras"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">879</span>)</span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>mlp_fit <span class="ot">&lt;-</span> mlp_spec <span class="sc">|&gt;</span></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: compressive_strength ~ .</span></span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (Intercept)             cement blast_furnace_slag            fly_ash </span></span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       -21.80239627         0.12003251         0.10399582         0.08747677 </span></span>
<span id="cb383-9"><a href="#cb383-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              water   superplasticizer   coarse_aggregate     fine_aggregate </span></span>
<span id="cb383-10"><a href="#cb383-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        -0.15701342         0.28531613         0.01777782         0.02018358 </span></span>
<span id="cb383-11"><a href="#cb383-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                age </span></span>
<span id="cb383-12"><a href="#cb383-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         0.11678247</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mlp_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1/1 - 0s - 39ms/epoch - 39ms/step</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 -0.386</span></span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 -0.337</span></span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 -0.299</span></span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 -0.278</span></span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 -0.384</span></span>
<span id="cb384-11"><a href="#cb384-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 -0.373</span></span>
<span id="cb384-12"><a href="#cb384-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 -0.373</span></span>
<span id="cb384-13"><a href="#cb384-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 -0.341</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="k-nearest-neighbors-nearest_neighbor-1" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors-nearest_neighbor-1">K-Nearest Neighbors (<code>nearest_neighbor()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-37-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-1" role="tab" aria-controls="tabset-37-1" aria-selected="true" href=""><code>kknn</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-2" role="tab" aria-controls="tabset-37-2" aria-selected="false" href=""><code>parsnip</code></a></li></ul>
<div class="tab-content">
<div id="tabset-37-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-37-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>nearest_neighbor_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>() <span class="sc">|&gt;</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because kknn is the default.</span></span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>nearest_neighbor_fit <span class="ot">&lt;-</span> nearest_neighbor_spec <span class="sc">|&gt;</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>nearest_neighbor_fit</span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kknn::train.kknn(formula = strength ~ ., data = data, ks = min_rows(5,     data, 5))</span></span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Type of response variable: continuous</span></span>
<span id="cb386-11"><a href="#cb386-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; minimal mean absolute error: 8.257735</span></span>
<span id="cb386-12"><a href="#cb386-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Minimal mean squared error: 115.8737</span></span>
<span id="cb386-13"><a href="#cb386-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best kernel: optimal</span></span>
<span id="cb386-14"><a href="#cb386-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Best k: 5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(nearest_neighbor_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  16.3</span></span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  35.7</span></span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  27.5</span></span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  56.7</span></span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  42.6</span></span>
<span id="cb387-10"><a href="#cb387-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  41.7</span></span>
<span id="cb387-11"><a href="#cb387-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  41.2</span></span>
<span id="cb387-12"><a href="#cb387-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  50.2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="null-model-null_model-1" class="level3">
<h3 class="anchored" data-anchor-id="null-model-null_model-1">Null Model (<code>null_model()</code>)</h3>
</section>
</div>
<div id="tabset-37-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>null_model_spec <span class="ot">&lt;-</span> <span class="fu">null_model</span>() <span class="sc">|&gt;</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because parsnip is the default.</span></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>null_model_fit <span class="ot">&lt;-</span> null_model_spec <span class="sc">|&gt;</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>null_model_fit</span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Classification Model</span></span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Predicted Value: 33.57728</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(null_model_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  33.6</span></span>
<span id="cb390-6"><a href="#cb390-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  33.6</span></span>
<span id="cb390-7"><a href="#cb390-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  33.6</span></span>
<span id="cb390-8"><a href="#cb390-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  33.6</span></span>
<span id="cb390-9"><a href="#cb390-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  33.6</span></span>
<span id="cb390-10"><a href="#cb390-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  33.6</span></span>
<span id="cb390-11"><a href="#cb390-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  33.6</span></span>
<span id="cb390-12"><a href="#cb390-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  33.6</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="partial-least-squares-pls-1" class="level3">
<h3 class="anchored" data-anchor-id="partial-least-squares-pls-1">Partial Least Squares (<code>pls()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-38-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-1" role="tab" aria-controls="tabset-38-1" aria-selected="true" href=""><code>mixOmics</code></a></li></ul>
<div class="tab-content">
<div id="tabset-38-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-38-1-tab">
<p>This engine requires the plsmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plsmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>pls_spec <span class="ot">&lt;-</span> <span class="fu">pls</span>() <span class="sc">|&gt;</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because mixOmics is the default.</span></span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>pls_fit <span class="ot">&lt;-</span> pls_spec <span class="sc">|&gt;</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>pls_fit</span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb393-8"><a href="#cb393-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  mixOmics::spls(X = x, Y = y, ncomp = ncomp, keepX = keepX) </span></span>
<span id="cb393-9"><a href="#cb393-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-10"><a href="#cb393-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  sPLS with a 'regression' mode with 2 sPLS components. </span></span>
<span id="cb393-11"><a href="#cb393-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  You entered data X of dimensions: 92 2 </span></span>
<span id="cb393-12"><a href="#cb393-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  You entered data Y of dimensions: 92 1 </span></span>
<span id="cb393-13"><a href="#cb393-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-14"><a href="#cb393-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selection of [2] [2] variables on each of the sPLS components on the X data set. </span></span>
<span id="cb393-15"><a href="#cb393-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selection of [1] [1] variables on each of the sPLS components on the Y data set. </span></span>
<span id="cb393-16"><a href="#cb393-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-17"><a href="#cb393-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Main numerical outputs: </span></span>
<span id="cb393-18"><a href="#cb393-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -------------------- </span></span>
<span id="cb393-19"><a href="#cb393-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  loading vectors: see object$loadings </span></span>
<span id="cb393-20"><a href="#cb393-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  variates: see object$variates </span></span>
<span id="cb393-21"><a href="#cb393-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  variable names: see object$names </span></span>
<span id="cb393-22"><a href="#cb393-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-23"><a href="#cb393-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Functions to visualise samples: </span></span>
<span id="cb393-24"><a href="#cb393-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -------------------- </span></span>
<span id="cb393-25"><a href="#cb393-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  plotIndiv, plotArrow </span></span>
<span id="cb393-26"><a href="#cb393-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb393-27"><a href="#cb393-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Functions to visualise variables: </span></span>
<span id="cb393-28"><a href="#cb393-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -------------------- </span></span>
<span id="cb393-29"><a href="#cb393-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  plotVar, plotLoadings, network, cim</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(pls_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  32.1</span></span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.3</span></span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.6</span></span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  51.4</span></span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  40.3</span></span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.3</span></span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.3</span></span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  48.8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="poisson-reg-poisson_reg" class="level3">
<h3 class="anchored" data-anchor-id="poisson-reg-poisson_reg">Poisson Reg (<code>poisson_reg()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-39-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-1" role="tab" aria-controls="tabset-39-1" aria-selected="true" href=""><code>glm</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-2" role="tab" aria-controls="tabset-39-2" aria-selected="false" href=""><code>gee</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-3" role="tab" aria-controls="tabset-39-3" aria-selected="false" href=""><code>glmer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-4" role="tab" aria-controls="tabset-39-4" aria-selected="false" href=""><code>glmnet</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-5" role="tab" aria-controls="tabset-39-5" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-6" role="tab" aria-controls="tabset-39-6" aria-selected="false" href=""><code>hurdle</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-7" role="tab" aria-controls="tabset-39-7" aria-selected="false" href=""><code>stan</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-8" role="tab" aria-controls="tabset-39-8" aria-selected="false" href=""><code>stan_glmer</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-9" role="tab" aria-controls="tabset-39-9" aria-selected="false" href=""><code>zeroinfl</code></a></li></ul>
<div class="tab-content">
<div id="tabset-39-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-39-1-tab">
<p>This engine requires the poissonreg extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poissonreg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because glm is the default.</span></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> poisson_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(num_years <span class="sc">~</span> ., <span class="at">data =</span> count_train)</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  stats::glm(formula = num_years ~ ., family = stats::poisson, </span></span>
<span id="cb397-8"><a href="#cb397-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = data)</span></span>
<span id="cb397-9"><a href="#cb397-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb397-10"><a href="#cb397-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb397-11"><a href="#cb397-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          age       income  </span></span>
<span id="cb397-12"><a href="#cb397-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      2.2861       0.2804       0.2822  </span></span>
<span id="cb397-13"><a href="#cb397-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb397-14"><a href="#cb397-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 1460 Total (i.e. Null);  1458 Residual</span></span>
<span id="cb397-15"><a href="#cb397-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       7434 </span></span>
<span id="cb397-16"><a href="#cb397-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 2597  AIC: 8446</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">new_data =</span> count_test)</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 × 1</span></span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 31.6 </span></span>
<span id="cb398-6"><a href="#cb398-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  6.66</span></span>
<span id="cb398-7"><a href="#cb398-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 11.8 </span></span>
<span id="cb398-8"><a href="#cb398-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 24.8 </span></span>
<span id="cb398-9"><a href="#cb398-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 26.6 </span></span>
<span id="cb398-10"><a href="#cb398-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  8.23</span></span>
<span id="cb398-11"><a href="#cb398-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 32.1 </span></span>
<span id="cb398-12"><a href="#cb398-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  4.86</span></span>
<span id="cb398-13"><a href="#cb398-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9 28.3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-39-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-2-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"gee"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>  poisson_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time <span class="sc">+</span> <span class="fu">id_var</span>(Rat), <span class="at">data =</span> reg_group_train)</span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</span></span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; running glm to get initial regression estimate</span></span>
<span id="cb401-6"><a href="#cb401-6" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb401-7"><a href="#cb401-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb401-8"><a href="#cb401-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-9"><a href="#cb401-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-10"><a href="#cb401-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA</span></span>
<span id="cb401-11"><a href="#cb401-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  gee S-function, version 4.13 modified 98/01/27 (1998) </span></span>
<span id="cb401-12"><a href="#cb401-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-13"><a href="#cb401-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb401-14"><a href="#cb401-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Link:                      Logarithm </span></span>
<span id="cb401-15"><a href="#cb401-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance to Mean Relation: Poisson </span></span>
<span id="cb401-16"><a href="#cb401-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Correlation Structure:     Independent </span></span>
<span id="cb401-17"><a href="#cb401-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-18"><a href="#cb401-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb401-19"><a href="#cb401-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gee::gee(formula = weight ~ Diet + Time, id = data$Rat, data = data, </span></span>
<span id="cb401-20"><a href="#cb401-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     family = stats::poisson)</span></span>
<span id="cb401-21"><a href="#cb401-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-22"><a href="#cb401-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of observations :  132 </span></span>
<span id="cb401-23"><a href="#cb401-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-24"><a href="#cb401-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum cluster size   :  11 </span></span>
<span id="cb401-25"><a href="#cb401-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-26"><a href="#cb401-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-27"><a href="#cb401-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb401-28"><a href="#cb401-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       Diet2       Diet3        Time </span></span>
<span id="cb401-29"><a href="#cb401-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5.525683187 0.532717136 0.684495610 0.001467487 </span></span>
<span id="cb401-30"><a href="#cb401-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-31"><a href="#cb401-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated Scale Parameter:  0.6879328</span></span>
<span id="cb401-32"><a href="#cb401-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Iterations:  1</span></span>
<span id="cb401-33"><a href="#cb401-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-34"><a href="#cb401-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Working Correlation[1:4,1:4]</span></span>
<span id="cb401-35"><a href="#cb401-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb401-36"><a href="#cb401-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span id="cb401-37"><a href="#cb401-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]    0    1    0    0</span></span>
<span id="cb401-38"><a href="#cb401-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]    0    0    1    0</span></span>
<span id="cb401-39"><a href="#cb401-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,]    0    0    0    1</span></span>
<span id="cb401-40"><a href="#cb401-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-41"><a href="#cb401-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb401-42"><a href="#cb401-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Returned Error Value:</span></span>
<span id="cb401-43"><a href="#cb401-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can't reproduce this:</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="co"># predict(poisson_reg_fit, new_data = reg_group_test)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-39-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-3-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">826</span>)</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>  poisson_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Rat), <span class="at">data =</span> reg_group_train)</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00394285 (tol = 0.002, component 1)</span></span>
<span id="cb405-7"><a href="#cb405-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   See ?lme4::convergence and ?lme4::troubleshooting.</span></span>
<span id="cb405-8"><a href="#cb405-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue</span></span>
<span id="cb405-9"><a href="#cb405-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - Rescale variables?</span></span>
<span id="cb405-10"><a href="#cb405-10" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb405-11"><a href="#cb405-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb405-12"><a href="#cb405-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb405-13"><a href="#cb405-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span id="cb405-14"><a href="#cb405-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Approximation) [glmerMod]</span></span>
<span id="cb405-15"><a href="#cb405-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: poisson  ( log )</span></span>
<span id="cb405-16"><a href="#cb405-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: weight ~ Diet + Time + (1 | Rat)</span></span>
<span id="cb405-17"><a href="#cb405-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: data</span></span>
<span id="cb405-18"><a href="#cb405-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       AIC       BIC    logLik -2*log(L)  df.resid </span></span>
<span id="cb405-19"><a href="#cb405-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1079.1349 1093.5489 -534.5675 1069.1349       127 </span></span>
<span id="cb405-20"><a href="#cb405-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb405-21"><a href="#cb405-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups Name        Std.Dev.</span></span>
<span id="cb405-22"><a href="#cb405-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Rat    (Intercept) 0.03683 </span></span>
<span id="cb405-23"><a href="#cb405-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of obs: 132, groups:  Rat, 12</span></span>
<span id="cb405-24"><a href="#cb405-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed Effects:</span></span>
<span id="cb405-25"><a href="#cb405-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        Diet2        Diet3         Time  </span></span>
<span id="cb405-26"><a href="#cb405-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    5.524796     0.533446     0.684637     0.001467  </span></span>
<span id="cb405-27"><a href="#cb405-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; optimizer (Nelder_Mead) convergence code: 0 (OK) ; 0 optimizer warnings; 2 lme4 warnings</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  251.</span></span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  254.</span></span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  256.</span></span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  259.</span></span>
<span id="cb406-9"><a href="#cb406-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  262.</span></span>
<span id="cb406-10"><a href="#cb406-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  264.</span></span>
<span id="cb406-11"><a href="#cb406-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  267.</span></span>
<span id="cb406-12"><a href="#cb406-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  268.</span></span>
<span id="cb406-13"><a href="#cb406-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  270.</span></span>
<span id="cb406-14"><a href="#cb406-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  273.</span></span>
<span id="cb406-15"><a href="#cb406-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-39-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-4-tab">
<p>This engine requires the poissonreg extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poissonreg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>(<span class="at">penalty =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> poisson_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(num_years <span class="sc">~</span> ., <span class="at">data =</span> count_train)</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "poisson") </span></span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Df  %Dev Lambda</span></span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0  0.00 5.9710</span></span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   1 10.26 5.4400</span></span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   1 18.31 4.9570</span></span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   2 24.84 4.5170</span></span>
<span id="cb409-14"><a href="#cb409-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   2 32.06 4.1150</span></span>
<span id="cb409-15"><a href="#cb409-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   2 37.94 3.7500</span></span>
<span id="cb409-16"><a href="#cb409-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   2 42.73 3.4170</span></span>
<span id="cb409-17"><a href="#cb409-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   2 46.65 3.1130</span></span>
<span id="cb409-18"><a href="#cb409-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   2 49.87 2.8370</span></span>
<span id="cb409-19"><a href="#cb409-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  2 52.51 2.5850</span></span>
<span id="cb409-20"><a href="#cb409-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  2 54.69 2.3550</span></span>
<span id="cb409-21"><a href="#cb409-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  2 56.48 2.1460</span></span>
<span id="cb409-22"><a href="#cb409-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13  2 57.96 1.9550</span></span>
<span id="cb409-23"><a href="#cb409-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14  2 59.18 1.7810</span></span>
<span id="cb409-24"><a href="#cb409-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15  2 60.19 1.6230</span></span>
<span id="cb409-25"><a href="#cb409-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16  2 61.03 1.4790</span></span>
<span id="cb409-26"><a href="#cb409-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17  2 61.72 1.3480</span></span>
<span id="cb409-27"><a href="#cb409-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18  2 62.29 1.2280</span></span>
<span id="cb409-28"><a href="#cb409-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19  2 62.76 1.1190</span></span>
<span id="cb409-29"><a href="#cb409-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20  2 63.16 1.0190</span></span>
<span id="cb409-30"><a href="#cb409-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21  2 63.48 0.9289</span></span>
<span id="cb409-31"><a href="#cb409-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22  2 63.75 0.8463</span></span>
<span id="cb409-32"><a href="#cb409-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23  2 63.98 0.7712</span></span>
<span id="cb409-33"><a href="#cb409-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24  2 64.16 0.7026</span></span>
<span id="cb409-34"><a href="#cb409-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25  2 64.31 0.6402</span></span>
<span id="cb409-35"><a href="#cb409-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26  2 64.44 0.5833</span></span>
<span id="cb409-36"><a href="#cb409-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27  2 64.55 0.5315</span></span>
<span id="cb409-37"><a href="#cb409-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28  2 64.64 0.4843</span></span>
<span id="cb409-38"><a href="#cb409-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29  2 64.71 0.4413</span></span>
<span id="cb409-39"><a href="#cb409-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30  2 64.77 0.4021</span></span>
<span id="cb409-40"><a href="#cb409-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 31  2 64.82 0.3664</span></span>
<span id="cb409-41"><a href="#cb409-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32  2 64.86 0.3338</span></span>
<span id="cb409-42"><a href="#cb409-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33  2 64.90 0.3042</span></span>
<span id="cb409-43"><a href="#cb409-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 34  2 64.92 0.2771</span></span>
<span id="cb409-44"><a href="#cb409-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 35  2 64.95 0.2525</span></span>
<span id="cb409-45"><a href="#cb409-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 36  2 64.97 0.2301</span></span>
<span id="cb409-46"><a href="#cb409-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37  2 64.98 0.2096</span></span>
<span id="cb409-47"><a href="#cb409-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 38  2 65.00 0.1910</span></span>
<span id="cb409-48"><a href="#cb409-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 39  2 65.01 0.1741</span></span>
<span id="cb409-49"><a href="#cb409-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40  2 65.02 0.1586</span></span>
<span id="cb409-50"><a href="#cb409-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 41  2 65.03 0.1445</span></span>
<span id="cb409-51"><a href="#cb409-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 42  2 65.03 0.1317</span></span>
<span id="cb409-52"><a href="#cb409-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 43  2 65.04 0.1200</span></span>
<span id="cb409-53"><a href="#cb409-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44  2 65.04 0.1093</span></span>
<span id="cb409-54"><a href="#cb409-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 45  2 65.05 0.0996</span></span>
<span id="cb409-55"><a href="#cb409-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 46  2 65.05 0.0907</span></span>
<span id="cb409-56"><a href="#cb409-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47  2 65.05 0.0827</span></span>
<span id="cb409-57"><a href="#cb409-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48  2 65.05 0.0753</span></span>
<span id="cb409-58"><a href="#cb409-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 49  2 65.06 0.0687</span></span>
<span id="cb409-59"><a href="#cb409-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 50  2 65.06 0.0625</span></span>
<span id="cb409-60"><a href="#cb409-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 51  2 65.06 0.0570</span></span>
<span id="cb409-61"><a href="#cb409-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 52  2 65.06 0.0519</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">new_data =</span> count_test)</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 × 1</span></span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 31.4 </span></span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  6.70</span></span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 11.8 </span></span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 24.6 </span></span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 26.4 </span></span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  8.27</span></span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 31.8 </span></span>
<span id="cb410-12"><a href="#cb410-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  4.91</span></span>
<span id="cb410-13"><a href="#cb410-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9 28.1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-39-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-5-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb411"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> poisson_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(num_years <span class="sc">~</span> ., <span class="at">data =</span> count_train)</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionModel: glm</span></span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  GLM_model_R_1770287512312_5936 </span></span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GLM Model: summary</span></span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    family link                               regularization</span></span>
<span id="cb413-13"><a href="#cb413-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 poisson  log Elastic Net (alpha = 0.5, lambda = 0.01194 )</span></span>
<span id="cb413-14"><a href="#cb413-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_predictors_total number_of_active_predictors number_of_iterations</span></span>
<span id="cb413-15"><a href="#cb413-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                          2                           2                    4</span></span>
<span id="cb413-16"><a href="#cb413-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      training_frame</span></span>
<span id="cb413-17"><a href="#cb413-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 object_kyirzmfbti</span></span>
<span id="cb413-18"><a href="#cb413-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb413-19"><a href="#cb413-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients: glm coefficients</span></span>
<span id="cb413-20"><a href="#cb413-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       names coefficients standardized_coefficients</span></span>
<span id="cb413-21"><a href="#cb413-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Intercept     2.286411                  2.286411</span></span>
<span id="cb413-22"><a href="#cb413-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       age     0.279967                  0.279967</span></span>
<span id="cb413-23"><a href="#cb413-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    income     0.281952                  0.281952</span></span>
<span id="cb413-24"><a href="#cb413-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb413-25"><a href="#cb413-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionMetrics: glm</span></span>
<span id="cb413-26"><a href="#cb413-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb413-27"><a href="#cb413-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb413-28"><a href="#cb413-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  18.40519</span></span>
<span id="cb413-29"><a href="#cb413-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  4.290128</span></span>
<span id="cb413-30"><a href="#cb413-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MAE:  3.297048</span></span>
<span id="cb413-31"><a href="#cb413-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSLE:  0.467537</span></span>
<span id="cb413-32"><a href="#cb413-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Residual Deviance :  1.777749</span></span>
<span id="cb413-33"><a href="#cb413-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R^2 :  0.6934292</span></span>
<span id="cb413-34"><a href="#cb413-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance :7434.374</span></span>
<span id="cb413-35"><a href="#cb413-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null D.o.F. :1460</span></span>
<span id="cb413-36"><a href="#cb413-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance :2597.291</span></span>
<span id="cb413-37"><a href="#cb413-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual D.o.F. :1458</span></span>
<span id="cb413-38"><a href="#cb413-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC :8445.967</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">new_data =</span> count_test)</span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 × 1</span></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 31.6 </span></span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  6.67</span></span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 11.8 </span></span>
<span id="cb414-8"><a href="#cb414-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 24.8 </span></span>
<span id="cb414-9"><a href="#cb414-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 26.5 </span></span>
<span id="cb414-10"><a href="#cb414-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  8.24</span></span>
<span id="cb414-11"><a href="#cb414-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 32.0 </span></span>
<span id="cb414-12"><a href="#cb414-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  4.87</span></span>
<span id="cb414-13"><a href="#cb414-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9 28.2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-39-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-6-tab">
<p>This engine requires the poissonreg extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poissonreg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"hurdle"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> poisson_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(num_years <span class="sc">~</span> ., <span class="at">data =</span> count_train)</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb417-6"><a href="#cb417-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb417-7"><a href="#cb417-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb417-8"><a href="#cb417-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pscl::hurdle(formula = num_years ~ ., data = data)</span></span>
<span id="cb417-9"><a href="#cb417-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb417-10"><a href="#cb417-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Count model coefficients (truncated poisson with log link):</span></span>
<span id="cb417-11"><a href="#cb417-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          age       income  </span></span>
<span id="cb417-12"><a href="#cb417-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      2.2911       0.2749       0.2820  </span></span>
<span id="cb417-13"><a href="#cb417-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb417-14"><a href="#cb417-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Zero hurdle model coefficients (binomial with logit link):</span></span>
<span id="cb417-15"><a href="#cb417-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          age       income  </span></span>
<span id="cb417-16"><a href="#cb417-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      24.656        5.611       13.092</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">new_data =</span> count_test)</span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 × 1</span></span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 31.5 </span></span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  6.74</span></span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 11.9 </span></span>
<span id="cb418-8"><a href="#cb418-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 24.6 </span></span>
<span id="cb418-9"><a href="#cb418-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 26.4 </span></span>
<span id="cb418-10"><a href="#cb418-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  8.32</span></span>
<span id="cb418-11"><a href="#cb418-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 31.9 </span></span>
<span id="cb418-12"><a href="#cb418-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  4.89</span></span>
<span id="cb418-13"><a href="#cb418-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9 28.2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-39-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-7-tab">
<p>This engine requires the poissonreg extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poissonreg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stan"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">213</span>)</span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>  poisson_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time, <span class="at">data =</span> reg_group_train)</span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'count' NOW (CHAIN 1).</span></span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb421-9"><a href="#cb421-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0.000103 seconds</span></span>
<span id="cb421-10"><a href="#cb421-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.03 seconds.</span></span>
<span id="cb421-11"><a href="#cb421-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb421-12"><a href="#cb421-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb421-13"><a href="#cb421-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb421-14"><a href="#cb421-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb421-15"><a href="#cb421-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb421-16"><a href="#cb421-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb421-17"><a href="#cb421-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb421-18"><a href="#cb421-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb421-19"><a href="#cb421-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb421-20"><a href="#cb421-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb421-21"><a href="#cb421-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb421-22"><a href="#cb421-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb421-23"><a href="#cb421-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb421-24"><a href="#cb421-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb421-25"><a href="#cb421-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb421-26"><a href="#cb421-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb421-27"><a href="#cb421-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.026 seconds (Warm-up)</span></span>
<span id="cb421-28"><a href="#cb421-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.026 seconds (Sampling)</span></span>
<span id="cb421-29"><a href="#cb421-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.052 seconds (Total)</span></span>
<span id="cb421-30"><a href="#cb421-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb421-31"><a href="#cb421-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb421-32"><a href="#cb421-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'count' NOW (CHAIN 2).</span></span>
<span id="cb421-33"><a href="#cb421-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb421-34"><a href="#cb421-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 5e-06 seconds</span></span>
<span id="cb421-35"><a href="#cb421-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.</span></span>
<span id="cb421-36"><a href="#cb421-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb421-37"><a href="#cb421-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb421-38"><a href="#cb421-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb421-39"><a href="#cb421-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb421-40"><a href="#cb421-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb421-41"><a href="#cb421-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb421-42"><a href="#cb421-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb421-43"><a href="#cb421-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb421-44"><a href="#cb421-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb421-45"><a href="#cb421-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb421-46"><a href="#cb421-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb421-47"><a href="#cb421-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb421-48"><a href="#cb421-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb421-49"><a href="#cb421-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb421-50"><a href="#cb421-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb421-51"><a href="#cb421-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb421-52"><a href="#cb421-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 0.027 seconds (Warm-up)</span></span>
<span id="cb421-53"><a href="#cb421-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.027 seconds (Sampling)</span></span>
<span id="cb421-54"><a href="#cb421-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.054 seconds (Total)</span></span>
<span id="cb421-55"><a href="#cb421-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb421-56"><a href="#cb421-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb421-57"><a href="#cb421-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'count' NOW (CHAIN 3).</span></span>
<span id="cb421-58"><a href="#cb421-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb421-59"><a href="#cb421-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Gradient evaluation took 4e-06 seconds</span></span>
<span id="cb421-60"><a href="#cb421-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.</span></span>
<span id="cb421-61"><a href="#cb421-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span></span>
<span id="cb421-62"><a href="#cb421-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb421-63"><a href="#cb421-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb421-64"><a href="#cb421-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb421-65"><a href="#cb421-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb421-66"><a href="#cb421-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb421-67"><a href="#cb421-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb421-68"><a href="#cb421-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb421-69"><a href="#cb421-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb421-70"><a href="#cb421-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb421-71"><a href="#cb421-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb421-72"><a href="#cb421-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb421-73"><a href="#cb421-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb421-74"><a href="#cb421-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb421-75"><a href="#cb421-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb421-76"><a href="#cb421-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb421-77"><a href="#cb421-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3:  Elapsed Time: 0.026 seconds (Warm-up)</span></span>
<span id="cb421-78"><a href="#cb421-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3:                0.027 seconds (Sampling)</span></span>
<span id="cb421-79"><a href="#cb421-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3:                0.053 seconds (Total)</span></span>
<span id="cb421-80"><a href="#cb421-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb421-81"><a href="#cb421-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb421-82"><a href="#cb421-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'count' NOW (CHAIN 4).</span></span>
<span id="cb421-83"><a href="#cb421-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb421-84"><a href="#cb421-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Gradient evaluation took 4e-06 seconds</span></span>
<span id="cb421-85"><a href="#cb421-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.</span></span>
<span id="cb421-86"><a href="#cb421-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span></span>
<span id="cb421-87"><a href="#cb421-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb421-88"><a href="#cb421-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb421-89"><a href="#cb421-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb421-90"><a href="#cb421-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb421-91"><a href="#cb421-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb421-92"><a href="#cb421-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb421-93"><a href="#cb421-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb421-94"><a href="#cb421-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb421-95"><a href="#cb421-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb421-96"><a href="#cb421-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb421-97"><a href="#cb421-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb421-98"><a href="#cb421-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb421-99"><a href="#cb421-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb421-100"><a href="#cb421-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb421-101"><a href="#cb421-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb421-102"><a href="#cb421-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4:  Elapsed Time: 0.027 seconds (Warm-up)</span></span>
<span id="cb421-103"><a href="#cb421-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4:                0.031 seconds (Sampling)</span></span>
<span id="cb421-104"><a href="#cb421-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4:                0.058 seconds (Total)</span></span>
<span id="cb421-105"><a href="#cb421-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4:</span></span>
<span id="cb421-106"><a href="#cb421-106" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb421-107"><a href="#cb421-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb421-108"><a href="#cb421-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb421-109"><a href="#cb421-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stan_glm</span></span>
<span id="cb421-110"><a href="#cb421-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  family:       poisson [log]</span></span>
<span id="cb421-111"><a href="#cb421-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  formula:      weight ~ Diet + Time</span></span>
<span id="cb421-112"><a href="#cb421-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  observations: 132</span></span>
<span id="cb421-113"><a href="#cb421-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  predictors:   4</span></span>
<span id="cb421-114"><a href="#cb421-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb421-115"><a href="#cb421-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Median MAD_SD</span></span>
<span id="cb421-116"><a href="#cb421-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 5.5    0.0   </span></span>
<span id="cb421-117"><a href="#cb421-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diet2       0.5    0.0   </span></span>
<span id="cb421-118"><a href="#cb421-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diet3       0.7    0.0   </span></span>
<span id="cb421-119"><a href="#cb421-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time        0.0    0.0   </span></span>
<span id="cb421-120"><a href="#cb421-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb421-121"><a href="#cb421-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb421-122"><a href="#cb421-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For help interpreting the printed output see ?print.stanreg</span></span>
<span id="cb421-123"><a href="#cb421-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  5.53</span></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  5.54</span></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  5.55</span></span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  5.56</span></span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  5.57</span></span>
<span id="cb422-10"><a href="#cb422-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  5.58</span></span>
<span id="cb422-11"><a href="#cb422-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  5.59</span></span>
<span id="cb422-12"><a href="#cb422-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  5.59</span></span>
<span id="cb422-13"><a href="#cb422-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  5.60</span></span>
<span id="cb422-14"><a href="#cb422-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  5.61</span></span>
<span id="cb422-15"><a href="#cb422-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span>
<span id="cb422-16"><a href="#cb422-16" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb422-17"><a href="#cb422-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Instead of posterior_linpred(..., transform=TRUE) please call posterior_epred(), which provides equivalent functionality.</span></span>
<span id="cb422-18"><a href="#cb422-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 2</span></span>
<span id="cb422-19"><a href="#cb422-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_lower .pred_upper</span></span>
<span id="cb422-20"><a href="#cb422-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb422-21"><a href="#cb422-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1        246.        257.</span></span>
<span id="cb422-22"><a href="#cb422-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2        249.        259.</span></span>
<span id="cb422-23"><a href="#cb422-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3        252.        261.</span></span>
<span id="cb422-24"><a href="#cb422-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4        255.        263.</span></span>
<span id="cb422-25"><a href="#cb422-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5        258.        266.</span></span>
<span id="cb422-26"><a href="#cb422-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6        261.        269.</span></span>
<span id="cb422-27"><a href="#cb422-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7        263.        272.</span></span>
<span id="cb422-28"><a href="#cb422-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8        264.        272.</span></span>
<span id="cb422-29"><a href="#cb422-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9        266.        275.</span></span>
<span id="cb422-30"><a href="#cb422-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10        268.        278.</span></span>
<span id="cb422-31"><a href="#cb422-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span>
<span id="cb422-32"><a href="#cb422-32" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb422-33"><a href="#cb422-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 2</span></span>
<span id="cb422-34"><a href="#cb422-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_lower .pred_upper</span></span>
<span id="cb422-35"><a href="#cb422-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb422-36"><a href="#cb422-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1         220         284</span></span>
<span id="cb422-37"><a href="#cb422-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2         222         286</span></span>
<span id="cb422-38"><a href="#cb422-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3         225         288</span></span>
<span id="cb422-39"><a href="#cb422-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4         228         291</span></span>
<span id="cb422-40"><a href="#cb422-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5         230         296</span></span>
<span id="cb422-41"><a href="#cb422-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6         232         297</span></span>
<span id="cb422-42"><a href="#cb422-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7         235         300</span></span>
<span id="cb422-43"><a href="#cb422-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8         236         300</span></span>
<span id="cb422-44"><a href="#cb422-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9         238         303</span></span>
<span id="cb422-45"><a href="#cb422-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10         241         306</span></span>
<span id="cb422-46"><a href="#cb422-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-39-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-8-tab">
<p>This engine requires the multilevelmod extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multilevelmod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"stan_glmer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">690</span>)</span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> </span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>  poisson_reg_spec <span class="sc">|&gt;</span> </span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(weight <span class="sc">~</span> Diet <span class="sc">+</span> Time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Rat), <span class="at">data =</span> reg_group_train)</span>
<span id="cb425-6"><a href="#cb425-6" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb425-7"><a href="#cb425-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb425-8"><a href="#cb425-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb425-9"><a href="#cb425-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stan_glmer</span></span>
<span id="cb425-10"><a href="#cb425-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  family:       poisson [log]</span></span>
<span id="cb425-11"><a href="#cb425-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  formula:      weight ~ Diet + Time + (1 | Rat)</span></span>
<span id="cb425-12"><a href="#cb425-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  observations: 132</span></span>
<span id="cb425-13"><a href="#cb425-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb425-14"><a href="#cb425-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Median MAD_SD</span></span>
<span id="cb425-15"><a href="#cb425-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 5.5    0.0   </span></span>
<span id="cb425-16"><a href="#cb425-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diet2       0.5    0.0   </span></span>
<span id="cb425-17"><a href="#cb425-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Diet3       0.7    0.0   </span></span>
<span id="cb425-18"><a href="#cb425-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time        0.0    0.0   </span></span>
<span id="cb425-19"><a href="#cb425-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb425-20"><a href="#cb425-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error terms:</span></span>
<span id="cb425-21"><a href="#cb425-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups Name        Std.Dev.</span></span>
<span id="cb425-22"><a href="#cb425-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Rat    (Intercept) 0.054   </span></span>
<span id="cb425-23"><a href="#cb425-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Num. levels: Rat 12 </span></span>
<span id="cb425-24"><a href="#cb425-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb425-25"><a href="#cb425-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb425-26"><a href="#cb425-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For help interpreting the printed output see ?print.stanreg</span></span>
<span id="cb425-27"><a href="#cb425-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred</span></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  251.</span></span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  254.</span></span>
<span id="cb426-7"><a href="#cb426-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  256.</span></span>
<span id="cb426-8"><a href="#cb426-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  259.</span></span>
<span id="cb426-9"><a href="#cb426-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  261.</span></span>
<span id="cb426-10"><a href="#cb426-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  264.</span></span>
<span id="cb426-11"><a href="#cb426-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  267.</span></span>
<span id="cb426-12"><a href="#cb426-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  268.</span></span>
<span id="cb426-13"><a href="#cb426-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  270.</span></span>
<span id="cb426-14"><a href="#cb426-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  272.</span></span>
<span id="cb426-15"><a href="#cb426-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span>
<span id="cb426-16"><a href="#cb426-16" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">type =</span> <span class="st">"pred_int"</span>, <span class="at">new_data =</span> reg_group_test)</span>
<span id="cb426-17"><a href="#cb426-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 2</span></span>
<span id="cb426-18"><a href="#cb426-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_lower .pred_upper</span></span>
<span id="cb426-19"><a href="#cb426-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb426-20"><a href="#cb426-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1        210.        294 </span></span>
<span id="cb426-21"><a href="#cb426-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2        213         298 </span></span>
<span id="cb426-22"><a href="#cb426-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3        214         301 </span></span>
<span id="cb426-23"><a href="#cb426-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4        217         304 </span></span>
<span id="cb426-24"><a href="#cb426-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5        220         306 </span></span>
<span id="cb426-25"><a href="#cb426-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6        222         309 </span></span>
<span id="cb426-26"><a href="#cb426-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7        223         313.</span></span>
<span id="cb426-27"><a href="#cb426-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8        225         315 </span></span>
<span id="cb426-28"><a href="#cb426-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9        226         317.</span></span>
<span id="cb426-29"><a href="#cb426-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10        229         320 </span></span>
<span id="cb426-30"><a href="#cb426-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 34 more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-39-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-9-tab">
<p>This engine requires the poissonreg extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb427"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poissonreg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"zeroinfl"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb429"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit <span class="ot">&lt;-</span> poisson_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(num_years <span class="sc">~</span> ., <span class="at">data =</span> count_train)</span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a>poisson_reg_fit</span>
<span id="cb429-5"><a href="#cb429-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb429-6"><a href="#cb429-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-7"><a href="#cb429-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-8"><a href="#cb429-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb429-9"><a href="#cb429-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pscl::zeroinfl(formula = num_years ~ ., data = data)</span></span>
<span id="cb429-10"><a href="#cb429-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-11"><a href="#cb429-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Count model coefficients (poisson with log link):</span></span>
<span id="cb429-12"><a href="#cb429-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          age       income  </span></span>
<span id="cb429-13"><a href="#cb429-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      2.2912       0.2748       0.2821  </span></span>
<span id="cb429-14"><a href="#cb429-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb429-15"><a href="#cb429-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Zero-inflation model coefficients (binomial with logit link):</span></span>
<span id="cb429-16"><a href="#cb429-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          age       income  </span></span>
<span id="cb429-17"><a href="#cb429-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      -48.26       -18.22       -11.72</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(poisson_reg_fit, <span class="at">new_data =</span> count_test)</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 × 1</span></span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 31.5 </span></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  6.74</span></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 11.9 </span></span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 24.6 </span></span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 26.4 </span></span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  8.31</span></span>
<span id="cb430-11"><a href="#cb430-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 31.9 </span></span>
<span id="cb430-12"><a href="#cb430-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  4.93</span></span>
<span id="cb430-13"><a href="#cb430-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9 28.2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="random-forests-rand_forest-1" class="level3">
<h3 class="anchored" data-anchor-id="random-forests-rand_forest-1">Random Forests (<code>rand_forest()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-40-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-1" role="tab" aria-controls="tabset-40-1" aria-selected="true" href=""><code>ranger</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-2" role="tab" aria-controls="tabset-40-2" aria-selected="false" href=""><code>aorsf</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-3" role="tab" aria-controls="tabset-40-3" aria-selected="false" href=""><code>grf</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-4" role="tab" aria-controls="tabset-40-4" aria-selected="false" href=""><code>h2o</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-5" role="tab" aria-controls="tabset-40-5" aria-selected="false" href=""><code>partykit</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-6" role="tab" aria-controls="tabset-40-6" aria-selected="false" href=""><code>randomForest</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-7" role="tab" aria-controls="tabset-40-7" aria-selected="false" href=""><code>spark</code></a></li></ul>
<div class="tab-content">
<div id="tabset-40-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-40-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because ranger is the default.</span></span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"ranger"</span>, <span class="at">keep.inbag =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># However, we'll set the engine and use the keep.inbag=TRUE option so that we </span></span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># can produce interval predictions. This is not generally required. </span></span>
<span id="cb431-7"><a href="#cb431-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">860</span>)</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Ranger result</span></span>
<span id="cb432-9"><a href="#cb432-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb432-10"><a href="#cb432-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb432-11"><a href="#cb432-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ranger::ranger(x = maybe_data_frame(x), y = y, keep.inbag = ~TRUE,      num.threads = 1, verbose = FALSE, seed = sample.int(10^5,          1)) </span></span>
<span id="cb432-12"><a href="#cb432-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb432-13"><a href="#cb432-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Type:                             Regression </span></span>
<span id="cb432-14"><a href="#cb432-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of trees:                  500 </span></span>
<span id="cb432-15"><a href="#cb432-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sample size:                      92 </span></span>
<span id="cb432-16"><a href="#cb432-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of independent variables:  2 </span></span>
<span id="cb432-17"><a href="#cb432-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mtry:                             1 </span></span>
<span id="cb432-18"><a href="#cb432-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target node size:                 5 </span></span>
<span id="cb432-19"><a href="#cb432-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance mode:         none </span></span>
<span id="cb432-20"><a href="#cb432-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Splitrule:                        variance </span></span>
<span id="cb432-21"><a href="#cb432-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; OOB prediction error (MSE):       92.94531 </span></span>
<span id="cb432-22"><a href="#cb432-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R squared (OOB):                  0.6816071</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb433-5"><a href="#cb433-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  23.6</span></span>
<span id="cb433-6"><a href="#cb433-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  36.9</span></span>
<span id="cb433-7"><a href="#cb433-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.4</span></span>
<span id="cb433-8"><a href="#cb433-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  56.5</span></span>
<span id="cb433-9"><a href="#cb433-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  38.6</span></span>
<span id="cb433-10"><a href="#cb433-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  36.5</span></span>
<span id="cb433-11"><a href="#cb433-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.7</span></span>
<span id="cb433-12"><a href="#cb433-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  34.4</span></span>
<span id="cb433-13"><a href="#cb433-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> reg_test)</span>
<span id="cb433-14"><a href="#cb433-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in rInfJack(pred = result$predictions, inbag = inbag.counts, used.trees</span></span>
<span id="cb433-15"><a href="#cb433-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = 1:num.trees): Sample size &lt;=20, no calibration performed.</span></span>
<span id="cb433-16"><a href="#cb433-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span id="cb433-17"><a href="#cb433-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower .pred_upper</span></span>
<span id="cb433-18"><a href="#cb433-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb433-19"><a href="#cb433-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        18.1        29.1</span></span>
<span id="cb433-20"><a href="#cb433-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        32.6        41.1</span></span>
<span id="cb433-21"><a href="#cb433-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        24.0        32.9</span></span>
<span id="cb433-22"><a href="#cb433-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        45.4        67.7</span></span>
<span id="cb433-23"><a href="#cb433-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        33.0        44.3</span></span>
<span id="cb433-24"><a href="#cb433-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        32.0        41.0</span></span>
<span id="cb433-25"><a href="#cb433-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        35.1        42.3</span></span>
<span id="cb433-26"><a href="#cb433-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        28.4        40.3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-40-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-2-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb435-4"><a href="#cb435-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"aorsf"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">47</span>)</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb436-8"><a href="#cb436-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------- Oblique random regression forest</span></span>
<span id="cb436-9"><a href="#cb436-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb436-10"><a href="#cb436-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Linear combinations: Accelerated Linear regression</span></span>
<span id="cb436-11"><a href="#cb436-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           N observations: 92</span></span>
<span id="cb436-12"><a href="#cb436-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  N trees: 500</span></span>
<span id="cb436-13"><a href="#cb436-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       N predictors total: 2</span></span>
<span id="cb436-14"><a href="#cb436-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    N predictors per node: 2</span></span>
<span id="cb436-15"><a href="#cb436-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Average leaves per tree: 13.994</span></span>
<span id="cb436-16"><a href="#cb436-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Min observations in leaf: 5</span></span>
<span id="cb436-17"><a href="#cb436-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           OOB stat value: 0.59</span></span>
<span id="cb436-18"><a href="#cb436-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            OOB stat type: RSQ</span></span>
<span id="cb436-19"><a href="#cb436-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Variable importance: anova</span></span>
<span id="cb436-20"><a href="#cb436-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb436-21"><a href="#cb436-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb437"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  25.2</span></span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  36.4</span></span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  29.7</span></span>
<span id="cb437-8"><a href="#cb437-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  55.5</span></span>
<span id="cb437-9"><a href="#cb437-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  42.3</span></span>
<span id="cb437-10"><a href="#cb437-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  38.5</span></span>
<span id="cb437-11"><a href="#cb437-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  40.7</span></span>
<span id="cb437-12"><a href="#cb437-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  52.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-40-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-3-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"grf"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130</span>)</span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb439-6"><a href="#cb439-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb439-7"><a href="#cb439-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb439-8"><a href="#cb439-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GRF forest object of type regression_forest </span></span>
<span id="cb439-9"><a href="#cb439-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of trees: 2000 </span></span>
<span id="cb439-10"><a href="#cb439-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of training samples: 92 </span></span>
<span id="cb439-11"><a href="#cb439-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance: </span></span>
<span id="cb439-12"><a href="#cb439-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1    2 </span></span>
<span id="cb439-13"><a href="#cb439-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.51 0.49</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  26.8</span></span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  38.9</span></span>
<span id="cb440-7"><a href="#cb440-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.3</span></span>
<span id="cb440-8"><a href="#cb440-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  47.0</span></span>
<span id="cb440-9"><a href="#cb440-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  41.1</span></span>
<span id="cb440-10"><a href="#cb440-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  36.4</span></span>
<span id="cb440-11"><a href="#cb440-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.3</span></span>
<span id="cb440-12"><a href="#cb440-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  33.8</span></span>
<span id="cb440-13"><a href="#cb440-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"conf_int"</span>, <span class="at">new_data =</span> reg_test)</span>
<span id="cb440-14"><a href="#cb440-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 2</span></span>
<span id="cb440-15"><a href="#cb440-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_lower .pred_upper</span></span>
<span id="cb440-16"><a href="#cb440-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb440-17"><a href="#cb440-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        34.8        18.8</span></span>
<span id="cb440-18"><a href="#cb440-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        47.1        30.8</span></span>
<span id="cb440-19"><a href="#cb440-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        31.9        24.7</span></span>
<span id="cb440-20"><a href="#cb440-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        58.3        35.8</span></span>
<span id="cb440-21"><a href="#cb440-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        48.0        34.1</span></span>
<span id="cb440-22"><a href="#cb440-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        40.0        32.9</span></span>
<span id="cb440-23"><a href="#cb440-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        43.7        32.9</span></span>
<span id="cb440-24"><a href="#cb440-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        43.9        23.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-40-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-4-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb443"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">211</span>)</span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb443-5"><a href="#cb443-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb443-6"><a href="#cb443-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb443-7"><a href="#cb443-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb443-8"><a href="#cb443-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb443-9"><a href="#cb443-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb443-10"><a href="#cb443-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb443-11"><a href="#cb443-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionModel: drf</span></span>
<span id="cb443-12"><a href="#cb443-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  DRF_model_R_1770287512312_5937 </span></span>
<span id="cb443-13"><a href="#cb443-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Summary: </span></span>
<span id="cb443-14"><a href="#cb443-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_trees number_of_internal_trees model_size_in_bytes min_depth</span></span>
<span id="cb443-15"><a href="#cb443-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              50                       50               22316         7</span></span>
<span id="cb443-16"><a href="#cb443-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max_depth mean_depth min_leaves max_leaves mean_leaves</span></span>
<span id="cb443-17"><a href="#cb443-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        14    9.04000         14         43    30.86000</span></span>
<span id="cb443-18"><a href="#cb443-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb443-19"><a href="#cb443-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb443-20"><a href="#cb443-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionMetrics: drf</span></span>
<span id="cb443-21"><a href="#cb443-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb443-22"><a href="#cb443-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Metrics reported on Out-Of-Bag training samples **</span></span>
<span id="cb443-23"><a href="#cb443-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb443-24"><a href="#cb443-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  89.19785</span></span>
<span id="cb443-25"><a href="#cb443-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  9.444462</span></span>
<span id="cb443-26"><a href="#cb443-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MAE:  7.597463</span></span>
<span id="cb443-27"><a href="#cb443-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSLE:  0.3303384</span></span>
<span id="cb443-28"><a href="#cb443-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Residual Deviance :  89.19785</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  24.9</span></span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  36.4</span></span>
<span id="cb444-7"><a href="#cb444-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.1</span></span>
<span id="cb444-8"><a href="#cb444-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  56.8</span></span>
<span id="cb444-9"><a href="#cb444-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  39.0</span></span>
<span id="cb444-10"><a href="#cb444-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  37.8</span></span>
<span id="cb444-11"><a href="#cb444-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  37.4</span></span>
<span id="cb444-12"><a href="#cb444-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  31.8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-40-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-5-tab">
<p>This engine requires the bonsai extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bonsai)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"partykit"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">981</span>)</span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The print method has a lot of output:</p>
<details>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">print</span>(rand_forest_fit))[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>] <span class="sc">|&gt;</span> <span class="fu">cat</span>(<span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes</span></span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[1]]</span></span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.31678</span></span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.60316</span></span>
<span id="cb448-10"><a href="#cb448-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V2 &lt;= -0.89134 *</span></span>
<span id="cb448-11"><a href="#cb448-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [6] V2 &gt; -0.89134 *</span></span>
<span id="cb448-12"><a href="#cb448-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [7] V2 &gt; 0.31678</span></span>
<span id="cb448-13"><a href="#cb448-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [8] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-14"><a href="#cb448-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [9] V3 &gt; -0.60316 *</span></span>
<span id="cb448-15"><a href="#cb448-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-16"><a href="#cb448-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[2]]</span></span>
<span id="cb448-17"><a href="#cb448-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-18"><a href="#cb448-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.62459</span></span>
<span id="cb448-19"><a href="#cb448-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-20"><a href="#cb448-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.60316</span></span>
<span id="cb448-21"><a href="#cb448-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V2 &lt;= -1.16452 *</span></span>
<span id="cb448-22"><a href="#cb448-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [6] V2 &gt; -1.16452</span></span>
<span id="cb448-23"><a href="#cb448-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [7] V3 &lt;= -0.2359 *</span></span>
<span id="cb448-24"><a href="#cb448-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [8] V3 &gt; -0.2359 *</span></span>
<span id="cb448-25"><a href="#cb448-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [9] V2 &gt; 0.62459 *</span></span>
<span id="cb448-26"><a href="#cb448-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-27"><a href="#cb448-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[3]]</span></span>
<span id="cb448-28"><a href="#cb448-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-29"><a href="#cb448-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.34564</span></span>
<span id="cb448-30"><a href="#cb448-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-31"><a href="#cb448-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.60316</span></span>
<span id="cb448-32"><a href="#cb448-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V2 &lt;= -1.19338 *</span></span>
<span id="cb448-33"><a href="#cb448-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [6] V2 &gt; -1.19338 *</span></span>
<span id="cb448-34"><a href="#cb448-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [7] V2 &gt; 0.34564</span></span>
<span id="cb448-35"><a href="#cb448-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [8] V2 &lt;= 1.21134 *</span></span>
<span id="cb448-36"><a href="#cb448-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [9] V2 &gt; 1.21134 *</span></span>
<span id="cb448-37"><a href="#cb448-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-38"><a href="#cb448-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[4]]</span></span>
<span id="cb448-39"><a href="#cb448-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-40"><a href="#cb448-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.34564</span></span>
<span id="cb448-41"><a href="#cb448-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-42"><a href="#cb448-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.60316</span></span>
<span id="cb448-43"><a href="#cb448-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V3 &lt;= 0.25377 *</span></span>
<span id="cb448-44"><a href="#cb448-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [6] V3 &gt; 0.25377 *</span></span>
<span id="cb448-45"><a href="#cb448-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [7] V2 &gt; 0.34564</span></span>
<span id="cb448-46"><a href="#cb448-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [8] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-47"><a href="#cb448-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [9] V3 &gt; -0.60316 *</span></span>
<span id="cb448-48"><a href="#cb448-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-49"><a href="#cb448-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[5]]</span></span>
<span id="cb448-50"><a href="#cb448-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-51"><a href="#cb448-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.62459</span></span>
<span id="cb448-52"><a href="#cb448-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.48074 *</span></span>
<span id="cb448-53"><a href="#cb448-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.48074</span></span>
<span id="cb448-54"><a href="#cb448-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V2 &lt;= -1.12604 *</span></span>
<span id="cb448-55"><a href="#cb448-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [6] V2 &gt; -1.12604</span></span>
<span id="cb448-56"><a href="#cb448-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [7] V3 &lt;= -0.2359 *</span></span>
<span id="cb448-57"><a href="#cb448-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [8] V3 &gt; -0.2359 *</span></span>
<span id="cb448-58"><a href="#cb448-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [9] V2 &gt; 0.62459 *</span></span>
<span id="cb448-59"><a href="#cb448-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-60"><a href="#cb448-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[6]]</span></span>
<span id="cb448-61"><a href="#cb448-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-62"><a href="#cb448-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.72078</span></span>
<span id="cb448-63"><a href="#cb448-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-64"><a href="#cb448-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.60316</span></span>
<span id="cb448-65"><a href="#cb448-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V2 &lt;= -0.84517 *</span></span>
<span id="cb448-66"><a href="#cb448-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [6] V2 &gt; -0.84517 *</span></span>
<span id="cb448-67"><a href="#cb448-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [7] V2 &gt; 0.72078 *</span></span>
<span id="cb448-68"><a href="#cb448-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-69"><a href="#cb448-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[7]]</span></span>
<span id="cb448-70"><a href="#cb448-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-71"><a href="#cb448-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.72078</span></span>
<span id="cb448-72"><a href="#cb448-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-73"><a href="#cb448-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.60316</span></span>
<span id="cb448-74"><a href="#cb448-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V3 &lt;= -0.2359</span></span>
<span id="cb448-75"><a href="#cb448-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [6] V2 &lt;= 0.24945 *</span></span>
<span id="cb448-76"><a href="#cb448-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [7] V2 &gt; 0.24945 *</span></span>
<span id="cb448-77"><a href="#cb448-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [8] V3 &gt; -0.2359 *</span></span>
<span id="cb448-78"><a href="#cb448-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [9] V2 &gt; 0.72078 *</span></span>
<span id="cb448-79"><a href="#cb448-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-80"><a href="#cb448-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[8]]</span></span>
<span id="cb448-81"><a href="#cb448-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-82"><a href="#cb448-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.72078</span></span>
<span id="cb448-83"><a href="#cb448-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.48074 *</span></span>
<span id="cb448-84"><a href="#cb448-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.48074</span></span>
<span id="cb448-85"><a href="#cb448-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V3 &lt;= -0.2359 *</span></span>
<span id="cb448-86"><a href="#cb448-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [6] V3 &gt; -0.2359 *</span></span>
<span id="cb448-87"><a href="#cb448-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [7] V2 &gt; 0.72078 *</span></span>
<span id="cb448-88"><a href="#cb448-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-89"><a href="#cb448-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[9]]</span></span>
<span id="cb448-90"><a href="#cb448-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb448-91"><a href="#cb448-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V2 &lt;= 0.62459</span></span>
<span id="cb448-92"><a href="#cb448-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V3 &lt;= -0.60316 *</span></span>
<span id="cb448-93"><a href="#cb448-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] V3 &gt; -0.60316</span></span>
<span id="cb448-94"><a href="#cb448-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V2 &lt;= -0.23149</span></span>
<span id="cb448-95"><a href="#cb448-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [6] V2 &lt;= -1.09526 *</span></span>
<span id="cb448-96"><a href="#cb448-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [7] V2 &gt; -1.09526 *</span></span>
<span id="cb448-97"><a href="#cb448-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [8] V2 &gt; -0.23149 *</span></span>
<span id="cb448-98"><a href="#cb448-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [9] V2 &gt; 0.62459 *</span></span>
<span id="cb448-99"><a href="#cb448-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb448-100"><a href="#cb448-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[10]]</span></span>
<span id="cb448-101"><a href="#cb448-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  16.3</span></span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  37.7</span></span>
<span id="cb449-7"><a href="#cb449-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.5</span></span>
<span id="cb449-8"><a href="#cb449-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  50.6</span></span>
<span id="cb449-9"><a href="#cb449-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  49.2</span></span>
<span id="cb449-10"><a href="#cb449-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  36.1</span></span>
<span id="cb449-11"><a href="#cb449-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.6</span></span>
<span id="cb449-12"><a href="#cb449-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  49.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-40-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-6-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"randomForest"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">793</span>)</span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb451-9"><a href="#cb451-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb451-10"><a href="#cb451-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  randomForest(x = maybe_data_frame(x), y = y) </span></span>
<span id="cb451-11"><a href="#cb451-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Type of random forest: regression</span></span>
<span id="cb451-12"><a href="#cb451-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Number of trees: 500</span></span>
<span id="cb451-13"><a href="#cb451-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; No. of variables tried at each split: 1</span></span>
<span id="cb451-14"><a href="#cb451-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb451-15"><a href="#cb451-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Mean of squared residuals: 90.38475</span></span>
<span id="cb451-16"><a href="#cb451-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     % Var explained: 68.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb452-5"><a href="#cb452-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  23.5</span></span>
<span id="cb452-6"><a href="#cb452-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  36.8</span></span>
<span id="cb452-7"><a href="#cb452-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  28.6</span></span>
<span id="cb452-8"><a href="#cb452-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  58.0</span></span>
<span id="cb452-9"><a href="#cb452-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  38.3</span></span>
<span id="cb452-10"><a href="#cb452-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.4</span></span>
<span id="cb452-11"><a href="#cb452-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.1</span></span>
<span id="cb452-12"><a href="#cb452-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  33.7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-40-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-7-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"spark"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">157</span>)</span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(compressive_strength <span class="sc">~</span> ., <span class="at">data =</span> tbl_reg<span class="sc">$</span>training)</span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: compressive_strength ~ .</span></span>
<span id="cb454-9"><a href="#cb454-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb454-10"><a href="#cb454-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RandomForestRegressionModel: uid=random_forest__18b9f872_1e54_42c8_9671_918541c74363, numTrees=20, numFeatures=8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">new_data =</span> tbl_reg<span class="sc">$</span>test)</span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source:   SQL [?? x 1]</span></span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Database: spark_connection</span></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     pred</span></span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  28.2</span></span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  29.6</span></span>
<span id="cb455-8"><a href="#cb455-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  23.0</span></span>
<span id="cb455-9"><a href="#cb455-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  28.2</span></span>
<span id="cb455-10"><a href="#cb455-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  15.2</span></span>
<span id="cb455-11"><a href="#cb455-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  35.3</span></span>
<span id="cb455-12"><a href="#cb455-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  18.6</span></span>
<span id="cb455-13"><a href="#cb455-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  31.9</span></span>
<span id="cb455-14"><a href="#cb455-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  36.3</span></span>
<span id="cb455-15"><a href="#cb455-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  45.4</span></span>
<span id="cb455-16"><a href="#cb455-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ more rows</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="rule-fit-rule_fit-1" class="level3">
<h3 class="anchored" data-anchor-id="rule-fit-rule_fit-1">Rule Fit (<code>rule_fit()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-41-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-1" role="tab" aria-controls="tabset-41-1" aria-selected="true" href=""><code>xrf</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-2" role="tab" aria-controls="tabset-41-2" aria-selected="false" href=""><code>h2o</code></a></li></ul>
<div class="tab-content">
<div id="tabset-41-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-41-1-tab">
<p>This engine requires the rules extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rules)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb457"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>rule_fit_spec <span class="ot">&lt;-</span> <span class="fu">rule_fit</span>() <span class="sc">|&gt;</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because xrf is the default.</span></span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">431</span>)</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>rule_fit_fit <span class="ot">&lt;-</span> rule_fit_spec <span class="sc">|&gt;</span></span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true" tabindex="-1"></a>rule_fit_fit</span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-8"><a href="#cb458-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An eXtreme RuleFit model of 187 rules.</span></span>
<span id="cb458-9"><a href="#cb458-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-10"><a href="#cb458-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Original Formula:</span></span>
<span id="cb458-11"><a href="#cb458-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb458-12"><a href="#cb458-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; strength ~ cement + age</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb459"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rule_fit_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  32.0</span></span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  33.5</span></span>
<span id="cb459-7"><a href="#cb459-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  31.9</span></span>
<span id="cb459-8"><a href="#cb459-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  47.9</span></span>
<span id="cb459-9"><a href="#cb459-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  48.2</span></span>
<span id="cb459-10"><a href="#cb459-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  28.3</span></span>
<span id="cb459-11"><a href="#cb459-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38.9</span></span>
<span id="cb459-12"><a href="#cb459-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  33.4</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-41-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-2-tab">
<p>This engine requires the agua extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agua)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a>rule_fit_spec <span class="ot">&lt;-</span> <span class="fu">rule_fit</span>() <span class="sc">|&gt;</span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"h2o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">236</span>)</span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a>rule_fit_fit <span class="ot">&lt;-</span> rule_fit_spec <span class="sc">|&gt;</span></span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb462-5"><a href="#cb462-5" aria-hidden="true" tabindex="-1"></a>rule_fit_fit</span>
<span id="cb462-6"><a href="#cb462-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb462-7"><a href="#cb462-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-8"><a href="#cb462-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Details:</span></span>
<span id="cb462-9"><a href="#cb462-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============</span></span>
<span id="cb462-10"><a href="#cb462-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-11"><a href="#cb462-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionModel: rulefit</span></span>
<span id="cb462-12"><a href="#cb462-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model ID:  RuleFit_model_R_1770287512312_5938 </span></span>
<span id="cb462-13"><a href="#cb462-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rulefit Model Summary: </span></span>
<span id="cb462-14"><a href="#cb462-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     family     link           regularization number_of_predictors_total</span></span>
<span id="cb462-15"><a href="#cb462-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 gaussian identity Lasso (lambda = 0.9516 )                       1917</span></span>
<span id="cb462-16"><a href="#cb462-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_active_predictors number_of_iterations rule_ensemble_size</span></span>
<span id="cb462-17"><a href="#cb462-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                          51                    1               1915</span></span>
<span id="cb462-18"><a href="#cb462-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   number_of_trees number_of_internal_trees min_depth max_depth mean_depth</span></span>
<span id="cb462-19"><a href="#cb462-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             150                      150         0         5    4.00000</span></span>
<span id="cb462-20"><a href="#cb462-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   min_leaves max_leaves mean_leaves</span></span>
<span id="cb462-21"><a href="#cb462-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          0         28    12.76667</span></span>
<span id="cb462-22"><a href="#cb462-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-23"><a href="#cb462-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-24"><a href="#cb462-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H2ORegressionMetrics: rulefit</span></span>
<span id="cb462-25"><a href="#cb462-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ** Reported on training data. **</span></span>
<span id="cb462-26"><a href="#cb462-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb462-27"><a href="#cb462-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MSE:  90.45501</span></span>
<span id="cb462-28"><a href="#cb462-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSE:  9.510784</span></span>
<span id="cb462-29"><a href="#cb462-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MAE:  7.15224</span></span>
<span id="cb462-30"><a href="#cb462-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSLE:  0.3531064</span></span>
<span id="cb462-31"><a href="#cb462-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Residual Deviance :  90.45501</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rule_fit_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  26.9</span></span>
<span id="cb463-6"><a href="#cb463-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  35.5</span></span>
<span id="cb463-7"><a href="#cb463-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  26.9</span></span>
<span id="cb463-8"><a href="#cb463-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  50.1</span></span>
<span id="cb463-9"><a href="#cb463-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  42.1</span></span>
<span id="cb463-10"><a href="#cb463-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  34.5</span></span>
<span id="cb463-11"><a href="#cb463-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  39.3</span></span>
<span id="cb463-12"><a href="#cb463-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  40.8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="support-vector-machine-linear-kernel-svm_linear-1" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-linear-kernel-svm_linear-1">Support Vector Machine (Linear Kernel) (<code>svm_linear()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-42-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-1" role="tab" aria-controls="tabset-42-1" aria-selected="true" href=""><code>kernlab</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-2" role="tab" aria-controls="tabset-42-2" aria-selected="false" href=""><code>LiblineaR</code></a></li></ul>
<div class="tab-content">
<div id="tabset-42-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-42-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>svm_linear_spec <span class="ot">&lt;-</span> <span class="fu">svm_linear</span>() <span class="sc">|&gt;</span></span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a>svm_linear_fit <span class="ot">&lt;-</span> svm_linear_spec <span class="sc">|&gt;</span></span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true" tabindex="-1"></a>svm_linear_fit</span>
<span id="cb465-4"><a href="#cb465-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb465-5"><a href="#cb465-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb465-6"><a href="#cb465-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Support Vector Machine object of class "ksvm" </span></span>
<span id="cb465-7"><a href="#cb465-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb465-8"><a href="#cb465-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SV type: eps-svr  (regression) </span></span>
<span id="cb465-9"><a href="#cb465-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span id="cb465-10"><a href="#cb465-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb465-11"><a href="#cb465-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear (vanilla) kernel function. </span></span>
<span id="cb465-12"><a href="#cb465-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb465-13"><a href="#cb465-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Support Vectors : 85 </span></span>
<span id="cb465-14"><a href="#cb465-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb465-15"><a href="#cb465-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Objective Function Value : -47.4495 </span></span>
<span id="cb465-16"><a href="#cb465-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training error : 0.606701</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_linear_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb466-5"><a href="#cb466-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  29.4</span></span>
<span id="cb466-6"><a href="#cb466-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.9</span></span>
<span id="cb466-7"><a href="#cb466-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.7</span></span>
<span id="cb466-8"><a href="#cb466-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  47.1</span></span>
<span id="cb466-9"><a href="#cb466-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  36.4</span></span>
<span id="cb466-10"><a href="#cb466-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  33.4</span></span>
<span id="cb466-11"><a href="#cb466-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  34.2</span></span>
<span id="cb466-12"><a href="#cb466-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  43.2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-42-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-2-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb467"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a>svm_linear_spec <span class="ot">&lt;-</span> <span class="fu">svm_linear</span>() <span class="sc">|&gt;</span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because LiblineaR is the default.</span></span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>svm_linear_fit <span class="ot">&lt;-</span> svm_linear_spec <span class="sc">|&gt;</span></span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a>svm_linear_fit</span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $TypeDetail</span></span>
<span id="cb468-7"><a href="#cb468-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "L2-regularized L2-loss support vector regression primal (L2R_L2LOSS_SVR)"</span></span>
<span id="cb468-8"><a href="#cb468-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb468-9"><a href="#cb468-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Type</span></span>
<span id="cb468-10"><a href="#cb468-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 11</span></span>
<span id="cb468-11"><a href="#cb468-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb468-12"><a href="#cb468-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $W</span></span>
<span id="cb468-13"><a href="#cb468-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        cement      age     Bias</span></span>
<span id="cb468-14"><a href="#cb468-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 8.665447 5.486263 33.34299</span></span>
<span id="cb468-15"><a href="#cb468-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb468-16"><a href="#cb468-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Bias</span></span>
<span id="cb468-17"><a href="#cb468-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb468-18"><a href="#cb468-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb468-19"><a href="#cb468-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $NbClass</span></span>
<span id="cb468-20"><a href="#cb468-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb468-21"><a href="#cb468-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb468-22"><a href="#cb468-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb468-23"><a href="#cb468-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "LiblineaR"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb469"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_linear_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb469-3"><a href="#cb469-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb469-4"><a href="#cb469-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb469-5"><a href="#cb469-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  31.9</span></span>
<span id="cb469-6"><a href="#cb469-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.1</span></span>
<span id="cb469-7"><a href="#cb469-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.5</span></span>
<span id="cb469-8"><a href="#cb469-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  50.9</span></span>
<span id="cb469-9"><a href="#cb469-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  39.9</span></span>
<span id="cb469-10"><a href="#cb469-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  35.0</span></span>
<span id="cb469-11"><a href="#cb469-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.0</span></span>
<span id="cb469-12"><a href="#cb469-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  48.3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="support-vector-machine-polynomial-kernel-svm_poly-1" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-polynomial-kernel-svm_poly-1">Support Vector Machine (Polynomial Kernel) (<code>svm_poly()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-43-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-1" role="tab" aria-controls="tabset-43-1" aria-selected="true" href=""><code>kernlab</code></a></li></ul>
<div class="tab-content">
<div id="tabset-43-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-43-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>svm_poly_spec <span class="ot">&lt;-</span> <span class="fu">svm_poly</span>() <span class="sc">|&gt;</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because kernlab is the default.</span></span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>svm_poly_fit <span class="ot">&lt;-</span> svm_poly_spec <span class="sc">|&gt;</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Setting default kernel parameters</span></span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a>svm_poly_fit</span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Support Vector Machine object of class "ksvm" </span></span>
<span id="cb471-8"><a href="#cb471-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb471-9"><a href="#cb471-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SV type: eps-svr  (regression) </span></span>
<span id="cb471-10"><a href="#cb471-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span id="cb471-11"><a href="#cb471-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb471-12"><a href="#cb471-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Polynomial kernel function. </span></span>
<span id="cb471-13"><a href="#cb471-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Hyperparameters : degree =  1  scale =  1  offset =  1 </span></span>
<span id="cb471-14"><a href="#cb471-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb471-15"><a href="#cb471-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Support Vectors : 85 </span></span>
<span id="cb471-16"><a href="#cb471-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb471-17"><a href="#cb471-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Objective Function Value : -47.4495 </span></span>
<span id="cb471-18"><a href="#cb471-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training error : 0.606702</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_poly_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb472-5"><a href="#cb472-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  29.4</span></span>
<span id="cb472-6"><a href="#cb472-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  30.9</span></span>
<span id="cb472-7"><a href="#cb472-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21.7</span></span>
<span id="cb472-8"><a href="#cb472-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  47.1</span></span>
<span id="cb472-9"><a href="#cb472-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  36.4</span></span>
<span id="cb472-10"><a href="#cb472-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  33.4</span></span>
<span id="cb472-11"><a href="#cb472-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  34.2</span></span>
<span id="cb472-12"><a href="#cb472-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  43.2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="support-vector-machine-radial-basis-function-kernel-svm_rbf-1" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-radial-basis-function-kernel-svm_rbf-1">Support Vector Machine (Radial Basis Function Kernel) (<code>svm_rbf()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-44-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-1" role="tab" aria-controls="tabset-44-1" aria-selected="true" href=""><code>kernlab</code></a></li></ul>
<div class="tab-content">
<div id="tabset-44-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-44-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>svm_rbf_spec <span class="ot">&lt;-</span> <span class="fu">svm_rbf</span>() <span class="sc">|&gt;</span></span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because kernlab is the default.</span></span>
<span id="cb473-4"><a href="#cb473-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb474"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a>svm_rbf_fit <span class="ot">&lt;-</span> svm_rbf_spec <span class="sc">|&gt;</span></span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> reg_train)</span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a>svm_rbf_fit</span>
<span id="cb474-4"><a href="#cb474-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb474-5"><a href="#cb474-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb474-6"><a href="#cb474-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Support Vector Machine object of class "ksvm" </span></span>
<span id="cb474-7"><a href="#cb474-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb474-8"><a href="#cb474-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SV type: eps-svr  (regression) </span></span>
<span id="cb474-9"><a href="#cb474-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span id="cb474-10"><a href="#cb474-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb474-11"><a href="#cb474-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gaussian Radial Basis kernel function. </span></span>
<span id="cb474-12"><a href="#cb474-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Hyperparameter : sigma =  0.850174270140177 </span></span>
<span id="cb474-13"><a href="#cb474-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb474-14"><a href="#cb474-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Support Vectors : 79 </span></span>
<span id="cb474-15"><a href="#cb474-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb474-16"><a href="#cb474-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Objective Function Value : -33.0277 </span></span>
<span id="cb474-17"><a href="#cb474-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Training error : 0.28361</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(svm_rbf_fit, <span class="at">new_data =</span> reg_test)</span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred</span></span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  20.0</span></span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  41.3</span></span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  26.0</span></span>
<span id="cb475-8"><a href="#cb475-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  53.5</span></span>
<span id="cb475-9"><a href="#cb475-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  35.2</span></span>
<span id="cb475-10"><a href="#cb475-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  34.7</span></span>
<span id="cb475-11"><a href="#cb475-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  36.2</span></span>
<span id="cb475-12"><a href="#cb475-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  42.3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="censored-regression-models" class="level1">
<h1>Censored Regression Models</h1>
<section id="example-data-2" class="level2">
<h2 class="anchored" data-anchor-id="example-data-2">Example data</h2>
<p>Let’s simulate a data set using the prodlim and survival packages:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: 'survival'</span></span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from 'package:future':</span></span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     cluster</span></span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prodlim)</span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb476-10"><a href="#cb476-10" aria-hidden="true" tabindex="-1"></a>cns_data <span class="ot">&lt;-</span> </span>
<span id="cb476-11"><a href="#cb476-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">SimSurv</span>(<span class="dv">250</span>) <span class="sc">|&gt;</span> </span>
<span id="cb476-12"><a href="#cb476-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">event_time =</span> <span class="fu">Surv</span>(time, event)) <span class="sc">|&gt;</span> </span>
<span id="cb476-13"><a href="#cb476-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(event_time, X1, X2)</span>
<span id="cb476-14"><a href="#cb476-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-15"><a href="#cb476-15" aria-hidden="true" tabindex="-1"></a>cns_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(cns_data, <span class="at">prop =</span> <span class="fl">0.98</span>)</span>
<span id="cb476-16"><a href="#cb476-16" aria-hidden="true" tabindex="-1"></a>cns_split</span>
<span id="cb476-17"><a href="#cb476-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;Training/Testing/Total&gt;</span></span>
<span id="cb476-18"><a href="#cb476-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;245/5/250&gt;</span></span>
<span id="cb476-19"><a href="#cb476-19" aria-hidden="true" tabindex="-1"></a>cns_train <span class="ot">&lt;-</span> <span class="fu">training</span>(cns_split)</span>
<span id="cb476-20"><a href="#cb476-20" aria-hidden="true" tabindex="-1"></a>cns_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(cns_split)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>For some types of predictions, we need the <em>evaluation time(s)</em> for the predictions. We’ll use these three times to demonstrate:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>eval_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="models-2" class="level2">
<h2 class="anchored" data-anchor-id="models-2">Models</h2>
<section id="bagged-decision-trees-bag_tree-2" class="level3">
<h3 class="anchored" data-anchor-id="bagged-decision-trees-bag_tree-2">Bagged Decision Trees (<code>bag_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-45-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-1" role="tab" aria-controls="tabset-45-1" aria-selected="true" href=""><code>rpart</code></a></li></ul>
<div class="tab-content">
<div id="tabset-45-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-45-1-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb478"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb479"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>bag_tree_spec <span class="ot">&lt;-</span> <span class="fu">bag_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because rpart is the default.</span></span>
<span id="cb479-4"><a href="#cb479-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"censored regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a>bag_tree_fit <span class="ot">&lt;-</span> bag_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a>bag_tree_fit</span>
<span id="cb480-4"><a href="#cb480-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb480-5"><a href="#cb480-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb480-6"><a href="#cb480-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb480-7"><a href="#cb480-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bagging survival trees with 25 bootstrap replications </span></span>
<span id="cb480-8"><a href="#cb480-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb480-9"><a href="#cb480-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call: bagging.data.frame(formula = event_time ~ ., data = data, cp = ~0, </span></span>
<span id="cb480-10"><a href="#cb480-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     minsplit = ~2)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_tree_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb481-5"><a href="#cb481-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       5.65</span></span>
<span id="cb481-6"><a href="#cb481-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       4.12</span></span>
<span id="cb481-7"><a href="#cb481-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       5.03</span></span>
<span id="cb481-8"><a href="#cb481-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       5.58</span></span>
<span id="cb481-9"><a href="#cb481-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       4.88</span></span>
<span id="cb481-10"><a href="#cb481-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bag_tree_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb481-11"><a href="#cb481-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb481-12"><a href="#cb481-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb481-13"><a href="#cb481-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb481-14"><a href="#cb481-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb481-15"><a href="#cb481-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb481-16"><a href="#cb481-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb481-17"><a href="#cb481-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb481-18"><a href="#cb481-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb482"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a>bag_tree_fit <span class="sc">|&gt;</span> </span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb482-3"><a href="#cb482-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb482-4"><a href="#cb482-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb482-5"><a href="#cb482-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb482-6"><a href="#cb482-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb482-7"><a href="#cb482-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb482-8"><a href="#cb482-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb482-9"><a href="#cb482-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.993</span></span>
<span id="cb482-10"><a href="#cb482-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.864</span></span>
<span id="cb482-11"><a href="#cb482-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.638</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="boosted-decision-trees-boost_tree-2" class="level3">
<h3 class="anchored" data-anchor-id="boosted-decision-trees-boost_tree-2">Boosted Decision Trees (<code>boost_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-46-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-1" role="tab" aria-controls="tabset-46-1" aria-selected="true" href=""><code>mboost</code></a></li></ul>
<div class="tab-content">
<div id="tabset-46-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-46-1-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>boost_tree_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span> </span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"censored regression"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb484-3"><a href="#cb484-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"mboost"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">852</span>)</span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="ot">&lt;-</span> boost_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true" tabindex="-1"></a>boost_tree_fit</span>
<span id="cb485-6"><a href="#cb485-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb485-7"><a href="#cb485-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb485-8"><a href="#cb485-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb485-9"><a href="#cb485-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Model-based Boosting</span></span>
<span id="cb485-10"><a href="#cb485-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb485-11"><a href="#cb485-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb485-12"><a href="#cb485-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mboost::blackboost(formula = formula, data = data, family = family,     control = mboost::boost_control(), tree_controls = partykit::ctree_control(teststat = "quadratic",         testtype = "Teststatistic", mincriterion = 0, minsplit = 10,         minbucket = 4, maxdepth = 2, saveinfo = FALSE))</span></span>
<span id="cb485-13"><a href="#cb485-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb485-14"><a href="#cb485-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb485-15"><a href="#cb485-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Cox Partial Likelihood </span></span>
<span id="cb485-16"><a href="#cb485-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb485-17"><a href="#cb485-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loss function:  </span></span>
<span id="cb485-18"><a href="#cb485-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb485-19"><a href="#cb485-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of boosting iterations: mstop = 100 </span></span>
<span id="cb485-20"><a href="#cb485-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Step size:  0.1 </span></span>
<span id="cb485-21"><a href="#cb485-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Offset:  0 </span></span>
<span id="cb485-22"><a href="#cb485-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of baselearners:  1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb486"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb486-3"><a href="#cb486-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb486-4"><a href="#cb486-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb486-5"><a href="#cb486-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       6.51</span></span>
<span id="cb486-6"><a href="#cb486-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       3.92</span></span>
<span id="cb486-7"><a href="#cb486-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       4.51</span></span>
<span id="cb486-8"><a href="#cb486-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       7.17</span></span>
<span id="cb486-9"><a href="#cb486-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       4.51</span></span>
<span id="cb486-10"><a href="#cb486-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb486-11"><a href="#cb486-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb486-12"><a href="#cb486-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb486-13"><a href="#cb486-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb486-14"><a href="#cb486-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb486-15"><a href="#cb486-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb486-16"><a href="#cb486-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb486-17"><a href="#cb486-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb486-18"><a href="#cb486-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb486-19"><a href="#cb486-19" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost_tree_fit, <span class="at">type =</span> <span class="st">"linear_pred"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb486-20"><a href="#cb486-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb486-21"><a href="#cb486-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_linear_pred</span></span>
<span id="cb486-22"><a href="#cb486-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               &lt;dbl&gt;</span></span>
<span id="cb486-23"><a href="#cb486-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           0.00839</span></span>
<span id="cb486-24"><a href="#cb486-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          -1.14   </span></span>
<span id="cb486-25"><a href="#cb486-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          -0.823  </span></span>
<span id="cb486-26"><a href="#cb486-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4           0.229  </span></span>
<span id="cb486-27"><a href="#cb486-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5          -0.823</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb487"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a>boost_tree_fit <span class="sc">|&gt;</span> </span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb487-6"><a href="#cb487-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb487-7"><a href="#cb487-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb487-8"><a href="#cb487-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb487-9"><a href="#cb487-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.982</span></span>
<span id="cb487-10"><a href="#cb487-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.877</span></span>
<span id="cb487-11"><a href="#cb487-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.657</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="decision-tree-decision_tree-2" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree-decision_tree-2">Decision Tree (<code>decision_tree()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-47-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-1" role="tab" aria-controls="tabset-47-1" aria-selected="true" href=""><code>rpart</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-2" role="tab" aria-controls="tabset-47-2" aria-selected="false" href=""><code>partykit</code></a></li></ul>
<div class="tab-content">
<div id="tabset-47-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-47-1-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb488"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb489"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We don't need to set the engine because rpart is the default.</span></span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"censored regression"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb490"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb490-4"><a href="#cb490-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb490-5"><a href="#cb490-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-6"><a href="#cb490-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $rpart</span></span>
<span id="cb490-7"><a href="#cb490-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; n= 245 </span></span>
<span id="cb490-8"><a href="#cb490-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-9"><a href="#cb490-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; node), split, n, deviance, yval</span></span>
<span id="cb490-10"><a href="#cb490-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       * denotes terminal node</span></span>
<span id="cb490-11"><a href="#cb490-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-12"><a href="#cb490-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1) root 245 329.03530 1.0000000  </span></span>
<span id="cb490-13"><a href="#cb490-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2) X2&lt; -0.09937043 110 119.05180 0.5464982  </span></span>
<span id="cb490-14"><a href="#cb490-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      4) X2&lt; -0.9419799 41  42.43138 0.3153769  </span></span>
<span id="cb490-15"><a href="#cb490-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        8) X1&lt; 0.5 20  12.93725 0.1541742 *</span></span>
<span id="cb490-16"><a href="#cb490-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        9) X1&gt;=0.5 21  23.29519 0.5656502 *</span></span>
<span id="cb490-17"><a href="#cb490-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      5) X2&gt;=-0.9419799 69  67.76223 0.7336317 *</span></span>
<span id="cb490-18"><a href="#cb490-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3) X2&gt;=-0.09937043 135 157.14990 1.7319010  </span></span>
<span id="cb490-19"><a href="#cb490-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      6) X1&lt; 0.5 79  66.30972 1.2572690 *</span></span>
<span id="cb490-20"><a href="#cb490-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      7) X1&gt;=0.5 56  69.62652 3.0428230  </span></span>
<span id="cb490-21"><a href="#cb490-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       14) X2&lt; 1.222057 44  40.33335 2.5072040 *</span></span>
<span id="cb490-22"><a href="#cb490-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       15) X2&gt;=1.222057 12  17.95790 6.3934130 *</span></span>
<span id="cb490-23"><a href="#cb490-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-24"><a href="#cb490-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $survfit</span></span>
<span id="cb490-25"><a href="#cb490-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-26"><a href="#cb490-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call: prodlim::prodlim(formula = form, data = data)</span></span>
<span id="cb490-27"><a href="#cb490-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Stratified Kaplan-Meier estimator for the conditional event time survival function</span></span>
<span id="cb490-28"><a href="#cb490-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Discrete predictor variable: rpartFactor (0.154174164904031, 0.565650228981439, 0.733631734872791, 1.25726850344687, 2.50720371146533, 6.39341334321542)</span></span>
<span id="cb490-29"><a href="#cb490-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-30"><a href="#cb490-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Right-censored response of a survival model</span></span>
<span id="cb490-31"><a href="#cb490-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-32"><a href="#cb490-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; No.Observations: 245 </span></span>
<span id="cb490-33"><a href="#cb490-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-34"><a href="#cb490-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pattern:</span></span>
<span id="cb490-35"><a href="#cb490-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Freq</span></span>
<span id="cb490-36"><a href="#cb490-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  event          161 </span></span>
<span id="cb490-37"><a href="#cb490-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  right.censored 84  </span></span>
<span id="cb490-38"><a href="#cb490-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-39"><a href="#cb490-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $levels</span></span>
<span id="cb490-40"><a href="#cb490-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "0.154174164904031" "0.565650228981439" "0.733631734872791"</span></span>
<span id="cb490-41"><a href="#cb490-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4] "1.25726850344687"  "2.50720371146533"  "6.39341334321542" </span></span>
<span id="cb490-42"><a href="#cb490-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb490-43"><a href="#cb490-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb490-44"><a href="#cb490-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "pecRpart"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb491"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1.26</span></span>
<span id="cb491-6"><a href="#cb491-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       2.51</span></span>
<span id="cb491-7"><a href="#cb491-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       1.26</span></span>
<span id="cb491-8"><a href="#cb491-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       1.26</span></span>
<span id="cb491-9"><a href="#cb491-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       1.26</span></span>
<span id="cb491-10"><a href="#cb491-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb491-11"><a href="#cb491-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb491-12"><a href="#cb491-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb491-13"><a href="#cb491-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb491-14"><a href="#cb491-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb491-15"><a href="#cb491-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb491-16"><a href="#cb491-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb491-17"><a href="#cb491-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb491-18"><a href="#cb491-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="sc">|&gt;</span> </span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb492-3"><a href="#cb492-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb492-4"><a href="#cb492-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb492-5"><a href="#cb492-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb492-6"><a href="#cb492-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb492-7"><a href="#cb492-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb492-8"><a href="#cb492-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb492-9"><a href="#cb492-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.987</span></span>
<span id="cb492-10"><a href="#cb492-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.854</span></span>
<span id="cb492-11"><a href="#cb492-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.634</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-47-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-47-2-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb494"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a>decision_tree_spec <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb494-3"><a href="#cb494-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"censored regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb494-4"><a href="#cb494-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"partykit"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="ot">&lt;-</span> decision_tree_spec <span class="sc">|&gt;</span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a>decision_tree_fit</span>
<span id="cb495-4"><a href="#cb495-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb495-5"><a href="#cb495-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb495-6"><a href="#cb495-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb495-7"><a href="#cb495-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model formula:</span></span>
<span id="cb495-8"><a href="#cb495-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; event_time ~ X1 + X2</span></span>
<span id="cb495-9"><a href="#cb495-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb495-10"><a href="#cb495-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitted party:</span></span>
<span id="cb495-11"><a href="#cb495-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb495-12"><a href="#cb495-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] X2 &lt;= -0.36159</span></span>
<span id="cb495-13"><a href="#cb495-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] X1 &lt;= 0: 13.804 (n = 41)</span></span>
<span id="cb495-14"><a href="#cb495-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [4] X1 &gt; 0: 8.073 (n = 47)</span></span>
<span id="cb495-15"><a href="#cb495-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [5] X2 &gt; -0.36159</span></span>
<span id="cb495-16"><a href="#cb495-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [6] X1 &lt;= 0: 6.274 (n = 89)</span></span>
<span id="cb495-17"><a href="#cb495-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [7] X1 &gt; 0</span></span>
<span id="cb495-18"><a href="#cb495-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [8] X2 &lt;= 0.56098: 5.111 (n = 39)</span></span>
<span id="cb495-19"><a href="#cb495-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [9] X2 &gt; 0.56098: 2.713 (n = 29)</span></span>
<span id="cb495-20"><a href="#cb495-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb495-21"><a href="#cb495-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of inner nodes:    4</span></span>
<span id="cb495-22"><a href="#cb495-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of terminal nodes: 5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb496-3"><a href="#cb496-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb496-4"><a href="#cb496-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb496-5"><a href="#cb496-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       6.27</span></span>
<span id="cb496-6"><a href="#cb496-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       5.11</span></span>
<span id="cb496-7"><a href="#cb496-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       6.27</span></span>
<span id="cb496-8"><a href="#cb496-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       6.27</span></span>
<span id="cb496-9"><a href="#cb496-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       6.27</span></span>
<span id="cb496-10"><a href="#cb496-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(decision_tree_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb496-11"><a href="#cb496-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb496-12"><a href="#cb496-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb496-13"><a href="#cb496-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb496-14"><a href="#cb496-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb496-15"><a href="#cb496-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb496-16"><a href="#cb496-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb496-17"><a href="#cb496-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb496-18"><a href="#cb496-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb497"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a>decision_tree_fit <span class="sc">|&gt;</span> </span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb497-4"><a href="#cb497-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb497-5"><a href="#cb497-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb497-6"><a href="#cb497-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb497-7"><a href="#cb497-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb497-8"><a href="#cb497-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb497-9"><a href="#cb497-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.989</span></span>
<span id="cb497-10"><a href="#cb497-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.871</span></span>
<span id="cb497-11"><a href="#cb497-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.649</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="proportional-hazards-proportional_hazards" class="level3">
<h3 class="anchored" data-anchor-id="proportional-hazards-proportional_hazards">Proportional Hazards (<code>proportional_hazards()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-48-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-1" role="tab" aria-controls="tabset-48-1" aria-selected="true" href=""><code>survival</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-2" role="tab" aria-controls="tabset-48-2" aria-selected="false" href=""><code>glmnet</code></a></li></ul>
<div class="tab-content">
<div id="tabset-48-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-48-1-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb499"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because survival is the default.</span></span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true" tabindex="-1"></a>proportional_hazards_spec <span class="ot">&lt;-</span> <span class="fu">proportional_hazards</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>proportional_hazards_fit <span class="ot">&lt;-</span> proportional_hazards_spec <span class="sc">|&gt;</span></span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true" tabindex="-1"></a>proportional_hazards_fit</span>
<span id="cb500-4"><a href="#cb500-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb500-5"><a href="#cb500-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb500-6"><a href="#cb500-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb500-7"><a href="#cb500-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; survival::coxph(formula = event_time ~ ., data = data, model = TRUE, </span></span>
<span id="cb500-8"><a href="#cb500-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     x = TRUE)</span></span>
<span id="cb500-9"><a href="#cb500-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb500-10"><a href="#cb500-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       coef exp(coef) se(coef)     z        p</span></span>
<span id="cb500-11"><a href="#cb500-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X1 0.99547   2.70599  0.16799 5.926 3.11e-09</span></span>
<span id="cb500-12"><a href="#cb500-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2 0.91398   2.49422  0.09566 9.555  &lt; 2e-16</span></span>
<span id="cb500-13"><a href="#cb500-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb500-14"><a href="#cb500-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Likelihood ratio test=106.8  on 2 df, p=&lt; 2.2e-16</span></span>
<span id="cb500-15"><a href="#cb500-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; n= 245, number of events= 161</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb501"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(proportional_hazards_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       7.87</span></span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       4.16</span></span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       4.62</span></span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       5.19</span></span>
<span id="cb501-9"><a href="#cb501-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       4.41</span></span>
<span id="cb501-10"><a href="#cb501-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(proportional_hazards_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb501-11"><a href="#cb501-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb501-12"><a href="#cb501-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb501-13"><a href="#cb501-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb501-14"><a href="#cb501-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb501-15"><a href="#cb501-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb501-16"><a href="#cb501-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb501-17"><a href="#cb501-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb501-18"><a href="#cb501-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb501-19"><a href="#cb501-19" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(proportional_hazards_fit, <span class="at">type =</span> <span class="st">"linear_pred"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb501-20"><a href="#cb501-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb501-21"><a href="#cb501-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_linear_pred</span></span>
<span id="cb501-22"><a href="#cb501-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               &lt;dbl&gt;</span></span>
<span id="cb501-23"><a href="#cb501-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1            -0.111</span></span>
<span id="cb501-24"><a href="#cb501-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2            -1.49 </span></span>
<span id="cb501-25"><a href="#cb501-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3            -1.27 </span></span>
<span id="cb501-26"><a href="#cb501-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4            -1.02 </span></span>
<span id="cb501-27"><a href="#cb501-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5            -1.37</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb502"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a>proportional_hazards_fit <span class="sc">|&gt;</span> </span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb502-3"><a href="#cb502-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb502-4"><a href="#cb502-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb502-5"><a href="#cb502-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb502-6"><a href="#cb502-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb502-7"><a href="#cb502-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb502-8"><a href="#cb502-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb502-9"><a href="#cb502-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.985</span></span>
<span id="cb502-10"><a href="#cb502-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.909</span></span>
<span id="cb502-11"><a href="#cb502-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.750</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-48-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-48-2-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb503"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a>proportional_hazards_spec <span class="ot">&lt;-</span> <span class="fu">proportional_hazards</span>(<span class="at">penalty =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb505"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a>proportional_hazards_fit <span class="ot">&lt;-</span> proportional_hazards_spec <span class="sc">|&gt;</span></span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a>proportional_hazards_fit</span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb505-5"><a href="#cb505-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb505-6"><a href="#cb505-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb505-7"><a href="#cb505-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glmnet::glmnet(x = data_obj$x, y = data_obj$y, family = "cox",      weights = weights, alpha = alpha, lambda = lambda) </span></span>
<span id="cb505-8"><a href="#cb505-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb505-9"><a href="#cb505-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Df %Dev  Lambda</span></span>
<span id="cb505-10"><a href="#cb505-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0 0.00 0.39700</span></span>
<span id="cb505-11"><a href="#cb505-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   1 0.82 0.36170</span></span>
<span id="cb505-12"><a href="#cb505-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   1 1.51 0.32960</span></span>
<span id="cb505-13"><a href="#cb505-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   1 2.07 0.30030</span></span>
<span id="cb505-14"><a href="#cb505-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   1 2.54 0.27360</span></span>
<span id="cb505-15"><a href="#cb505-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   1 2.94 0.24930</span></span>
<span id="cb505-16"><a href="#cb505-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   2 3.28 0.22720</span></span>
<span id="cb505-17"><a href="#cb505-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   2 3.95 0.20700</span></span>
<span id="cb505-18"><a href="#cb505-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   2 4.50 0.18860</span></span>
<span id="cb505-19"><a href="#cb505-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  2 4.95 0.17180</span></span>
<span id="cb505-20"><a href="#cb505-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  2 5.33 0.15660</span></span>
<span id="cb505-21"><a href="#cb505-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  2 5.65 0.14270</span></span>
<span id="cb505-22"><a href="#cb505-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13  2 5.91 0.13000</span></span>
<span id="cb505-23"><a href="#cb505-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14  2 6.13 0.11840</span></span>
<span id="cb505-24"><a href="#cb505-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15  2 6.31 0.10790</span></span>
<span id="cb505-25"><a href="#cb505-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16  2 6.46 0.09833</span></span>
<span id="cb505-26"><a href="#cb505-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17  2 6.58 0.08960</span></span>
<span id="cb505-27"><a href="#cb505-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18  2 6.69 0.08164</span></span>
<span id="cb505-28"><a href="#cb505-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19  2 6.77 0.07439</span></span>
<span id="cb505-29"><a href="#cb505-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20  2 6.85 0.06778</span></span>
<span id="cb505-30"><a href="#cb505-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21  2 6.91 0.06176</span></span>
<span id="cb505-31"><a href="#cb505-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22  2 6.96 0.05627</span></span>
<span id="cb505-32"><a href="#cb505-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23  2 7.00 0.05127</span></span>
<span id="cb505-33"><a href="#cb505-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24  2 7.03 0.04672</span></span>
<span id="cb505-34"><a href="#cb505-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25  2 7.06 0.04257</span></span>
<span id="cb505-35"><a href="#cb505-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26  2 7.08 0.03879</span></span>
<span id="cb505-36"><a href="#cb505-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27  2 7.10 0.03534</span></span>
<span id="cb505-37"><a href="#cb505-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28  2 7.12 0.03220</span></span>
<span id="cb505-38"><a href="#cb505-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29  2 7.13 0.02934</span></span>
<span id="cb505-39"><a href="#cb505-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30  2 7.14 0.02673</span></span>
<span id="cb505-40"><a href="#cb505-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 31  2 7.15 0.02436</span></span>
<span id="cb505-41"><a href="#cb505-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32  2 7.16 0.02219</span></span>
<span id="cb505-42"><a href="#cb505-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33  2 7.17 0.02022</span></span>
<span id="cb505-43"><a href="#cb505-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 34  2 7.17 0.01843</span></span>
<span id="cb505-44"><a href="#cb505-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 35  2 7.18 0.01679</span></span>
<span id="cb505-45"><a href="#cb505-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 36  2 7.18 0.01530</span></span>
<span id="cb505-46"><a href="#cb505-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37  2 7.18 0.01394</span></span>
<span id="cb505-47"><a href="#cb505-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 38  2 7.19 0.01270</span></span>
<span id="cb505-48"><a href="#cb505-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 39  2 7.19 0.01157</span></span>
<span id="cb505-49"><a href="#cb505-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40  2 7.19 0.01054</span></span>
<span id="cb505-50"><a href="#cb505-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 41  2 7.19 0.00961</span></span>
<span id="cb505-51"><a href="#cb505-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 42  2 7.19 0.00875</span></span>
<span id="cb505-52"><a href="#cb505-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The training data has been saved for prediction.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(proportional_hazards_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb506-5"><a href="#cb506-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       7.80</span></span>
<span id="cb506-6"><a href="#cb506-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       4.21</span></span>
<span id="cb506-7"><a href="#cb506-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       4.63</span></span>
<span id="cb506-8"><a href="#cb506-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       5.18</span></span>
<span id="cb506-9"><a href="#cb506-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       4.42</span></span>
<span id="cb506-10"><a href="#cb506-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(proportional_hazards_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb506-11"><a href="#cb506-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb506-12"><a href="#cb506-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb506-13"><a href="#cb506-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb506-14"><a href="#cb506-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb506-15"><a href="#cb506-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb506-16"><a href="#cb506-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb506-17"><a href="#cb506-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb506-18"><a href="#cb506-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb506-19"><a href="#cb506-19" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(proportional_hazards_fit, <span class="at">type =</span> <span class="st">"linear_pred"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb506-20"><a href="#cb506-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb506-21"><a href="#cb506-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_linear_pred</span></span>
<span id="cb506-22"><a href="#cb506-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               &lt;dbl&gt;</span></span>
<span id="cb506-23"><a href="#cb506-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1            -0.108</span></span>
<span id="cb506-24"><a href="#cb506-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2            -1.43 </span></span>
<span id="cb506-25"><a href="#cb506-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3            -1.23 </span></span>
<span id="cb506-26"><a href="#cb506-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4            -0.993</span></span>
<span id="cb506-27"><a href="#cb506-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5            -1.33</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb507"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a>proportional_hazards_fit <span class="sc">|&gt;</span> </span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb507-5"><a href="#cb507-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb507-6"><a href="#cb507-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb507-7"><a href="#cb507-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb507-8"><a href="#cb507-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb507-9"><a href="#cb507-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.984</span></span>
<span id="cb507-10"><a href="#cb507-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.906</span></span>
<span id="cb507-11"><a href="#cb507-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.743</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="random-forests-rand_forest-2" class="level3">
<h3 class="anchored" data-anchor-id="random-forests-rand_forest-2">Random Forests (<code>rand_forest()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-49-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-1" role="tab" aria-controls="tabset-49-1" aria-selected="true" href=""><code>aorsf</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-2" role="tab" aria-controls="tabset-49-2" aria-selected="false" href=""><code>partykit</code></a></li></ul>
<div class="tab-content">
<div id="tabset-49-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-49-1-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb509"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"censored regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"aorsf"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb510"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb510-3"><a href="#cb510-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb510-4"><a href="#cb510-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb510-5"><a href="#cb510-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb510-6"><a href="#cb510-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb510-7"><a href="#cb510-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb510-8"><a href="#cb510-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------- Oblique random survival forest</span></span>
<span id="cb510-9"><a href="#cb510-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb510-10"><a href="#cb510-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Linear combinations: Accelerated Cox regression</span></span>
<span id="cb510-11"><a href="#cb510-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           N observations: 245</span></span>
<span id="cb510-12"><a href="#cb510-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 N events: 161</span></span>
<span id="cb510-13"><a href="#cb510-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  N trees: 500</span></span>
<span id="cb510-14"><a href="#cb510-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       N predictors total: 2</span></span>
<span id="cb510-15"><a href="#cb510-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    N predictors per node: 2</span></span>
<span id="cb510-16"><a href="#cb510-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Average leaves per tree: 12.85</span></span>
<span id="cb510-17"><a href="#cb510-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Min observations in leaf: 5</span></span>
<span id="cb510-18"><a href="#cb510-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Min events in leaf: 1</span></span>
<span id="cb510-19"><a href="#cb510-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           OOB stat value: 0.70</span></span>
<span id="cb510-20"><a href="#cb510-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            OOB stat type: Harrell's C-index</span></span>
<span id="cb510-21"><a href="#cb510-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Variable importance: anova</span></span>
<span id="cb510-22"><a href="#cb510-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb510-23"><a href="#cb510-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb511"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb511-4"><a href="#cb511-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb511-5"><a href="#cb511-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       5.93</span></span>
<span id="cb511-6"><a href="#cb511-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       3.85</span></span>
<span id="cb511-7"><a href="#cb511-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       4.41</span></span>
<span id="cb511-8"><a href="#cb511-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       5.43</span></span>
<span id="cb511-9"><a href="#cb511-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       4.34</span></span>
<span id="cb511-10"><a href="#cb511-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb511-11"><a href="#cb511-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb511-12"><a href="#cb511-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb511-13"><a href="#cb511-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb511-14"><a href="#cb511-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb511-15"><a href="#cb511-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb511-16"><a href="#cb511-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb511-17"><a href="#cb511-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb511-18"><a href="#cb511-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="sc">|&gt;</span> </span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb512-7"><a href="#cb512-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb512-8"><a href="#cb512-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb512-9"><a href="#cb512-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.999</span></span>
<span id="cb512-10"><a href="#cb512-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.873</span></span>
<span id="cb512-11"><a href="#cb512-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.627</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-49-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-49-2-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb513"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We need to set the mode since this model works with multiple modes.</span></span>
<span id="cb514-3"><a href="#cb514-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"censored regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb514-4"><a href="#cb514-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"partykit"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb515"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">89</span>)</span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The print method has a lot of output:</p>
<details>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">print</span>(rand_forest_fit))[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>] <span class="sc">|&gt;</span> <span class="fu">cat</span>(<span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb516-3"><a href="#cb516-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb516-4"><a href="#cb516-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes</span></span>
<span id="cb516-5"><a href="#cb516-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[1]]</span></span>
<span id="cb516-6"><a href="#cb516-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb516-7"><a href="#cb516-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V3 &lt;= -0.16072</span></span>
<span id="cb516-8"><a href="#cb516-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V2 &lt;= 0</span></span>
<span id="cb516-9"><a href="#cb516-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [4] V3 &lt;= -1.68226 *</span></span>
<span id="cb516-10"><a href="#cb516-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V3 &gt; -1.68226</span></span>
<span id="cb516-11"><a href="#cb516-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [6] V3 &lt;= -0.65952 *</span></span>
<span id="cb516-12"><a href="#cb516-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [7] V3 &gt; -0.65952 *</span></span>
<span id="cb516-13"><a href="#cb516-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [8] V2 &gt; 0</span></span>
<span id="cb516-14"><a href="#cb516-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [9] V3 &lt;= -0.98243 *</span></span>
<span id="cb516-15"><a href="#cb516-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [10] V3 &gt; -0.98243</span></span>
<span id="cb516-16"><a href="#cb516-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [11] V3 &lt;= -0.67216 *</span></span>
<span id="cb516-17"><a href="#cb516-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [12] V3 &gt; -0.67216 *</span></span>
<span id="cb516-18"><a href="#cb516-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [13] V3 &gt; -0.16072</span></span>
<span id="cb516-19"><a href="#cb516-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [14] V2 &lt;= 0</span></span>
<span id="cb516-20"><a href="#cb516-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [15] V3 &lt;= 0.95981</span></span>
<span id="cb516-21"><a href="#cb516-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [16] V3 &lt;= 0.3117</span></span>
<span id="cb516-22"><a href="#cb516-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [17] V3 &lt;= 0.09688 *</span></span>
<span id="cb516-23"><a href="#cb516-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [18] V3 &gt; 0.09688 *</span></span>
<span id="cb516-24"><a href="#cb516-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [19] V3 &gt; 0.3117</span></span>
<span id="cb516-25"><a href="#cb516-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [20] V3 &lt;= 0.40845 *</span></span>
<span id="cb516-26"><a href="#cb516-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [21] V3 &gt; 0.40845 *</span></span>
<span id="cb516-27"><a href="#cb516-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [22] V3 &gt; 0.95981 *</span></span>
<span id="cb516-28"><a href="#cb516-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [23] V2 &gt; 0</span></span>
<span id="cb516-29"><a href="#cb516-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [24] V3 &lt;= 0.56098 *</span></span>
<span id="cb516-30"><a href="#cb516-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [25] V3 &gt; 0.56098 *</span></span>
<span id="cb516-31"><a href="#cb516-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb516-32"><a href="#cb516-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[2]]</span></span>
<span id="cb516-33"><a href="#cb516-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb516-34"><a href="#cb516-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V3 &lt;= -0.36618</span></span>
<span id="cb516-35"><a href="#cb516-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V2 &lt;= 0</span></span>
<span id="cb516-36"><a href="#cb516-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [4] V3 &lt;= -1.19881 *</span></span>
<span id="cb516-37"><a href="#cb516-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V3 &gt; -1.19881 *</span></span>
<span id="cb516-38"><a href="#cb516-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [6] V2 &gt; 0</span></span>
<span id="cb516-39"><a href="#cb516-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [7] V3 &lt;= -1.18263 *</span></span>
<span id="cb516-40"><a href="#cb516-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [8] V3 &gt; -1.18263</span></span>
<span id="cb516-41"><a href="#cb516-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [9] V3 &lt;= -0.55449 *</span></span>
<span id="cb516-42"><a href="#cb516-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [10] V3 &gt; -0.55449 *</span></span>
<span id="cb516-43"><a href="#cb516-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [11] V3 &gt; -0.36618</span></span>
<span id="cb516-44"><a href="#cb516-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [12] V2 &lt;= 0</span></span>
<span id="cb516-45"><a href="#cb516-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [13] V3 &lt;= 0.3117</span></span>
<span id="cb516-46"><a href="#cb516-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [14] V3 &lt;= -0.01851 *</span></span>
<span id="cb516-47"><a href="#cb516-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [15] V3 &gt; -0.01851 *</span></span>
<span id="cb516-48"><a href="#cb516-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [16] V3 &gt; 0.3117</span></span>
<span id="cb516-49"><a href="#cb516-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [17] V3 &lt;= 0.85976 *</span></span>
<span id="cb516-50"><a href="#cb516-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [18] V3 &gt; 0.85976 *</span></span>
<span id="cb516-51"><a href="#cb516-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [19] V2 &gt; 0</span></span>
<span id="cb516-52"><a href="#cb516-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [20] V3 &lt;= -0.04369 *</span></span>
<span id="cb516-53"><a href="#cb516-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [21] V3 &gt; -0.04369</span></span>
<span id="cb516-54"><a href="#cb516-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [22] V3 &lt;= 0.56098 *</span></span>
<span id="cb516-55"><a href="#cb516-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [23] V3 &gt; 0.56098</span></span>
<span id="cb516-56"><a href="#cb516-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [24] V3 &lt;= 1.22094 *</span></span>
<span id="cb516-57"><a href="#cb516-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [25] V3 &gt; 1.22094 *</span></span>
<span id="cb516-58"><a href="#cb516-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb516-59"><a href="#cb516-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[3]]</span></span>
<span id="cb516-60"><a href="#cb516-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb516-61"><a href="#cb516-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V3 &lt;= -0.46092</span></span>
<span id="cb516-62"><a href="#cb516-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V2 &lt;= 0</span></span>
<span id="cb516-63"><a href="#cb516-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [4] V3 &lt;= -1.65465 *</span></span>
<span id="cb516-64"><a href="#cb516-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V3 &gt; -1.65465 *</span></span>
<span id="cb516-65"><a href="#cb516-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [6] V2 &gt; 0</span></span>
<span id="cb516-66"><a href="#cb516-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [7] V3 &lt;= -1.36941 *</span></span>
<span id="cb516-67"><a href="#cb516-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [8] V3 &gt; -1.36941</span></span>
<span id="cb516-68"><a href="#cb516-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [9] V3 &lt;= -0.83366 *</span></span>
<span id="cb516-69"><a href="#cb516-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [10] V3 &gt; -0.83366 *</span></span>
<span id="cb516-70"><a href="#cb516-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [11] V3 &gt; -0.46092</span></span>
<span id="cb516-71"><a href="#cb516-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [12] V2 &lt;= 0</span></span>
<span id="cb516-72"><a href="#cb516-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [13] V3 &lt;= -0.01851 *</span></span>
<span id="cb516-73"><a href="#cb516-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [14] V3 &gt; -0.01851</span></span>
<span id="cb516-74"><a href="#cb516-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [15] V3 &lt;= 0.22967 *</span></span>
<span id="cb516-75"><a href="#cb516-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [16] V3 &gt; 0.22967</span></span>
<span id="cb516-76"><a href="#cb516-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [17] V3 &lt;= 0.95368</span></span>
<span id="cb516-77"><a href="#cb516-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [18] V3 &lt;= 0.68292 *</span></span>
<span id="cb516-78"><a href="#cb516-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   |   [19] V3 &gt; 0.68292 *</span></span>
<span id="cb516-79"><a href="#cb516-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   |   [20] V3 &gt; 0.95368 *</span></span>
<span id="cb516-80"><a href="#cb516-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [21] V2 &gt; 0</span></span>
<span id="cb516-81"><a href="#cb516-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [22] V3 &lt;= 0.15595 *</span></span>
<span id="cb516-82"><a href="#cb516-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [23] V3 &gt; 0.15595</span></span>
<span id="cb516-83"><a href="#cb516-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [24] V3 &lt;= 0.51117 *</span></span>
<span id="cb516-84"><a href="#cb516-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [25] V3 &gt; 0.51117 *</span></span>
<span id="cb516-85"><a href="#cb516-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb516-86"><a href="#cb516-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $nodes[[4]]</span></span>
<span id="cb516-87"><a href="#cb516-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] root</span></span>
<span id="cb516-88"><a href="#cb516-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [2] V3 &lt;= -0.10421</span></span>
<span id="cb516-89"><a href="#cb516-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [3] V2 &lt;= 0</span></span>
<span id="cb516-90"><a href="#cb516-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [4] V3 &lt;= -0.96818 *</span></span>
<span id="cb516-91"><a href="#cb516-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [5] V3 &gt; -0.96818</span></span>
<span id="cb516-92"><a href="#cb516-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [6] V3 &lt;= -0.64682 *</span></span>
<span id="cb516-93"><a href="#cb516-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [7] V3 &gt; -0.64682 *</span></span>
<span id="cb516-94"><a href="#cb516-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [8] V2 &gt; 0</span></span>
<span id="cb516-95"><a href="#cb516-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [9] V3 &lt;= -0.83366 *</span></span>
<span id="cb516-96"><a href="#cb516-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [10] V3 &gt; -0.83366 *</span></span>
<span id="cb516-97"><a href="#cb516-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   [11] V3 &gt; -0.10421</span></span>
<span id="cb516-98"><a href="#cb516-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   [12] V2 &lt;= 0</span></span>
<span id="cb516-99"><a href="#cb516-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [13] V3 &lt;= 0.14347 *</span></span>
<span id="cb516-100"><a href="#cb516-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   [14] V3 &gt; 0.14347</span></span>
<span id="cb516-101"><a href="#cb516-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; |   |   |   |   [15] V3 &lt;= 1.20345</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb517"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb517-5"><a href="#cb517-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       5.22</span></span>
<span id="cb517-6"><a href="#cb517-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       4.12</span></span>
<span id="cb517-7"><a href="#cb517-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       3.87</span></span>
<span id="cb517-8"><a href="#cb517-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       4.82</span></span>
<span id="cb517-9"><a href="#cb517-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       3.87</span></span>
<span id="cb517-10"><a href="#cb517-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb517-11"><a href="#cb517-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb517-12"><a href="#cb517-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb517-13"><a href="#cb517-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb517-14"><a href="#cb517-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb517-15"><a href="#cb517-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb517-16"><a href="#cb517-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb517-17"><a href="#cb517-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb517-18"><a href="#cb517-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb518"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="sc">|&gt;</span> </span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb518-4"><a href="#cb518-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb518-5"><a href="#cb518-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb518-6"><a href="#cb518-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb518-7"><a href="#cb518-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb518-8"><a href="#cb518-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb518-9"><a href="#cb518-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          1    </span></span>
<span id="cb518-10"><a href="#cb518-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.870</span></span>
<span id="cb518-11"><a href="#cb518-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.594</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="parametric-survival-models-survival_reg" class="level3">
<h3 class="anchored" data-anchor-id="parametric-survival-models-survival_reg">Parametric Survival Models (<code>survival_reg()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-50-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-1" role="tab" aria-controls="tabset-50-1" aria-selected="true" href=""><code>survival</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-2" role="tab" aria-controls="tabset-50-2" aria-selected="false" href=""><code>flexsurv</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-3" role="tab" aria-controls="tabset-50-3" aria-selected="false" href=""><code>flexsurvspline</code></a></li></ul>
<div class="tab-content">
<div id="tabset-50-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-50-1-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb519"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't need to set the engine because survival is the default.</span></span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true" tabindex="-1"></a>survival_reg_spec <span class="ot">&lt;-</span> <span class="fu">survival_reg</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb521"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a>survival_reg_fit <span class="ot">&lt;-</span> survival_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a>survival_reg_fit</span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb521-5"><a href="#cb521-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb521-6"><a href="#cb521-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb521-7"><a href="#cb521-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; survival::survreg(formula = event_time ~ ., data = data, model = TRUE)</span></span>
<span id="cb521-8"><a href="#cb521-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb521-9"><a href="#cb521-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb521-10"><a href="#cb521-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          X1          X2 </span></span>
<span id="cb521-11"><a href="#cb521-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   2.2351722  -0.4648296  -0.4222887 </span></span>
<span id="cb521-12"><a href="#cb521-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb521-13"><a href="#cb521-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Scale= 0.4728442 </span></span>
<span id="cb521-14"><a href="#cb521-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb521-15"><a href="#cb521-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglik(model)= -427.4   Loglik(intercept only)= -481.3</span></span>
<span id="cb521-16"><a href="#cb521-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Chisq= 107.73 on 2 degrees of freedom, p= &lt;2e-16 </span></span>
<span id="cb521-17"><a href="#cb521-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; n= 245</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       8.88</span></span>
<span id="cb522-6"><a href="#cb522-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       4.67</span></span>
<span id="cb522-7"><a href="#cb522-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       5.20</span></span>
<span id="cb522-8"><a href="#cb522-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       5.83</span></span>
<span id="cb522-9"><a href="#cb522-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       4.97</span></span>
<span id="cb522-10"><a href="#cb522-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb522-11"><a href="#cb522-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb522-12"><a href="#cb522-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb522-13"><a href="#cb522-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb522-14"><a href="#cb522-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-15"><a href="#cb522-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-16"><a href="#cb522-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-17"><a href="#cb522-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-18"><a href="#cb522-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-19"><a href="#cb522-19" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"hazard"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb522-20"><a href="#cb522-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb522-21"><a href="#cb522-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb522-22"><a href="#cb522-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb522-23"><a href="#cb522-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-24"><a href="#cb522-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-25"><a href="#cb522-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-26"><a href="#cb522-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-27"><a href="#cb522-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb522-28"><a href="#cb522-28" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"linear_pred"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb522-29"><a href="#cb522-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb522-30"><a href="#cb522-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_linear_pred</span></span>
<span id="cb522-31"><a href="#cb522-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               &lt;dbl&gt;</span></span>
<span id="cb522-32"><a href="#cb522-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              2.18</span></span>
<span id="cb522-33"><a href="#cb522-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2              1.54</span></span>
<span id="cb522-34"><a href="#cb522-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3              1.65</span></span>
<span id="cb522-35"><a href="#cb522-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4              1.76</span></span>
<span id="cb522-36"><a href="#cb522-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5              1.60</span></span>
<span id="cb522-37"><a href="#cb522-37" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"quantile"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb522-38"><a href="#cb522-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb522-39"><a href="#cb522-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_quantile</span></span>
<span id="cb522-40"><a href="#cb522-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;qtls(9)&gt;</span></span>
<span id="cb522-41"><a href="#cb522-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         [7.47]</span></span>
<span id="cb522-42"><a href="#cb522-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         [3.92]</span></span>
<span id="cb522-43"><a href="#cb522-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         [4.37]</span></span>
<span id="cb522-44"><a href="#cb522-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4          [4.9]</span></span>
<span id="cb522-45"><a href="#cb522-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5         [4.18]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb523"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>survival_reg_fit <span class="sc">|&gt;</span> </span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb523-5"><a href="#cb523-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb523-6"><a href="#cb523-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb523-7"><a href="#cb523-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb523-8"><a href="#cb523-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb523-9"><a href="#cb523-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.990</span></span>
<span id="cb523-10"><a href="#cb523-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.904</span></span>
<span id="cb523-11"><a href="#cb523-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.743</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-50-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-50-2-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb525"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a>survival_reg_spec <span class="ot">&lt;-</span> <span class="fu">survival_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"flexsurv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a>survival_reg_fit <span class="ot">&lt;-</span> survival_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a>survival_reg_fit</span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb526-7"><a href="#cb526-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; flexsurv::flexsurvreg(formula = event_time ~ ., data = data, </span></span>
<span id="cb526-8"><a href="#cb526-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     dist = "weibull")</span></span>
<span id="cb526-9"><a href="#cb526-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb526-10"><a href="#cb526-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates: </span></span>
<span id="cb526-11"><a href="#cb526-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        data mean  est       L95%      U95%      se        exp(est)  L95%    </span></span>
<span id="cb526-12"><a href="#cb526-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape        NA    2.11486   1.87774   2.38192   0.12832        NA        NA</span></span>
<span id="cb526-13"><a href="#cb526-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale        NA    9.34809   8.38852  10.41743   0.51658        NA        NA</span></span>
<span id="cb526-14"><a href="#cb526-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X1      0.46939   -0.46483  -0.61347  -0.31619   0.07584   0.62824   0.54147</span></span>
<span id="cb526-15"><a href="#cb526-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2     -0.00874   -0.42229  -0.50641  -0.33817   0.04292   0.65554   0.60266</span></span>
<span id="cb526-16"><a href="#cb526-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        U95%    </span></span>
<span id="cb526-17"><a href="#cb526-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape        NA</span></span>
<span id="cb526-18"><a href="#cb526-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale        NA</span></span>
<span id="cb526-19"><a href="#cb526-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X1      0.72892</span></span>
<span id="cb526-20"><a href="#cb526-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2      0.71307</span></span>
<span id="cb526-21"><a href="#cb526-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb526-22"><a href="#cb526-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; N = 245,  Events: 161,  Censored: 84</span></span>
<span id="cb526-23"><a href="#cb526-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total time at risk: 1388.951</span></span>
<span id="cb526-24"><a href="#cb526-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-likelihood = -427.4387, df = 4</span></span>
<span id="cb526-25"><a href="#cb526-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC = 862.8774</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb527"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb527-4"><a href="#cb527-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb527-5"><a href="#cb527-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       7.87</span></span>
<span id="cb527-6"><a href="#cb527-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       4.13</span></span>
<span id="cb527-7"><a href="#cb527-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       4.61</span></span>
<span id="cb527-8"><a href="#cb527-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       5.16</span></span>
<span id="cb527-9"><a href="#cb527-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       4.40</span></span>
<span id="cb527-10"><a href="#cb527-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb527-11"><a href="#cb527-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb527-12"><a href="#cb527-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb527-13"><a href="#cb527-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb527-14"><a href="#cb527-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-15"><a href="#cb527-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-16"><a href="#cb527-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-17"><a href="#cb527-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-18"><a href="#cb527-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-19"><a href="#cb527-19" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"hazard"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb527-20"><a href="#cb527-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb527-21"><a href="#cb527-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb527-22"><a href="#cb527-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb527-23"><a href="#cb527-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-24"><a href="#cb527-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-25"><a href="#cb527-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-26"><a href="#cb527-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-27"><a href="#cb527-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb527-28"><a href="#cb527-28" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"linear_pred"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb527-29"><a href="#cb527-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb527-30"><a href="#cb527-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_linear_pred</span></span>
<span id="cb527-31"><a href="#cb527-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               &lt;dbl&gt;</span></span>
<span id="cb527-32"><a href="#cb527-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              2.18</span></span>
<span id="cb527-33"><a href="#cb527-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2              1.54</span></span>
<span id="cb527-34"><a href="#cb527-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3              1.65</span></span>
<span id="cb527-35"><a href="#cb527-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4              1.76</span></span>
<span id="cb527-36"><a href="#cb527-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5              1.60</span></span>
<span id="cb527-37"><a href="#cb527-37" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"quantile"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb527-38"><a href="#cb527-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb527-39"><a href="#cb527-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_quantile</span></span>
<span id="cb527-40"><a href="#cb527-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;qtls(9)&gt;</span></span>
<span id="cb527-41"><a href="#cb527-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         [7.47]</span></span>
<span id="cb527-42"><a href="#cb527-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         [3.92]</span></span>
<span id="cb527-43"><a href="#cb527-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         [4.37]</span></span>
<span id="cb527-44"><a href="#cb527-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4          [4.9]</span></span>
<span id="cb527-45"><a href="#cb527-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5         [4.18]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a>survival_reg_fit <span class="sc">|&gt;</span> </span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb528-4"><a href="#cb528-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb528-5"><a href="#cb528-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb528-6"><a href="#cb528-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb528-7"><a href="#cb528-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb528-8"><a href="#cb528-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb528-9"><a href="#cb528-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.990</span></span>
<span id="cb528-10"><a href="#cb528-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.904</span></span>
<span id="cb528-11"><a href="#cb528-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.743</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-50-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-50-3-tab">
<p>This engine requires the censored extension package, so let’s load this first:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb529"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censored)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb530"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a>survival_reg_spec <span class="ot">&lt;-</span> <span class="fu">survival_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This model only works with a single mode, so we don't need to set the mode.</span></span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"flexsurvspline"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb531"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a>survival_reg_fit <span class="ot">&lt;-</span> survival_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb531-2"><a href="#cb531-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(event_time <span class="sc">~</span> ., <span class="at">data =</span> cns_train)</span>
<span id="cb531-3"><a href="#cb531-3" aria-hidden="true" tabindex="-1"></a>survival_reg_fit</span>
<span id="cb531-4"><a href="#cb531-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb531-5"><a href="#cb531-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb531-6"><a href="#cb531-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb531-7"><a href="#cb531-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; flexsurv::flexsurvspline(formula = event_time ~ ., data = data)</span></span>
<span id="cb531-8"><a href="#cb531-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb531-9"><a href="#cb531-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates: </span></span>
<span id="cb531-10"><a href="#cb531-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span></span>
<span id="cb531-11"><a href="#cb531-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gamma0        NA   -4.72712  -5.31772  -4.13651   0.30134        NA        NA</span></span>
<span id="cb531-12"><a href="#cb531-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gamma1        NA    2.11487   1.86338   2.36637   0.12832        NA        NA</span></span>
<span id="cb531-13"><a href="#cb531-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X1       0.46939    0.98305   0.65928   1.30683   0.16519   2.67261   1.93340</span></span>
<span id="cb531-14"><a href="#cb531-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2      -0.00874    0.89308   0.70943   1.07673   0.09370   2.44265   2.03283</span></span>
<span id="cb531-15"><a href="#cb531-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         U95%    </span></span>
<span id="cb531-16"><a href="#cb531-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gamma0        NA</span></span>
<span id="cb531-17"><a href="#cb531-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gamma1        NA</span></span>
<span id="cb531-18"><a href="#cb531-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X1       3.69444</span></span>
<span id="cb531-19"><a href="#cb531-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2       2.93508</span></span>
<span id="cb531-20"><a href="#cb531-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb531-21"><a href="#cb531-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; N = 245,  Events: 161,  Censored: 84</span></span>
<span id="cb531-22"><a href="#cb531-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total time at risk: 1388.951</span></span>
<span id="cb531-23"><a href="#cb531-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-likelihood = -427.4387, df = 4</span></span>
<span id="cb531-24"><a href="#cb531-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC = 862.8774</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"time"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb532-3"><a href="#cb532-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_time</span></span>
<span id="cb532-4"><a href="#cb532-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb532-5"><a href="#cb532-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       7.87</span></span>
<span id="cb532-6"><a href="#cb532-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       4.13</span></span>
<span id="cb532-7"><a href="#cb532-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       4.61</span></span>
<span id="cb532-8"><a href="#cb532-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       5.16</span></span>
<span id="cb532-9"><a href="#cb532-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       4.40</span></span>
<span id="cb532-10"><a href="#cb532-10" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb532-11"><a href="#cb532-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb532-12"><a href="#cb532-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb532-13"><a href="#cb532-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb532-14"><a href="#cb532-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-15"><a href="#cb532-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-16"><a href="#cb532-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-17"><a href="#cb532-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-18"><a href="#cb532-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-19"><a href="#cb532-19" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"hazard"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times)</span>
<span id="cb532-20"><a href="#cb532-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb532-21"><a href="#cb532-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred           </span></span>
<span id="cb532-22"><a href="#cb532-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;          </span></span>
<span id="cb532-23"><a href="#cb532-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-24"><a href="#cb532-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-25"><a href="#cb532-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-26"><a href="#cb532-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-27"><a href="#cb532-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;tibble [3 × 2]&gt;</span></span>
<span id="cb532-28"><a href="#cb532-28" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"linear_pred"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb532-29"><a href="#cb532-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb532-30"><a href="#cb532-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_linear_pred</span></span>
<span id="cb532-31"><a href="#cb532-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               &lt;dbl&gt;</span></span>
<span id="cb532-32"><a href="#cb532-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             -4.62</span></span>
<span id="cb532-33"><a href="#cb532-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             -3.26</span></span>
<span id="cb532-34"><a href="#cb532-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             -3.49</span></span>
<span id="cb532-35"><a href="#cb532-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             -3.73</span></span>
<span id="cb532-36"><a href="#cb532-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5             -3.39</span></span>
<span id="cb532-37"><a href="#cb532-37" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(survival_reg_fit, <span class="at">type =</span> <span class="st">"quantile"</span>, <span class="at">new_data =</span> cns_test)</span>
<span id="cb532-38"><a href="#cb532-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 1</span></span>
<span id="cb532-39"><a href="#cb532-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_quantile</span></span>
<span id="cb532-40"><a href="#cb532-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;qtls(9)&gt;</span></span>
<span id="cb532-41"><a href="#cb532-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         [7.47]</span></span>
<span id="cb532-42"><a href="#cb532-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         [3.92]</span></span>
<span id="cb532-43"><a href="#cb532-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         [4.37]</span></span>
<span id="cb532-44"><a href="#cb532-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4          [4.9]</span></span>
<span id="cb532-45"><a href="#cb532-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5         [4.18]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of the survival predictions has results for each evaluation time:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb533"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a>survival_reg_fit <span class="sc">|&gt;</span> </span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"survival"</span>, <span class="at">new_data =</span> cns_test, <span class="at">eval_time =</span> eval_times) <span class="sc">|&gt;</span> </span>
<span id="cb533-3"><a href="#cb533-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb533-4"><a href="#cb533-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred"</span>)</span>
<span id="cb533-5"><a href="#cb533-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb533-6"><a href="#cb533-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb533-7"><a href="#cb533-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .eval_time .pred_survival</span></span>
<span id="cb533-8"><a href="#cb533-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb533-9"><a href="#cb533-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          1          0.990</span></span>
<span id="cb533-10"><a href="#cb533-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          3          0.904</span></span>
<span id="cb533-11"><a href="#cb533-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          5          0.743</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="quantile-regression-models" class="level1">
<h1>Quantile Regression Models</h1>
<section id="example-data-3" class="level2">
<h2 class="anchored" data-anchor-id="example-data-3">Example data</h2>
<p>To demonstrate quantile regression, let’s make a larger version of our regression data:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb534"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">938</span>)</span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a>qnt_split <span class="ot">&lt;-</span></span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true" tabindex="-1"></a>  modeldata<span class="sc">::</span>concrete <span class="sc">|&gt;</span> </span>
<span id="cb534-4"><a href="#cb534-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb534-5"><a href="#cb534-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">strength =</span> compressive_strength, cement, age) <span class="sc">|&gt;</span> </span>
<span id="cb534-6"><a href="#cb534-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(<span class="at">prop =</span> <span class="fl">0.95</span>, <span class="at">strata =</span> strength)</span>
<span id="cb534-7"><a href="#cb534-7" aria-hidden="true" tabindex="-1"></a>qnt_split</span>
<span id="cb534-8"><a href="#cb534-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;Training/Testing/Total&gt;</span></span>
<span id="cb534-9"><a href="#cb534-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;92/8/100&gt;</span></span>
<span id="cb534-10"><a href="#cb534-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-11"><a href="#cb534-11" aria-hidden="true" tabindex="-1"></a>qnt_rec <span class="ot">&lt;-</span> </span>
<span id="cb534-12"><a href="#cb534-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">training</span>(qnt_split)) <span class="sc">|&gt;</span> </span>
<span id="cb534-13"><a href="#cb534-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb534-14"><a href="#cb534-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb534-15"><a href="#cb534-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-16"><a href="#cb534-16" aria-hidden="true" tabindex="-1"></a>qnt_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(qnt_rec, <span class="at">new_data =</span> <span class="cn">NULL</span>)</span>
<span id="cb534-17"><a href="#cb534-17" aria-hidden="true" tabindex="-1"></a>qnt_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(qnt_rec, <span class="at">new_data =</span> <span class="fu">testing</span>(qnt_split))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We’ll also predict these quantile levels:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb535"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a>qnt_lvls <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">/</span> <span class="dv">4</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="models-3" class="level2">
<h2 class="anchored" data-anchor-id="models-3">Models</h2>
<section id="linear-regression-linear_reg" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-linear_reg">Linear Regression (<code>linear_reg()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-51-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-1" role="tab" aria-controls="tabset-51-1" aria-selected="true" href=""><code>quantreg</code></a></li></ul>
<div class="tab-content">
<div id="tabset-51-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-51-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a>linear_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"quantreg"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"quantile regression"</span>, <span class="at">quantile_levels =</span> qnt_lvls)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb537"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="ot">&lt;-</span> linear_reg_spec <span class="sc">|&gt;</span></span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> qnt_train)</span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true" tabindex="-1"></a>linear_reg_fit</span>
<span id="cb537-4"><a href="#cb537-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb537-5"><a href="#cb537-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb537-6"><a href="#cb537-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb537-7"><a href="#cb537-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; quantreg::rq(formula = strength ~ ., tau = quantile_levels, data = data)</span></span>
<span id="cb537-8"><a href="#cb537-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb537-9"><a href="#cb537-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb537-10"><a href="#cb537-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             tau= 0.25 tau= 0.50 tau= 0.75</span></span>
<span id="cb537-11"><a href="#cb537-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 23.498029 33.265428 42.046031</span></span>
<span id="cb537-12"><a href="#cb537-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cement       6.635233  7.955658  8.181235</span></span>
<span id="cb537-13"><a href="#cb537-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age          5.566668  9.514832  7.110702</span></span>
<span id="cb537-14"><a href="#cb537-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb537-15"><a href="#cb537-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of freedom: 92 total; 89 residual</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linear_reg_fit, <span class="at">type =</span> <span class="st">"quantile"</span>, <span class="at">new_data =</span> qnt_test)</span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_quantile</span></span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;qtls(3)&gt;</span></span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         [29.2]</span></span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         [31.5]</span></span>
<span id="cb538-7"><a href="#cb538-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         [21.4]</span></span>
<span id="cb538-8"><a href="#cb538-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4         [48.3]</span></span>
<span id="cb538-9"><a href="#cb538-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5         [36.6]</span></span>
<span id="cb538-10"><a href="#cb538-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6         [33.8]</span></span>
<span id="cb538-11"><a href="#cb538-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7         [34.6]</span></span>
<span id="cb538-12"><a href="#cb538-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8         [43.8]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of predictions has a special vector class containing all of the quantile predictions:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb539"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>linear_reg_fit <span class="sc">|&gt;</span> </span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"quantile"</span>, <span class="at">new_data =</span> qnt_test)<span class="sc">|&gt;</span> </span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred_quantile"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb539-5"><a href="#cb539-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Expand the results for each quantile level by converting to a tibble</span></span>
<span id="cb539-6"><a href="#cb539-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb539-7"><a href="#cb539-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span id="cb539-8"><a href="#cb539-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_quantile .quantile_levels  .row</span></span>
<span id="cb539-9"><a href="#cb539-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &lt;dbl&gt;            &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb539-10"><a href="#cb539-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           21.5             0.25     1</span></span>
<span id="cb539-11"><a href="#cb539-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2           29.2             0.5      1</span></span>
<span id="cb539-12"><a href="#cb539-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3           39.5             0.75     1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="random-forests-rand_forest-3" class="level3">
<h3 class="anchored" data-anchor-id="random-forests-rand_forest-3">Random Forests (<code>rand_forest()</code>)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-52-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-1" role="tab" aria-controls="tabset-52-1" aria-selected="true" href=""><code>grf</code></a></li></ul>
<div class="tab-content">
<div id="tabset-52-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-52-1-tab">
<p>We create a model specification via:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a>rand_forest_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"grf"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"quantile regression"</span>, <span class="at">quantile_levels =</span> qnt_lvls)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we create the model fit object:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb541"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random number seed to an integer for reproducibility: </span></span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">435</span>)</span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="ot">&lt;-</span> rand_forest_spec <span class="sc">|&gt;</span></span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(strength <span class="sc">~</span> ., <span class="at">data =</span> qnt_train)</span>
<span id="cb541-5"><a href="#cb541-5" aria-hidden="true" tabindex="-1"></a>rand_forest_fit</span>
<span id="cb541-6"><a href="#cb541-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; parsnip model object</span></span>
<span id="cb541-7"><a href="#cb541-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb541-8"><a href="#cb541-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GRF forest object of type quantile_forest </span></span>
<span id="cb541-9"><a href="#cb541-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of trees: 2000 </span></span>
<span id="cb541-10"><a href="#cb541-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of training samples: 92 </span></span>
<span id="cb541-11"><a href="#cb541-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variable importance: </span></span>
<span id="cb541-12"><a href="#cb541-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     1     2 </span></span>
<span id="cb541-13"><a href="#cb541-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.454 0.546</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The holdout data can be predicted:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rand_forest_fit, <span class="at">type =</span> <span class="st">"quantile"</span>, <span class="at">new_data =</span> qnt_test)</span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 1</span></span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_quantile</span></span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;qtls(3)&gt;</span></span>
<span id="cb542-5"><a href="#cb542-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         [26.4]</span></span>
<span id="cb542-6"><a href="#cb542-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         [36.2]</span></span>
<span id="cb542-7"><a href="#cb542-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         [26.9]</span></span>
<span id="cb542-8"><a href="#cb542-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4         [43.7]</span></span>
<span id="cb542-9"><a href="#cb542-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5           [39]</span></span>
<span id="cb542-10"><a href="#cb542-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6         [35.9]</span></span>
<span id="cb542-11"><a href="#cb542-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7         [38.5]</span></span>
<span id="cb542-12"><a href="#cb542-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8         [31.8]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row of predictions has a special vector class containing all of the quantile predictions:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb543"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a>rand_forest_fit <span class="sc">|&gt;</span> </span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">type =</span> <span class="st">"quantile"</span>, <span class="at">new_data =</span> qnt_test)<span class="sc">|&gt;</span> </span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb543-4"><a href="#cb543-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">".pred_quantile"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb543-5"><a href="#cb543-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Expand the results for each quantile level by converting to a tibble</span></span>
<span id="cb543-6"><a href="#cb543-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb543-7"><a href="#cb543-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span id="cb543-8"><a href="#cb543-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .pred_quantile .quantile_levels  .row</span></span>
<span id="cb543-9"><a href="#cb543-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &lt;dbl&gt;            &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb543-10"><a href="#cb543-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           17.2             0.25     1</span></span>
<span id="cb543-11"><a href="#cb543-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2           26.4             0.5      1</span></span>
<span id="cb543-12"><a href="#cb543-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3           39               0.75     1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="session-info" class="level2">
<h2 class="anchored" data-anchor-id="session-info">Session information</h2>
<div class="cell" data-layout-align="center">
<pre><code>#&gt; ─ Session info ─────────────────────────────────────────────────────
#&gt;  version  R version 4.5.2 (2025-10-31)
#&gt;  language (EN)
#&gt;  date     2026-02-06
#&gt;  pandoc   3.6.3
#&gt;  quarto   1.8.27
#&gt; 
#&gt; ─ Packages ─────────────────────────────────────────────────────────
#&gt;  package         version    date (UTC) source
#&gt;  agua            0.1.4      2024-06-04 CRAN (R 4.5.0)
#&gt;  baguette        1.1.0      2025-01-28 CRAN (R 4.5.0)
#&gt;  bonsai          0.4.0      2025-06-25 CRAN (R 4.5.0)
#&gt;  broom           1.0.11     2025-12-04 CRAN (R 4.5.2)
#&gt;  censored        0.3.3      2025-02-14 CRAN (R 4.5.0)
#&gt;  dials           1.4.2      2025-09-04 CRAN (R 4.5.0)
#&gt;  discrim         1.1.0      2025-12-02 CRAN (R 4.5.2)
#&gt;  dplyr           1.2.0      2026-02-03 CRAN (R 4.5.2)
#&gt;  ggplot2         4.0.2      2026-02-03 CRAN (R 4.5.2)
#&gt;  HSAUR3          1.0-15     2024-08-17 CRAN (R 4.5.0)
#&gt;  infer           1.1.0      2025-12-18 CRAN (R 4.5.2)
#&gt;  lme4            1.1-38     2025-12-02 CRAN (R 4.5.2)
#&gt;  multilevelmod   1.0.0      2022-06-17 CRAN (R 4.5.0)
#&gt;  parsnip         1.4.1      2026-01-11 CRAN (R 4.5.2)
#&gt;  plsmod          1.0.0      2022-09-06 CRAN (R 4.5.0)
#&gt;  poissonreg      1.0.1      2022-08-22 CRAN (R 4.5.0)
#&gt;  prodlim         2025.04.28 2025-04-28 CRAN (R 4.5.0)
#&gt;  purrr           1.2.1      2026-01-09 CRAN (R 4.5.2)
#&gt;  recipes         1.3.1      2025-05-21 CRAN (R 4.5.0)
#&gt;  rlang           1.1.7      2026-01-09 CRAN (R 4.5.2)
#&gt;  rsample         1.3.2      2026-01-30 CRAN (R 4.5.2)
#&gt;  rules           1.0.3      2026-01-27 CRAN (R 4.5.2)
#&gt;  sparklyr        1.9.3      2025-11-19 CRAN (R 4.5.2)
#&gt;  survival        3.8-6      2026-01-16 CRAN (R 4.5.2)
#&gt;  tibble          3.3.1      2026-01-11 CRAN (R 4.5.2)
#&gt;  tidymodels      1.4.1      2025-09-08 CRAN (R 4.5.0)
#&gt;  tune            2.0.1      2025-10-17 CRAN (R 4.5.0)
#&gt;  workflows       1.3.0      2025-08-27 CRAN (R 4.5.0)
#&gt;  yardstick       1.3.2      2025-01-22 CRAN (R 4.5.0)
#&gt; 
#&gt; ─ Python configuration ─────────────────────────────────────────────
#&gt;  python:         /Users/hannah/.virtualenvs/r-tensorflow/bin/python
#&gt;  libpython:      /Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/config-3.9-darwin/libpython3.9.dylib
#&gt;  pythonhome:     /Users/hannah/.virtualenvs/r-tensorflow:/Users/hannah/.virtualenvs/r-tensorflow
#&gt;  version:        3.9.6 (default, Dec  2 2025, 07:27:58)  [Clang 17.0.0 (clang-1700.6.3.2)]
#&gt;  numpy:          /Users/hannah/.virtualenvs/r-tensorflow/lib/python3.9/site-packages/numpy
#&gt;  numpy_version:  1.26.4
#&gt;  tensorflow:     /Users/hannah/.virtualenvs/r-tensorflow/lib/python3.9/site-packages/tensorflow
#&gt;  
#&gt;  NOTE: Python version was forced by use_python() function
#&gt; 
#&gt; ────────────────────────────────────────────────────────────────────</code></pre>
</div>


</section>
</section>

</main> <!-- /main -->
<!-- plausible -->
<script async="" defer="" data-domain="tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
<div class="section resources">
  <div class="resourcesTitle">Resources</div>
  <div class="event">
    <div class="eventTitle">
      <a href="../../../find/"><i class="fas fa-search fa-xs"></i>&nbsp;&nbsp;Find</a>
    </div>
    <div class="eventDetails">Explore searchable tables of all tidymodels packages and functions.</div>
  </div>
  <div class="event">
    <div class="eventTitle">
      <a href="../../../books/"><i class="fas fa-book-open fa-xs"></i>&nbsp;&nbsp;Books</a>
    </div>
    <div class="eventDetails">Study up on statistics and modeling with our comprehensive books.</div>
  </div>
  <div class="event">
    <div class="eventTitle">
      <a href="https://www.tidyverse.org/tags/tidymodels/" target="_blank"><i class="fas fa-bullhorn fa-xs"></i>&nbsp;&nbsp;News</a>
    </div>
    <div class="eventDetails">Hear the latest about tidymodels packages at the <a href="https://www.tidyverse.org/tags/tidymodels/">tidyverse blog</a>.</div>
  </div>
</div>

<script>
  sidebar = document.querySelector('#quarto-margin-sidebar');
  resources = document.querySelector('.resources');
  sidebar.appendChild(resources);
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.tidymodels\.org");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Proudly supported by <a href="https://posit.co"><img src="https://posit.co/wp-content/themes/Posit/assets/images/posit-logo-2024.svg" class="img-fluid" alt="Posit" width="65"></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/tidymodels/tidymodels.org/edit/main/learn/models/parsnip-predictions/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/tidymodels/tidymodels.org/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><a onclick="window.scrollTo({ top: 0, behavior: 'smooth' }); return false;" role="button"> <i class="fa-solid fa-chevron-up" aria-label="chevron-up"></i> </a></p>
</div>
  </div>
</footer>




</body></html>